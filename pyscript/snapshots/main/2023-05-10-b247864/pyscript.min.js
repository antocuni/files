var pyscript=(()=>{var ay=Object.create;var rs=Object.defineProperty;var hy=Object.getOwnPropertyDescriptor;var cy=Object.getOwnPropertyNames;var fy=Object.getPrototypeOf,uy=Object.prototype.hasOwnProperty;var ff=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),uf=(i,e)=>{for(var t in e)rs(i,t,{get:e[t],enumerable:!0})},df=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of cy(e))!uy.call(i,r)&&r!==t&&rs(i,r,{get:()=>e[r],enumerable:!(n=hy(e,r))||n.enumerable});return i};var dy=(i,e,t)=>(t=i!=null?ay(fy(i)):{},df(e||!i||!i.__esModule?rs(t,"default",{value:i,enumerable:!0}):t,i)),py=i=>df(rs({},"__esModule",{value:!0}),i);var gf=ff((cv,mf)=>{mf.exports=function(){"use strict";function i(n,r){function s(){this.constructor=n}s.prototype=r.prototype,n.prototype=new s}function e(n,r,s,o){this.message=n,this.expected=r,this.found=s,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}i(e,Error),e.buildMessage=function(n,r){var s={literal:function(m){return'"'+l(m.text)+'"'},class:function(m){var g="",y;for(y=0;y<m.parts.length;y++)g+=m.parts[y]instanceof Array?a(m.parts[y][0])+"-"+a(m.parts[y][1]):a(m.parts[y]);return"["+(m.inverted?"^":"")+g+"]"},any:function(m){return"any character"},end:function(m){return"end of input"},other:function(m){return m.description}};function o(m){return m.charCodeAt(0).toString(16).toUpperCase()}function l(m){return m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+o(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+o(g)})}function a(m){return m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+o(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+o(g)})}function h(m){return s[m.type](m)}function c(m){var g=new Array(m.length),y,P;for(y=0;y<m.length;y++)g[y]=h(m[y]);if(g.sort(),g.length>0){for(y=1,P=1;y<g.length;y++)g[y-1]!==g[y]&&(g[P]=g[y],P++);g.length=P}switch(g.length){case 1:return g[0];case 2:return g[0]+" or "+g[1];default:return g.slice(0,-1).join(", ")+", or "+g[g.length-1]}}function u(m){return m?'"'+l(m)+'"':"end of input"}return"Expected "+c(n)+" but "+u(r)+" found."};function t(n,r){r=r!==void 0?r:{};var s={},o={Expressions:Sl},l=Sl,a=function(){return ns},h=function(f){is=$l(ns,!0,f)},c=function(f){is=$l(ns,!1,f)},u=function(f){_l(is.table,f[0]),is.table[f[0]]=f[1]},m=ve("Newline"),g=`
`,y=re(`
`,!1),P=`\r
`,x=re(`\r
`,!1),k=ve("Whitespace"),Q=/^[ \t]/,D=Ut([" ","	"],!1,!1),I=ve("Comment"),E="#",W=re("#",!1),Z=k0(),te="=",U=re("=",!1),F=function(f,d){return[f,d.value]},K=function(){return Kn()},be=ve('[a-z], [A-Z], [0-9], "-", "_"'),Ee=/^[a-zA-Z0-9\-_]/,qe=Ut([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),Te=function(f){return f.join("")},We=ve("DoubleQuote"),ht='"',Be=re('"',!1),ge=ve("SingleQuote"),Pe="'",Nt=re("'",!1),tn=ve("ThreeDoubleQuotes"),Cn='"""',Yr=re('"""',!1),xO=ve("ThreeSingleQuotes"),Nr="'''",Zc=re("'''",!1),al=function(f){return{type:"String",value:f.join("")}},hl=ve("NormalCharacter"),PO=/^[^\0-\x1F"\\]/,vO=Ut([["\0",""],'"',"\\"],!0,!1),_O="u",$O=re("u",!1),TO="U",kO=re("U",!1),IO=function(){var f=Kn();return f.length<=2?af(f[1]):hf(parseInt(f.substr(2),16))},AO=ve('"b", "f", "n", "r", "t"'),CO=/^[bfnrt]/,EO=Ut(["b","f","n","r","t"],!1,!1),WO=ve("Backslash"),QO="\\",RO=re("\\",!1),MO=ve("FourHexadecimalDigits"),DO=ve("EightHexadecimalDigits"),LO=/^[0-9A-Fa-f]/,qO=Ut([["0","9"],["A","F"],["a","f"]],!1,!1),BO=function(){var f=Kn();return{type:"String",value:f.substr(1,f.length-2)}},ZO=/^[^\0-\x08\n-\x1F']/,VO=Ut([["\0","\b"],[`
`,""],"'"],!0,!1),YO=function(){return""},NO=/^[^\0-\x1F\\]/,UO=Ut([["\0",""],"\\"],!0,!1),FO=ve("AnyCharacter"),jO=/^[^\0-\x08\n-\x1F]/,XO=Ut([["\0","\b"],[`
`,""]],!0,!1),Vc="true",zO=re("true",!1),HO=function(){return{type:"Boolean",value:!0}},Yc="false",GO=re("false",!1),JO=function(){return{type:"Boolean",value:!1}},KO=function(){var f=Kn(),d=parseFloat(f.replace(/_/g,""));return Fi(d)||Xe(f+"is not a 64-bit floating-point number."),{type:"Float",value:d}},Ur=".",Fr=re(".",!1),jr="_",Xr=re("_",!1),e0="e",t0=re("e",!1),n0="E",i0=re("E",!1),r0=function(){var f=Kn();/^[-+]?0./.test(f)&&Xe("integer must not contain leading zeros");var d=f.replace(/_/g,""),O=!1;if(d[0]==="-"){var S="-9223372036854775808";(d.length>S.length||d.length===S.length&&d>S)&&(O=!0)}else{d[0]==="+"&&(d=d.substr(1));var b="9223372036854775807";(d.length>b.length||d.length===b.length&&d>b)&&(O=!0)}return O&&Xe(f+" is not a 64-bit signed integer."),d=parseInt(d,10),Fi(d)||Xe(f+" is not a 64-bit signed integer."),{type:"Integer",value:d}},s0="+",o0=re("+",!1),cl="-",fl=re("-",!1),l0=/^[0-9]/,a0=Ut([["0","9"]],!1,!1),h0="T",c0=re("T",!1),f0=function(){var f=Kn(),d=new Date(f);return Fi(d.getTime())||Xe("Date-time "+f+" is invalid. It does not conform to RFC 3339 or this is a browser-specific problem."),{type:"DateTime",value:d}},u0=ve("FullDate (YYYY-mm-dd)"),ul=":",dl=re(":",!1),d0=ve("Hour (HH)"),p0=ve("Minute (MM)"),m0=ve("Second (SS)"),g0=ve("TimeOffset (Z or +/-HH:MM)"),O0="Z",y0=re("Z",!1),pl="[",ml=re("[",!1),zr=",",Hr=re(",",!1),gl="]",Ol=re("]",!1),S0=function(f){for(var d={type:"Array",value:f?f[0]:[]},O=0,S=d.value,b=S.length;O<b;O++)S[O]=S[O].value;return d},b0=function(f,d){var O=[f];if(d)for(var S=f.type,b=0,_=d[3],T=_.length;b<T;b++)S!==_[b].type&&Xe(En(_[b].value)+' should be of type "'+S+'".'),O.push(_[b]);return O},w0="{",x0=re("{",!1),P0="}",v0=re("}",!1),_0=function(f){var d={};if(f){d[f[0][0]]=f[0][1];for(var O=0,S=f[1],b=S.length;O<b;O++){var _=S[O][3];_l(d,_[0]),d[_[0]]=_[1]}}return{type:"InlineTable",value:d}},$0=function(f){return f},T0=function(f,d){for(var O=[f],S=0,b=d.length;S<b;S++)O.push(d[S][3]);return O},p=0,J=0,Gr=[{line:1,column:1}],At=0,yl=[],v=0,Jr;if("startRule"in r){if(!(r.startRule in o))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');l=o[r.startRule]}function Kn(){return n.substring(J,p)}function rv(){return Yi(J,p)}function sv(f,d){throw d=d!==void 0?d:Yi(J,p),Uc([ve(f)],n.substring(J,p),d)}function Xe(f,d){throw d=d!==void 0?d:Yi(J,p),A0(f,d)}function re(f,d){return{type:"literal",text:f,ignoreCase:d}}function Ut(f,d,O){return{type:"class",parts:f,inverted:d,ignoreCase:O}}function k0(){return{type:"any"}}function I0(){return{type:"end"}}function ve(f){return{type:"other",description:f}}function Nc(f){var d=Gr[f],O;if(d)return d;for(O=f-1;!Gr[O];)O--;for(d=Gr[O],d={line:d.line,column:d.column};O<f;)n.charCodeAt(O)===10?(d.line++,d.column=1):d.column++,O++;return Gr[f]=d,d}function Yi(f,d){var O=Nc(f),S=Nc(d);return{start:{offset:f,line:O.line,column:O.column},end:{offset:d,line:S.line,column:S.column}}}function A(f){p<At||(p>At&&(At=p,yl=[]),yl.push(f))}function A0(f,d){return new e(f,null,null,d)}function Uc(f,d,O){return new e(e.buildMessage(f,d),f,d,O)}function Sl(){var f,d,O,S,b,_,T,B;for(f=p,d=[],O=z(),O===s&&(O=Me(),O===s&&(O=Ni()));O!==s;)d.push(O),O=z(),O===s&&(O=Me(),O===s&&(O=Ni()));if(d!==s){if(O=p,S=C0(),S!==s){for(b=[],_=z(),_===s&&(_=Ni());_!==s;)b.push(_),_=z(),_===s&&(_=Ni());b!==s?(_=p,T=Me(),T!==s?(B=Sl(),B!==s?(T=[T,B],_=T):(p=_,_=s)):(p=_,_=s),_===s&&(_=null),_!==s?(S=[S,b,_],O=S):(p=O,O=s)):(p=O,O=s)}else p=O,O=s;O===s&&(O=null),O!==s?(J=f,d=a(),f=d):(p=f,f=s)}else p=f,f=s;return f}function C0(){var f,d;return f=p,d=ly(),d!==s&&(J=f,d=h(d)),f=d,f===s&&(f=p,d=lf(),d!==s&&(J=f,d=c(d)),f=d,f===s&&(f=p,d=Kr(),d!==s&&(J=f,d=u(d)),f=d)),f}function Me(){var f,d;return v++,n.charCodeAt(p)===10?(f=g,p++):(f=s,v===0&&A(y)),f===s&&(n.substr(p,2)===P?(f=P,p+=2):(f=s,v===0&&A(x))),v--,f===s&&(d=s,v===0&&A(m)),f}function z(){var f,d;return v++,Q.test(n.charAt(p))?(f=n.charAt(p),p++):(f=s,v===0&&A(D)),v--,f===s&&(d=s,v===0&&A(k)),f}function Ni(){var f,d,O,S,b,_;if(v++,f=p,n.charCodeAt(p)===35?(d=E,p++):(d=s,v===0&&A(W)),d!==s){for(O=[],S=p,b=p,v++,_=Me(),v--,_===s?b=void 0:(p=b,b=s),b!==s?(n.length>p?(_=n.charAt(p),p++):(_=s,v===0&&A(Z)),_!==s?(b=[b,_],S=b):(p=S,S=s)):(p=S,S=s);S!==s;)O.push(S),S=p,b=p,v++,_=Me(),v--,_===s?b=void 0:(p=b,b=s),b!==s?(n.length>p?(_=n.charAt(p),p++):(_=s,v===0&&A(Z)),_!==s?(b=[b,_],S=b):(p=S,S=s)):(p=S,S=s);O!==s?(d=[d,O],f=d):(p=f,f=s)}else p=f,f=s;return v--,f===s&&(d=s,v===0&&A(I)),f}function Kr(){var f,d,O,S,b,_;if(f=p,d=es(),d!==s){for(O=[],S=z();S!==s;)O.push(S),S=z();if(O!==s)if(n.charCodeAt(p)===61?(S=te,p++):(S=s,v===0&&A(U)),S!==s){for(b=[],_=z();_!==s;)b.push(_),_=z();b!==s?(_=zc(),_!==s?(J=f,d=F(d,_),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;else p=f,f=s}else p=f,f=s;return f}function es(){var f;return f=E0(),f===s&&(f=W0()),f}function E0(){var f,d,O;if(f=p,d=[],O=Fc(),O!==s)for(;O!==s;)d.push(O),O=Fc();else d=s;return d!==s&&(J=f,d=K()),f=d,f}function Fc(){var f,d;return v++,Ee.test(n.charAt(p))?(f=n.charAt(p),p++):(f=s,v===0&&A(qe)),v--,f===s&&(d=s,v===0&&A(be)),f}function W0(){var f,d,O,S;if(f=p,d=Ui(),d!==s){if(O=[],S=ts(),S!==s)for(;S!==s;)O.push(S),S=ts();else O=s;O!==s?(S=Ui(),S!==s?(J=f,d=Te(O),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;return f}function Ui(){var f,d;return v++,n.charCodeAt(p)===34?(f=ht,p++):(f=s,v===0&&A(Be)),v--,f===s&&(d=s,v===0&&A(We)),f}function jc(){var f,d;return v++,n.charCodeAt(p)===39?(f=Pe,p++):(f=s,v===0&&A(Nt)),v--,f===s&&(d=s,v===0&&A(ge)),f}function bl(){var f,d;return v++,n.substr(p,3)===Cn?(f=Cn,p+=3):(f=s,v===0&&A(Yr)),v--,f===s&&(d=s,v===0&&A(tn)),f}function Xc(){var f,d;return v++,n.substr(p,3)===Nr?(f=Nr,p+=3):(f=s,v===0&&A(Zc)),v--,f===s&&(d=s,v===0&&A(xO)),f}function zc(){var f;return f=Q0(),f===s&&(f=F0(),f===s&&(f=z0(),f===s&&(f=j0(),f===s&&(f=tf(),f===s&&(f=sy(),f===s&&(f=oy())))))),f}function Q0(){var f;return f=Z0(),f===s&&(f=R0(),f===s&&(f=N0(),f===s&&(f=B0()))),f}function R0(){var f,d,O,S;if(f=p,d=Ui(),d!==s){for(O=[],S=ts();S!==s;)O.push(S),S=ts();O!==s?(S=Ui(),S!==s?(J=f,d=al(O),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;return f}function ts(){var f;return f=M0(),f===s&&(f=Hc()),f}function M0(){var f,d,O;return v++,f=p,d=p,v++,O=Me(),v--,O===s?d=void 0:(p=d,d=s),d!==s?(PO.test(n.charAt(p))?(O=n.charAt(p),p++):(O=s,v===0&&A(vO)),O!==s?(J=f,d=K(),f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(hl)),f}function Hc(){var f,d,O,S,b;return f=p,d=wl(),d!==s?(O=D0(),O===s&&(O=Ui(),O===s&&(O=wl(),O===s&&(O=p,n.charCodeAt(p)===117?(S=_O,p++):(S=s,v===0&&A($O)),S!==s?(b=L0(),b!==s?(S=[S,b],O=S):(p=O,O=s)):(p=O,O=s),O===s&&(O=p,n.charCodeAt(p)===85?(S=TO,p++):(S=s,v===0&&A(kO)),S!==s?(b=q0(),b!==s?(S=[S,b],O=S):(p=O,O=s)):(p=O,O=s))))),O!==s?(J=f,d=IO(),f=d):(p=f,f=s)):(p=f,f=s),f}function D0(){var f,d;return v++,CO.test(n.charAt(p))?(f=n.charAt(p),p++):(f=s,v===0&&A(EO)),v--,f===s&&(d=s,v===0&&A(AO)),f}function wl(){var f,d;return v++,n.charCodeAt(p)===92?(f=QO,p++):(f=s,v===0&&A(RO)),v--,f===s&&(d=s,v===0&&A(WO)),f}function L0(){var f,d,O,S,b;return v++,f=p,d=ct(),d!==s?(O=ct(),O!==s?(S=ct(),S!==s?(b=ct(),b!==s?(d=[d,O,S,b],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(MO)),f}function q0(){var f,d,O,S,b,_,T,B,G;return v++,f=p,d=ct(),d!==s?(O=ct(),O!==s?(S=ct(),S!==s?(b=ct(),b!==s?(_=ct(),_!==s?(T=ct(),T!==s?(B=ct(),B!==s?(G=ct(),G!==s?(d=[d,O,S,b,_,T,B,G],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(DO)),f}function ct(){var f;return LO.test(n.charAt(p))?(f=n.charAt(p),p++):(f=s,v===0&&A(qO)),f}function B0(){var f,d,O,S;if(f=p,d=jc(),d!==s){for(O=[],S=Gc();S!==s;)O.push(S),S=Gc();O!==s?(S=jc(),S!==s?(J=f,d=BO(),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;return f}function Gc(){var f,d,O;return v++,f=p,d=p,v++,O=Me(),v--,O===s?d=void 0:(p=d,d=s),d!==s?(ZO.test(n.charAt(p))?(O=n.charAt(p),p++):(O=s,v===0&&A(VO)),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(hl)),f}function Z0(){var f,d,O,S,b;if(f=p,d=bl(),d!==s)if(O=Me(),O===s&&(O=null),O!==s){for(S=[],b=Jc();b!==s;)S.push(b),b=Jc();S!==s?(b=bl(),b!==s?(J=f,d=al(S),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;else p=f,f=s;return f}function Jc(){var f,d,O,S,b;if(f=V0(),f===s){if(f=p,d=wl(),d!==s)if(O=Me(),O!==s){for(S=[],b=z(),b===s&&(b=Me());b!==s;)S.push(b),b=z(),b===s&&(b=Me());S!==s?(J=f,d=YO(),f=d):(p=f,f=s)}else p=f,f=s;else p=f,f=s;f===s&&(f=Me())}return f}function V0(){var f,d,O;return f=p,d=p,v++,O=bl(),v--,O===s?d=void 0:(p=d,d=s),d!==s?(O=Y0(),O!==s?(J=f,d=K(),f=d):(p=f,f=s)):(p=f,f=s),f===s&&(f=Hc()),f}function Y0(){var f,d,O;return v++,f=p,d=p,v++,O=Me(),v--,O===s?d=void 0:(p=d,d=s),d!==s?(NO.test(n.charAt(p))?(O=n.charAt(p),p++):(O=s,v===0&&A(UO)),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(hl)),f}function N0(){var f,d,O,S,b;if(f=p,d=Xc(),d!==s)if(O=Me(),O===s&&(O=null),O!==s){for(S=[],b=Kc();b!==s;)S.push(b),b=Kc();S!==s?(b=Xc(),b!==s?(J=f,d=al(S),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s;else p=f,f=s;return f}function Kc(){var f,d,O;return f=p,d=p,v++,n.substr(p,3)===Nr?(O=Nr,p+=3):(O=s,v===0&&A(Zc)),v--,O===s?d=void 0:(p=d,d=s),d!==s?(O=U0(),O!==s?(J=f,d=K(),f=d):(p=f,f=s)):(p=f,f=s),f===s&&(f=Me()),f}function U0(){var f,d,O;return v++,f=p,d=p,v++,O=Me(),v--,O===s?d=void 0:(p=d,d=s),d!==s?(jO.test(n.charAt(p))?(O=n.charAt(p),p++):(O=s,v===0&&A(XO)),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(FO)),f}function F0(){var f,d;return f=p,n.substr(p,4)===Vc?(d=Vc,p+=4):(d=s,v===0&&A(zO)),d!==s&&(J=f,d=HO()),f=d,f===s&&(f=p,n.substr(p,5)===Yc?(d=Yc,p+=5):(d=s,v===0&&A(GO)),d!==s&&(J=f,d=JO()),f=d),f}function j0(){var f,d,O,S,b;return f=p,d=tf(),d!==s?(O=p,S=X0(),S!==s?(b=ef(),b===s&&(b=null),b!==s?(S=[S,b],O=S):(p=O,O=s)):(p=O,O=s),O===s&&(O=ef()),O!==s?(J=f,d=KO(),f=d):(p=f,f=s)):(p=f,f=s),f}function X0(){var f,d,O,S,b,_,T;if(f=p,n.charCodeAt(p)===46?(d=Ur,p++):(d=s,v===0&&A(Fr)),d!==s)if(O=Oe(),O!==s){for(S=[],b=p,n.charCodeAt(p)===95?(_=jr,p++):(_=s,v===0&&A(Xr)),_===s&&(_=null),_!==s?(T=Oe(),T!==s?(_=[_,T],b=_):(p=b,b=s)):(p=b,b=s);b!==s;)S.push(b),b=p,n.charCodeAt(p)===95?(_=jr,p++):(_=s,v===0&&A(Xr)),_===s&&(_=null),_!==s?(T=Oe(),T!==s?(_=[_,T],b=_):(p=b,b=s)):(p=b,b=s);S!==s?(d=[d,O,S],f=d):(p=f,f=s)}else p=f,f=s;else p=f,f=s;return f}function ef(){var f,d,O,S;return f=p,n.charCodeAt(p)===101?(d=e0,p++):(d=s,v===0&&A(t0)),d===s&&(n.charCodeAt(p)===69?(d=n0,p++):(d=s,v===0&&A(i0))),d!==s?(O=xl(),O===s&&(O=null),O!==s?(S=nf(),S!==s?(d=[d,O,S],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),f}function tf(){var f,d,O;return f=p,d=xl(),d===s&&(d=null),d!==s?(O=nf(),O!==s?(J=f,d=r0(),f=d):(p=f,f=s)):(p=f,f=s),f}function xl(){var f;return n.charCodeAt(p)===43?(f=s0,p++):(f=s,v===0&&A(o0)),f===s&&(n.charCodeAt(p)===45?(f=cl,p++):(f=s,v===0&&A(fl))),f}function nf(){var f,d,O,S,b,_;if(f=p,d=Oe(),d!==s){for(O=[],S=p,n.charCodeAt(p)===95?(b=jr,p++):(b=s,v===0&&A(Xr)),b===s&&(b=null),b!==s?(_=Oe(),_!==s?(b=[b,_],S=b):(p=S,S=s)):(p=S,S=s);S!==s;)O.push(S),S=p,n.charCodeAt(p)===95?(b=jr,p++):(b=s,v===0&&A(Xr)),b===s&&(b=null),b!==s?(_=Oe(),_!==s?(b=[b,_],S=b):(p=S,S=s)):(p=S,S=s);O!==s?(d=[d,O],f=d):(p=f,f=s)}else p=f,f=s;return f}function Oe(){var f;return l0.test(n.charAt(p))?(f=n.charAt(p),p++):(f=s,v===0&&A(a0)),f}function z0(){var f,d,O,S;return f=p,d=H0(),d!==s?(n.charCodeAt(p)===84?(O=h0,p++):(O=s,v===0&&A(c0)),O!==s?(S=ey(),S!==s?(J=f,d=f0(),f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),f}function H0(){var f,d,O,S,b,_;return v++,f=p,d=G0(),d!==s?(n.charCodeAt(p)===45?(O=cl,p++):(O=s,v===0&&A(fl)),O!==s?(S=J0(),S!==s?(n.charCodeAt(p)===45?(b=cl,p++):(b=s,v===0&&A(fl)),b!==s?(_=K0(),_!==s?(d=[d,O,S,b,_],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(u0)),f}function G0(){var f,d,O,S,b;return f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(S=Oe(),S!==s?(b=Oe(),b!==s?(d=[d,O,S,b],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),f}function J0(){var f,d,O;return f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),f}function K0(){var f,d,O;return f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),f}function ey(){var f,d,O;return f=p,d=ty(),d!==s?(O=ry(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),f}function ty(){var f,d,O,S,b,_,T;return f=p,d=rf(),d!==s?(n.charCodeAt(p)===58?(O=ul,p++):(O=s,v===0&&A(dl)),O!==s?(S=sf(),S!==s?(n.charCodeAt(p)===58?(b=ul,p++):(b=s,v===0&&A(dl)),b!==s?(_=ny(),_!==s?(T=iy(),T===s&&(T=null),T!==s?(d=[d,O,S,b,_,T],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),f}function rf(){var f,d,O;return v++,f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(d0)),f}function sf(){var f,d,O;return v++,f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(p0)),f}function ny(){var f,d,O;return v++,f=p,d=Oe(),d!==s?(O=Oe(),O!==s?(d=[d,O],f=d):(p=f,f=s)):(p=f,f=s),v--,f===s&&(d=s,v===0&&A(m0)),f}function iy(){var f,d,O,S;if(f=p,n.charCodeAt(p)===46?(d=Ur,p++):(d=s,v===0&&A(Fr)),d!==s){if(O=[],S=Oe(),S!==s)for(;S!==s;)O.push(S),S=Oe();else O=s;O!==s?(d=[d,O],f=d):(p=f,f=s)}else p=f,f=s;return f}function ry(){var f,d,O,S,b;return v++,n.charCodeAt(p)===90?(f=O0,p++):(f=s,v===0&&A(y0)),f===s&&(f=p,d=xl(),d!==s?(O=rf(),O!==s?(n.charCodeAt(p)===58?(S=ul,p++):(S=s,v===0&&A(dl)),S!==s?(b=sf(),b!==s?(d=[d,O,S,b],f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)):(p=f,f=s)),v--,f===s&&(d=s,v===0&&A(g0)),f}function sy(){var f,d,O,S,b,_,T,B,G,ne;if(f=p,n.charCodeAt(p)===91?(d=pl,p++):(d=s,v===0&&A(ml)),d!==s){for(O=[],S=Ct();S!==s;)O.push(S),S=Ct();if(O!==s){if(S=p,b=of(),b!==s){for(_=[],T=Ct();T!==s;)_.push(T),T=Ct();if(_!==s){if(T=p,n.charCodeAt(p)===44?(B=zr,p++):(B=s,v===0&&A(Hr)),B!==s){for(G=[],ne=Ct();ne!==s;)G.push(ne),ne=Ct();G!==s?(B=[B,G],T=B):(p=T,T=s)}else p=T,T=s;T===s&&(T=null),T!==s?(b=[b,_,T],S=b):(p=S,S=s)}else p=S,S=s}else p=S,S=s;S===s&&(S=null),S!==s?(n.charCodeAt(p)===93?(b=gl,p++):(b=s,v===0&&A(Ol)),b!==s?(J=f,d=S0(S),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s}else p=f,f=s;return f}function of(){var f,d,O,S,b,_,T;if(f=p,d=zc(),d!==s){for(O=p,S=[],b=Ct();b!==s;)S.push(b),b=Ct();if(S!==s)if(n.charCodeAt(p)===44?(b=zr,p++):(b=s,v===0&&A(Hr)),b!==s){for(_=[],T=Ct();T!==s;)_.push(T),T=Ct();_!==s?(T=of(),T!==s?(S=[S,b,_,T],O=S):(p=O,O=s)):(p=O,O=s)}else p=O,O=s;else p=O,O=s;O===s&&(O=null),O!==s?(J=f,d=b0(d,O),f=d):(p=f,f=s)}else p=f,f=s;return f}function Ct(){var f;return f=z(),f===s&&(f=Me(),f===s&&(f=Ni())),f}function oy(){var f,d,O,S,b,_,T,B,G,ne,Je;if(f=p,n.charCodeAt(p)===123?(d=w0,p++):(d=s,v===0&&A(x0)),d!==s){for(O=[],S=z();S!==s;)O.push(S),S=z();if(O!==s){if(S=p,b=Kr(),b!==s){for(_=[],T=p,B=[],G=z();G!==s;)B.push(G),G=z();if(B!==s)if(n.charCodeAt(p)===44?(G=zr,p++):(G=s,v===0&&A(Hr)),G!==s){for(ne=[],Je=z();Je!==s;)ne.push(Je),Je=z();ne!==s?(Je=Kr(),Je!==s?(B=[B,G,ne,Je],T=B):(p=T,T=s)):(p=T,T=s)}else p=T,T=s;else p=T,T=s;for(;T!==s;){for(_.push(T),T=p,B=[],G=z();G!==s;)B.push(G),G=z();if(B!==s)if(n.charCodeAt(p)===44?(G=zr,p++):(G=s,v===0&&A(Hr)),G!==s){for(ne=[],Je=z();Je!==s;)ne.push(Je),Je=z();ne!==s?(Je=Kr(),Je!==s?(B=[B,G,ne,Je],T=B):(p=T,T=s)):(p=T,T=s)}else p=T,T=s;else p=T,T=s}if(_!==s){for(T=[],B=z();B!==s;)T.push(B),B=z();T!==s?(b=[b,_,T],S=b):(p=S,S=s)}else p=S,S=s}else p=S,S=s;S===s&&(S=null),S!==s?(n.charCodeAt(p)===125?(b=P0,p++):(b=s,v===0&&A(v0)),b!==s?(J=f,d=_0(S),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s}else p=f,f=s;return f}function ly(){var f,d,O,S;return f=p,n.charCodeAt(p)===91?(d=pl,p++):(d=s,v===0&&A(ml)),d!==s?(O=lf(),O!==s?(n.charCodeAt(p)===93?(S=gl,p++):(S=s,v===0&&A(Ol)),S!==s?(J=f,d=$0(O),f=d):(p=f,f=s)):(p=f,f=s)):(p=f,f=s),f}function lf(){var f,d,O,S,b,_,T,B,G,ne;if(f=p,n.charCodeAt(p)===91?(d=pl,p++):(d=s,v===0&&A(ml)),d!==s){for(O=[],S=z();S!==s;)O.push(S),S=z();if(O!==s)if(S=es(),S!==s){for(b=[],_=p,T=[],B=z();B!==s;)T.push(B),B=z();if(T!==s)if(n.charCodeAt(p)===46?(B=Ur,p++):(B=s,v===0&&A(Fr)),B!==s){for(G=[],ne=z();ne!==s;)G.push(ne),ne=z();G!==s?(ne=es(),ne!==s?(T=[T,B,G,ne],_=T):(p=_,_=s)):(p=_,_=s)}else p=_,_=s;else p=_,_=s;for(;_!==s;){for(b.push(_),_=p,T=[],B=z();B!==s;)T.push(B),B=z();if(T!==s)if(n.charCodeAt(p)===46?(B=Ur,p++):(B=s,v===0&&A(Fr)),B!==s){for(G=[],ne=z();ne!==s;)G.push(ne),ne=z();G!==s?(ne=es(),ne!==s?(T=[T,B,G,ne],_=T):(p=_,_=s)):(p=_,_=s)}else p=_,_=s;else p=_,_=s}if(b!==s){for(_=[],T=z();T!==s;)_.push(T),T=z();_!==s?(n.charCodeAt(p)===93?(T=gl,p++):(T=s,v===0&&A(Ol)),T!==s?(J=f,d=T0(S,b),f=d):(p=f,f=s)):(p=f,f=s)}else p=f,f=s}else p=f,f=s;else p=f,f=s}else p=f,f=s;return f}var nn,Fi,Pl,vl,En,af,hf,_l,$l;nn=function(f){return"Value for "+f+" should not be redefined in the same table."},Fi=Number.isFinite||function(f){return typeof f=="number"&&isFinite(f)},Pl=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},vl=function(f,d){return Object.prototype.hasOwnProperty.call(f,d)},En=typeof JSON=="object"&&JSON?JSON.stringify:function(f){return'"'+String(f).replace(/[\x00-\x1F"\\]/g,function(d){switch(d){case'"':case"\\":return"\\"+d;case"	":return"\\t";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"\f":return"\\f";default:var O=d.charCodeAt(0).toString(16);return"\\u"+"0000".substr(O.length)+O}})+'"'},af=function(f){switch(f){case'"':case"\\":return f;case"t":return"	";case"n":return`
`;case"r":return"\r";case"b":return"\b";case"f":return"\f";default:Xe(En(f)+" cannot be escaped.")}},hf=function(f){if((!Fi(f)||f<0||f>1114111)&&Xe("U+"+f.toString(16)+" is not a valid Unicode code point."),String.fromCodePoint)return String.fromCodePoint(f);var d="";return f>65535&&(f-=65536,d+=String.fromCharCode(f>>>10&1023|55296),f=56320|f&1023),d+=String.fromCharCode(f),d},_l=function(f,d){vl(f,d)&&Xe(nn(En(d)))},$l=function(f,d,O){for(var S="",b=0,_=O.length;b<_;b++){var T=O[b];if(S+=(S?".":"")+En(T),vl(f,T))if(d)if(Pl(f[T]))if(ji[S]||Xe(nn(S)),b+1===_){var B={};f[T].push(B),f=B}else S+="."+En(f[T].length-1),f=f[T][f[T].length-1];else Tl[S]||Xe(nn(S)),f=f[T];else Pl(f[T])?((!ji[S]||b+1===_)&&Xe(nn(S)),S+="."+En(f[T].length-1),f=f[T][f[T].length-1]):(Tl[S]||Xe(nn(S)),f=f[T]);else if(d&&b+1===_){var B={};f[T]=[B],f=B,ji[S]=!0}else f=f[T]={},Tl[S]=!0}return d?ji[S]||Xe(nn(S)):((cf[S]||ji[S])&&Xe(nn(S)),cf[S]=!0),{table:f,path:O}};var ns={},is={table:ns,path:[]},Tl={},cf={},ji={};if(Jr=l(),Jr!==s&&p===n.length)return Jr;throw Jr!==s&&p<n.length&&A(I0()),Uc(yl,At<n.length?n.charAt(At):null,At<n.length?Yi(At,At+1):Yi(At,At))}return{SyntaxError:e,parse:t}}()});var Sf=ff((fv,yf)=>{"use strict";function my(i,e){function t(){this.constructor=i}t.prototype=e.prototype,i.prototype=new t}function kl(i,e,t,n){this.message=i,this.offset=e,this.line=t,this.column=n}my(kl,SyntaxError);var Of=gf(),gy={parse:function(i){try{return Of.parse(i)}catch(e){throw e instanceof Of.SyntaxError?(e.line=e.location.start.line,e.column=e.location.start.column,e.offset=e.location.start.offset,new kl(e.message,e.location.start.offset,e.location.start.line,e.location.start.column)):e}},SyntaxError:kl};yf.exports=gy});var iv={};uf(iv,{PyScriptApp:()=>ll,interpreter:()=>bO,runtime:()=>wO,version:()=>ei});var ze=(i,e=document)=>e.querySelector(i),xt=(i,e=document)=>[...e.querySelectorAll(i)],pf=(i,e=document)=>{let n=new XPathEvaluator().createExpression(i).evaluate(e,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),r=[];for(let s=0,{snapshotLength:o}=n;s<o;s++)r.push(n.snapshotItem(s));return r};var vf=dy(Sf());var bf=new Map;function ye(i){let e=bf.get(i);return e===void 0&&(e=Oy(i),bf.set(i,e)),e}function Oy(i){i=`[${i}] `;function e(o){let l=console[o].bind(console);function a(h,...c){l(i+h,...c)}return a}let t=e("debug"),n=e("info"),r=e("warn"),s=e("error");return{debug:t,info:n,warn:r,error:s}}var ei="2022.12.1.dev";var yy=`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill="currentColor" width="12px"><path d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/></svg>`;var Se=class extends Error{constructor(t,n,r="text"){super(n);this.errorCode=t,this.name="UserError",this.messageType=r,this.message=`(${t}): ${n}`,this.$$isUserError=!0}},Et=class extends Se{constructor(t,n){super(t,n);this.name="FetchError"}},ss=class extends Se{constructor(t,n){super(t,n);this.name="InstallError"}};function Ft(i,e="error",t="text",n=!0){switch(`log-${e}-${n}`){case"log-error-true":console.error(i);break;case"log-warning-true":console.warn(i);break}let r=document.createElement("div");if(r.className=`alert-banner py-${e}`,t==="html"?r.innerHTML=i:r.textContent=i,e==="warning"){let s=document.createElement("button");s.id="alert-close-button",s.addEventListener("click",()=>{r.remove()}),s.innerHTML=yy,r.appendChild(s)}document.body.prepend(r)}function Il(i){return i.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ti(i){return new DOMParser().parseFromString(Al(Il(i)),"text/html").documentElement.textContent}function Al(i){let e=i.split(`
`);if(e.length==0)return i;let t=e.filter(r=>r.trim().length!=0).map(r=>r.match(/^\s*/)?.pop()?.length),n=Math.min(...t);return n!=0?e.map(r=>r.substring(n)).join(`
`):i}var Sy=0;function Wn(i){i.id===""&&(i.id=`py-internal-${Sy++}`)}function jt(i,e="text"){Ft(i,"warning",e)}function wf(i){let e=new XMLHttpRequest;return e.open("GET",i,!1),e.send(),e.responseText}function os(i,e="/"){let t=i.map(function(n){return n.trim().replace(/(^[/]*|[/]*$)/g,"")}).filter(n=>n!==""&&n!==".").join(e||"/");return i[0].startsWith("/")?"/"+t:t}function ls(i,e){Xi(i,e)}function Xi(i,e){let t=xt(".alert-banner, .py-warning",document),n=0;for(let r of t)r.innerHTML.includes(e||i)&&n++;n==0&&Ft(i,"warning")}function xf(){let i=Promise.resolve();async function e(){let t=i,n;return i=new Promise(r=>n=r),await t,n}return e}var _f=ye("py-config"),$f=Object.entries({string:["name","description","version","type","author_name","author_email","license","execution_thread"],number:["schema_version"],array:["runtimes","interpreters","packages","fetch","plugins"]}),El={schema_version:1,type:"app",interpreters:[{src:"https://cdn.jsdelivr.net/pyodide/v0.22.1/full/pyodide.js",name:"pyodide-0.22.1",lang:"python"}],runtimes:[],packages:[],fetch:[],plugins:[],execution_thread:"main"};function Tf(i){let e,t;if(i===null)e={},t={};else{let r=i.getAttribute("type")||"toml";e=by(i,r),t=wy(i,r)}e=Pf(e,El);let n=Pf(t,e);return n.pyscript={version:ei,time:new Date().toISOString()},n}function by(i,e){let t=i.getAttribute("src");return t?(_f.info("loading ",t),kf(wf(t),e)):{}}function wy(i,e){return i.innerHTML!==""?(_f.info("loading <py-config> content"),kf(ti(i.innerHTML),e)):{}}function Cl(i,e){for(let t in i)t in El||(e[t]=i[t]);return e}function Pf(i,e){if(Object.keys(i).length===0&&Object.keys(e).length===0)return El;if(Object.keys(i).length===0)return e;if(Object.keys(e).length===0)return i;{let t={};for(let[n,r]of $f)r.forEach(function(s){n==="boolean"?t[s]=typeof i[s]<"u"?i[s]:e[s]:t[s]=i[s]||e[s]});return t=Cl(e,t),t=Cl(i,t),t}}function xy(i,e="toml"){if(e==="toml"){if(i.trim()[0]==="{")throw new Se("PY1000",`The config supplied: ${i} is an invalid TOML and cannot be parsed`);try{return vf.default.parse(i)}catch(t){let r=t.toString();throw new Se("PY1000",`The config supplied: ${i} is an invalid TOML and cannot be parsed: ${r}`)}}else if(e==="json")try{return JSON.parse(i)}catch(t){let r=t.toString();throw new Se("PY1000",`The config supplied: ${i} is an invalid JSON and cannot be parsed: ${r}`)}else throw new Se("PY1000",`The type of config supplied '${e}' is not supported, supported values are ["toml", "json"]`)}function kf(i,e="toml"){let t=xy(i,e),n={};for(let[r,s]of $f)s.forEach(function(o){if(as(o,r,t))if(o==="interpreters")n[o]=[],t[o].forEach(function(a){let h={};for(let c in a)as(c,"string",a)&&(h[c]=a[c]);n[o].push(h)});else if(o==="runtimes")ls("The configuration option `config.runtimes` is deprecated. Please use `config.interpreters` instead.",""),n.interpreters=[],t[o].forEach(function(a){let h={};for(let c in a)as(c,"string",a)&&(h[c]=a[c]);n.interpreters.push(h)});else if(o==="fetch")n[o]=[],t[o].forEach(function(a){let h={};for(let c in a)as(c,c==="files"?"array":"string",a)&&(h[c]=a[c]);n[o].push(h)});else if(o=="execution_thread"){let l=t[o];if(l!=="main"&&l!=="worker")throw new Se("PY1000",`"${l}" is not a valid value for the property "execution_thread". The only valid values are "main" and "worker"`);n[o]=l}else n[o]=t[o]});return Cl(t,n)}function as(i,e,t){return i in t?e==="array"?Array.isArray(t[i]):typeof t[i]===e:!1}var tr={};uf(tr,{FakeMessageChannel:()=>er,Syncifier:()=>cs,createEndpoint:()=>Mf,expose:()=>si,interrupt_buffer:()=>Xl,proxy:()=>Wt,proxyMarker:()=>Fl,releaseProxy:()=>Df,setInterruptHandler:()=>Zf,transfer:()=>Jl,transferHandlers:()=>sn,windowEndpoint:()=>Uf,wrap:()=>oi});var Wf=Object.defineProperty,Py=Object.defineProperties,vy=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,_y=Object.prototype.hasOwnProperty,$y=Object.prototype.propertyIsEnumerable,Ty=Math.pow,Af=(i,e,t)=>e in i?Wf(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Ji=(i,e)=>{for(var t in e||={})_y.call(e,t)&&Af(i,t,e[t]);if(If)for(var t of If(e))$y.call(e,t)&&Af(i,t,e[t]);return i},Qf=(i,e)=>Py(i,vy(e)),N=(i,e)=>Wf(i,"name",{value:e,configurable:!0}),ii=(i,e,t)=>new Promise((n,r)=>{var s=a=>{try{l(t.next(a))}catch(h){r(h)}},o=a=>{try{l(t.throw(a))}catch(h){r(h)}},l=a=>a.done?n(a.value):Promise.resolve(a.value).then(s,o);l((t=t.apply(i,e)).next())}),ky={RAW:1,PROXY:1,THROW:1,HANDLER:1,ID:1},Iy=new Set(Object.keys(ky)),Ay={SET:1,GET:1,APPLY:1,CONSTRUCT:1,ENDPOINT:1,RELEASE:1,DESTROY:1},Cy=new Set(Object.keys(Ay));function Nl(i){let e=Ul();return[e,new Promise(t=>{i.addEventListener("message",N(function n(r){!r.data||!r.data.id||r.data.id!==e||(i.removeEventListener("message",n),t(r.data))},"l")),i.start&&i.start()})]}N(Nl,"requestResponseMessageInner");function Gi(i,e,t){let[n,r]=Nl(i);return i.postMessage(Ji({id:n},e),t),r}N(Gi,"requestResponseMessage");var Wl=63;function Rf(){let i=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16),e=15-i.length;return e>0&&(i=Array.from({length:e},t=>0).join("")+i),i}N(Rf,"randomSegment");function Ul(){let i=Array.from({length:4},Rf).join("-");if(i.length!==Wl)throw new Error("synclink internal error: UUID has the wrong length");return i}N(Ul,"generateUUID");var Mf=Symbol("Synclink.endpoint"),Df=Symbol("Synclink.releaseProxy"),Fl=Symbol("Synclink.proxy"),Ql;typeof SharedArrayBuffer>"u"?Ql=ArrayBuffer:Ql=SharedArrayBuffer;var fs=Ql,Cf=new TextDecoder("utf-8"),Ef=new TextEncoder,Rl=0,Ml=1,Ey=0;function jl(i){return new Promise(e=>setTimeout(e,i))}N(jl,"sleep");var zi=class{constructor(i,e,t=[],n=()=>{}){this.endpoint=i,this.msg=e,this.extra=n,this.transfers=t,this._resolved=!1,this._promise=new Promise((r,s)=>{this._resolve=r,this._reject=s})}schedule_async(){if(this.mode==="async")return this;if(this.mode==="sync")throw new Error("Already synchronously scheduled");return this.mode="async",this.do_async().then(i=>{this._resolved=!0,this._result=i,this._resolve(i)},i=>{this._exception=i,this._reject(i)}),this}then(i,e){return ii(this,null,function*(){return this.schedule_async(),this._promise.then(i,e)})}catch(i){return this.schedule_async(),this._promise.catch(i)}finally(i){return this.schedule_async(),this._promise.finally(i)}schedule_sync(){if(this.mode==="sync")return this;if(this.mode==="async")throw new Error("Already asynchronously scheduled");return this.mode="sync",cs.scheduleTask(this),this._sync_gen=this.do_sync(),this._sync_gen.next(),this}isResolved(){return this._resolved}poll(){if(this.mode!="sync")throw new Error("Task not synchronously scheduled");let{done:i,value:e}=this._sync_gen.next();if(!i)return!1;try{this._resolved=!0,this._result=rn(this.endpoint,e)}catch(t){console.warn("synclink exception:",t),this._exception=t}return!0}*do_sync(){let{endpoint:i,msg:e,transfers:t}=this,n=new Int32Array(new fs(8)),r=this.signal_buffer,s=this.taskId,o=Ll(Wl);if(i.postMessage(Qf(Ji({},e),{size_buffer:n,data_buffer:o,signal_buffer:r,taskId:s,syncify:!0}),t),yield,Atomics.load(n,Ml)===Ey){let a=Cf.decode(o.slice(0,Wl));qf(o);let h=Atomics.load(n,Rl);o=Ll(h),i.postMessage({id:a,data_buffer:o}),yield}let l=Atomics.load(n,Rl);return JSON.parse(Cf.decode(o.slice(0,l)))}do_async(){return ii(this,null,function*(){let i=yield Gi(this.endpoint,this.msg,this.transfers);return this.extra(),rn(this.endpoint,i)})}get result(){if(this._exception)throw this._exception;if(this.isResolved())return this._result;throw new Error("Not ready.")}syncify(){return this.schedule_sync(),cs.syncifyTask(this),this.result}};N(zi,"SynclinkTask");function Dl(i,e){return ii(this,null,function*(){let t=(e>>1)%32,n=1;for(;Atomics.compareExchange(i,t+1,0,e)!==0;)yield jl(n),n<32&&(n*=2);Atomics.or(i,0,1<<t),Atomics.notify(i,0)})}N(Dl,"signalRequester");function Lf(i,e,t){return ii(this,null,function*(){try{let{size_buffer:n,data_buffer:r,signal_buffer:s,taskId:o}=e,l=Ef.encode(JSON.stringify(t)),a=l.length<=r.length;if(Atomics.store(n,Rl,l.length),Atomics.store(n,Ml,+a),!a){let[h,c]=Nl(i);r.set(Ef.encode(h)),yield Dl(s,o),r=(yield c).data_buffer}r.set(l),Atomics.store(n,Ml,1),yield Dl(s,o)}catch(n){console.warn(n)}})}N(Lf,"syncResponse");var hs=[];function Ll(i){let e=Math.ceil(Math.log2(i));hs[e]||(hs[e]=[]);let t=hs[e].pop();return t?(t.fill(0),t):new Uint8Array(new fs(Ty(2,e)))}N(Ll,"acquireDataBuffer");function qf(i){let e=Math.ceil(Math.log2(i.byteLength));hs[e].push(i)}N(qf,"releaseDataBuffer");var Xl=new Int32Array(new fs(4)),Bf=N(()=>{throw Xl[0]=0,new Error("Interrupted!")},"handleInterrupt");function Zf(i){Bf=i}N(Zf,"setInterruptHandler");var Vf=class{constructor(){this.nextTaskId=new Int32Array([1]),this.signal_buffer=new Int32Array(new fs(32*4+4)),this.tasks=new Map}scheduleTask(i){i.taskId=this.nextTaskId[0],this.nextTaskId[0]+=2,i.signal_buffer=this.signal_buffer,this.tasks.set(i.taskId,i)}waitOnSignalBuffer(){let i=50;for(;;)switch(Atomics.wait(this.signal_buffer,0,0,i)){case"ok":case"not-equal":return;case"timed-out":Xl[0]!==0&&Bf();break;default:throw new Error("Unreachable")}}*tasksIdsToWakeup(){let i=Atomics.load(this.signal_buffer,0);for(let e=0;e<32;e++){let t=1<<e;i&t&&(Atomics.and(this.signal_buffer,0,~t),yield Atomics.exchange(this.signal_buffer,e+1,0))}}pollTasks(i){let e=!1;for(let t of this.tasksIdsToWakeup()){let n=this.tasks.get(t);if(!n)throw new Error(`Assertion error: unknown taskId ${t}.`);n.poll()&&(this.tasks.delete(t),n===i&&(e=!0))}return e}syncifyTask(i){for(;;){if(this.pollTasks(i))return;if(i.endpoint._bypass)throw new Error("oops!");this.waitOnSignalBuffer()}}};N(Vf,"_Syncifier");var cs=new Vf;N(function(){return ii(this,null,function*(){for(;;)cs.pollTasks(),yield jl(20)})},"syncifyPollLoop")();function zl(i,e,t){let{id:n,path:r,store_key:s}=Ji({path:[],store_key:void 0},t),o;if(s?o=na(e,s):o=i,i===void 0&&s===void 0)throw console.warn(i,t),new Error("Internal synclink error!");let l=(t.argumentList||[]).map(u=>u.type==="PROXY"?zl(i,e,u.message):rn(e,u)),a=r.pop(),h=r.reduce((u,m)=>u[m],o),c=a?h[a]:o;if(a||(h=void 0),c===void 0)switch(t.type){case"GET":case"SET":break;default:throw console.warn("Undefined",o,r,a),new Error(`undefined!! ${o}, ${r}, ${a}`)}switch(t.type){case"GET":return c;case"SET":return h[a]=rn(e,t.value),!0;case"APPLY":return a?h[a].apply(h,l):c.apply(h,l);case"CONSTRUCT":{let u=new c(...l);return Wt(u)}break;case"ENDPOINT":{let{port1:u,port2:m}=new MessageChannel;return si(o,m),Jl(u,[u])}break;case"RELEASE":return;case"DESTROY":{Hf(e,s);return}break;default:return}}N(zl,"innerMessageHandler");function si(i,e=globalThis){Hl(i,e,!1)}N(si,"expose");function Hl(i,e=globalThis,t){ta(e),e.addEventListener("message",N(function n(r){return ii(this,null,function*(){if(!r||!r.data)return;if(!Cy.has(r.data.type)){if(!Iy.has(r.data.type)&&!r.data.data_buffer)throw console.warn("Internal error on message:",r.data),new Error(`Synclink Internal error: Expected message.type to either be a MessageType or a WireValueType, got '${r.data.type}'`);return}let s=r.data,{id:o,type:l,store_key:a}=Ji({store_key:void 0},s);if(t&&a===void 0)return;let h=r.data.syncify,c;try{if(c=zl(i,e,s),c&&c.then){if(h&&e._bypass)throw new Error("Cannot use syncify with bypass on an async method");c=yield c}}catch(g){c={value:g,[Ff]:0}}let[u,m]=us(e,c);h?Lf(e,r.data,u):e.postMessage(Qf(Ji({},u),{id:o}),m),l==="RELEASE"&&(e.removeEventListener("message",n),Gl(e))})},"callback")),e.start&&e.start()}N(Hl,"exposeInner");function Yf(i){return i.constructor.name==="MessagePort"}N(Yf,"isMessagePort");function Gl(i){Yf(i)&&i.close()}N(Gl,"closeEndPoint");function oi(i,e){return Hl(void 0,i,!0),Ki(i,{target:e})}N(oi,"wrap");function Hi(i){if(i)throw new Error("Proxy has been released and is not usable")}N(Hi,"throwIfProxyReleased");function Ki(i,{store_key:e=void 0,path:t=[],target:n=N(function(){},"target")}){let r=!1,s=new Proxy(n,{get(o,l){switch(Hi(r),l){case"$$ep":return i;case Symbol.toStringTag:return"SynclinkProxy";case Df:return()=>new zi(i,{type:"RELEASE",path:t.map(h=>h.toString())},[],()=>{Gl(i),r=!0});case"__destroy__":return e?()=>new zi(i,{type:"DESTROY",store_key:e},[],()=>{r=!0}):()=>{};case"_as_message":return()=>({type:"GET",store_key:e,path:t.map(h=>h.toString())});case"then":case"schedule_async":case"schedule_sync":case"syncify":if(t.length===0&&l==="then")return{then:()=>s};let a=new zi(i,{type:"GET",store_key:e,path:t.map(h=>h.toString())},[],void 0);return a[l].bind(a);default:return Ki(i,{store_key:e,path:[...t,l]})}},set(o,l,a){Hi(r);let[h,c]=us(i,a);return Gi(i,{type:"SET",store_key:e,path:[...t,l].map(u=>u.toString()),value:h},c).then(u=>rn(i,u))},apply(o,l,a){Hi(r);let h=t[t.length-1];if(h===Mf)return Gi(i,{type:"ENDPOINT"}).then(m=>rn(i,m));if(h==="bind")return Ki(i,{store_key:e,path:t.slice(0,-1)});h==="apply"&&(a=a[1],t=t.slice(0,-1));let[c,u]=ql(i,a);return new zi(i,{type:"APPLY",store_key:e,path:t.map(m=>m.toString()),argumentList:c},u,void 0)},construct(o,l){Hi(r);let[a,h]=ql(i,l);return Gi(i,{type:"CONSTRUCT",store_key:e,path:t.map(c=>c.toString()),argumentList:a},h).then(c=>rn(i,c))},ownKeys(o){return[]}});return s}N(Ki,"createProxy");function Nf(i){return Array.prototype.concat.apply([],i)}N(Nf,"myFlat");function ql(i,e){let t=e.map(n=>us(i,n));return[t.map(n=>n[0]),Nf(t.map(n=>n[1]))]}N(ql,"processArguments");function Uf(i,e=self,t="*"){return{postMessage:(n,r)=>i.postMessage(n,t,r),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}N(Uf,"windowEndpoint");var Bl=class{constructor(){this._handlers=[],this._bypass=!0,this._otherPort=this}start(){}close(){}addEventListener(i,e){i==="message"&&this._handlers.push(e)}removeEventListener(i,e){if(i!=="message")return;let t=this._handlers.indexOf(e);t>=0&&this._handlers.splice(t,1)}postMessage(i,e){for(let t of this._otherPort._handlers)t({data:i})}};N(Bl,"FakeMessagePort");var er=class{constructor(){this.port1=new Bl,this.port2=new Bl,this.port1._otherPort=this.port2,this.port2._otherPort=this.port1}};N(er,"FakeMessageChannel");var Ff=Symbol("Synclink.thrown"),Zl=new WeakMap;function Jl(i,e){return Zl.set(i,e),i}N(Jl,"transfer");var jf=N(i=>typeof i=="object"&&i!==null||typeof i=="function","isObject"),sn=new Map;function Xf(i){return ArrayBuffer.isView(i)||Object.prototype.toString.call(i)==="[object ArrayBuffer]"}N(Xf,"isArrayBufferOrView");function Vl(i){return!i||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||Array.isArray(i)||Xf(i)||!i.constructor||i.constructor===Object&&Object.prototype.toString.call(i)==="[object Object]"}N(Vl,"isPlain");function Kl(i,e=[]){if(e.includes(i))return!0;if(!Vl(i))return!1;for(var t in i)if(i.hasOwnProperty(t)&&(!Vl(i[t])||typeof i[t]=="object"&&!Kl(i[t],e)))return!1;return!0}N(Kl,"isSerializable");var Wy={canHandle:i=>jf(i)&&Ff in i,serialize({value:i}){let e;return i instanceof Error?e={isError:!0,value:{message:i.message,name:i.name,stack:i.stack}}:e={isError:!1,value:i},[e,[]]},deserialize(i){throw i.isError?Object.assign(new Error(i.value.message),i.value):i.value}};function us(i,e){if(e&&e.$$ep===i)return[{type:"PROXY",message:e._as_message()},[]];if(e&&e.constructor&&e.constructor.name==="SynclinkTask")return[{type:"PROXY",message:e.msg},[]];i._bypass&&(Yl=!0);try{for(let[n,r]of sn)if(r.canHandle(e)){let[s,o]=r.serialize(e);return[{type:"HANDLER",name:n,value:s},o]}}finally{Yl=!1}return Kl(e,Zl.get(e))?[{type:"RAW",value:e},Zl.get(e)||[]]:[{type:"ID",store_key:zf(i,e),endpoint_uuid:i[ea],ownkeys:Object.getOwnPropertyNames(e)},[]]}N(us,"toWireValue");function rn(i,e){switch(e.type){case"HANDLER":return sn.get(e.name).deserialize(e.value);case"RAW":return e.value;case"ID":return i[ea]===e.endpoint_uuid?na(i,e.store_key):Ki(i,{store_key:e.store_key})}}N(rn,"fromWireValue");var ri=Symbol("Synclink.proxyStore"),ea=Symbol("Synclink.endpointUUID");function ta(i){ri in i||(i[ri]={objects:new Map,counter:new Uint32Array([1])},i[ea]=Ul())}N(ta,"storeCreate");function na(i,e){return i[ri].objects.get(e)}N(na,"storeGetValue");function zf(i,e){ri in i||ta(i);let{objects:t,counter:n}=i[ri];for(;t.has(n[0]);)n[0]+=2;let r=n[0];return n[0]+=2,t.set(r,e),r}N(zf,"storeNewValue");function Hf(i,e){let{objects:t}=i[ri];t.delete(e),console.log("deleted",e,t)}N(Hf,"storeDeleteKey");function Wt(i){return Object.assign(i,{[Fl]:!0})}N(Wt,"proxy");var Yl=!1,Qy={canHandle:i=>jf(i)&&i[Fl],serialize(i){let{port1:e,port2:t}=Yl?new er:new MessageChannel;return si(i,e),[t,[t]]},deserialize(i){return i.start(),oi(i)}};sn.set("throw",Wy);sn.set("proxy",Qy);sn.set("headers",{canHandle(i){return Object.prototype.toString.call(i)==="[object Headers]"},serialize(i){return[Array.from(i),[]]},deserialize(i){return new Headers(i)}});var Ry=ye("pyscript/interpreter"),ds=class extends Object{constructor(t,n,r,s){super();this.config=t,this._remote=r,this._unwrapped_remote=s,this.stdio=n}async initializeRemote(){await this._remote.loadInterpreter(this.config,Wt(this.stdio)),this.globals=this._remote.globals}async run(t,n){return this._remote.pyscript_internal.run_pyscript(t,n)}async runButDontRaise(t){let n;try{n=(await this.run(t)).result}catch(r){Ry.error("Error:",r)}return n}async pyimport(t){return this._remote.pyimport(t)}async mkdir(t){await this._remote.FS.mkdir(t)}async writeFile(t,n){await this._remote.FS.writeFile(t,n,{encoding:"utf8"})}};var ps=ye("plugin"),Qt=class{configure(e){}beforeLaunch(e){}afterSetup(e){}beforePyScriptExec(e){}afterPyScriptExec(e){}beforePyReplExec(e){}afterPyReplExec(e){}afterStartup(e){}onUserError(e){}},ms=class{constructor(){this._plugins=[],this._pythonPlugins=[]}add(...e){this._plugins.push(...e)}addPythonPlugin(e){this._pythonPlugins.push(e)}async configure(e){for(let t of this._plugins)t.configure?.(e);for(let t of this._pythonPlugins)await t.configure?.(e)}beforeLaunch(e){for(let t of this._plugins)try{t?.beforeLaunch?.(e)}catch(n){ps.error(`Error while calling beforeLaunch hook of plugin ${t.constructor.name}`,n)}}async afterSetup(e){for(let t of this._plugins)try{t.afterSetup?.(e)}catch(n){ps.error(`Error while calling afterSetup hook of plugin ${t.constructor.name}`,n)}for(let t of this._pythonPlugins)await t.afterSetup?.(e)}async afterStartup(e){for(let t of this._plugins)t.afterStartup?.(e);for(let t of this._pythonPlugins)await t.afterStartup?.(e)}async beforePyScriptExec(e){for(let t of this._plugins)t.beforePyScriptExec?.(e);for(let t of this._pythonPlugins)await t.beforePyScriptExec.callKwargs(e)}async afterPyScriptExec(e){for(let t of this._plugins)t.afterPyScriptExec?.(e);for(let t of this._pythonPlugins)await t.afterPyScriptExec.callKwargs(e)}async beforePyReplExec(e){for(let t of this._plugins)t.beforePyReplExec?.(e);for(let t of this._pythonPlugins)await t.beforePyReplExec?.callKwargs(e)}async afterPyReplExec(e){for(let t of this._plugins)t.afterPyReplExec?.(e);for(let t of this._pythonPlugins)await t.afterPyReplExec?.callKwargs(e)}async onUserError(e){for(let t of this._plugins)t.onUserError?.(e);for(let t of this._pythonPlugins)await t.onUserError?.(e)}};function Gf(i,e){ps.info(`creating plugin: ${i}`);class t extends HTMLElement{constructor(){ps.debug(`creating ${i} plugin instance`);super();this.wrapper=document.createElement("slot"),this.attachShadow({mode:"open"}).appendChild(this.wrapper),this.originalInnerHTML=this.innerHTML,this.pyElementInstance=e(this)}connectedCallback(){let s=this.pyElementInstance.connect();typeof s=="string"&&(this.innerHTML=s)}}customElements.define(i,t)}function My(i){if(!i.validator(i.defaultValue))throw Error(`Default value ${JSON.stringify(i.defaultValue)} for ${i.name} is not a valid argument, according to the provided validator function. ${i.hintMessage?i.hintMessage:""}`);let e=i.config[i.name];if(e!==void 0&&!i.validator(e)){let t=`Invalid value ${JSON.stringify(e)} for config.${i.name}. ${i.hintMessage?i.hintMessage:""}`;throw new Se("PY1000",t)}e===void 0&&(i.config[i.name]=i.defaultValue)}function ia(i){let e=n=>i.possibleValues.includes(n),t=`The only accepted values are: [${i.possibleValues.map(n=>JSON.stringify(n)).join(", ")}]`;My({config:i.config,name:i.name,validator:e,defaultValue:i.defaultValue,hintMessage:t})}var{iterator:Pt,species:Ev}=Symbol,Qn=new WeakMap,Dy=i=>{let e=new WeakRef(i);return Qn.set(i,e),e},ra=i=>Qn.get(i)||Dy(i),gs=class extends Set{#e=new FinalizationRegistry(e=>super.delete(e));#t(e){let t=super.delete(e);return t&&this.#e.unregister(e),t}get size(){return[...this].length}delete(e){return this.#t(Qn.get(e))}has(e){return super.has(Qn.get(e))}constructor(e=[]){super();for(let t of e)this.add(t)}clear(){for(let e of super[Pt]())this.#e.unregister(e);super.clear()}add(e){let t=ra(e);return super.has(t)||(this.#e.register(e,t,t),super.add(t)),this}forEach(e,t){for(let n of[...this])e.call(t,n,n,this)}*[Pt](){for(let e of super[Pt]()){let t=e.deref();t?yield t:this.#t(e)}}*entries(){for(let e of this)yield[e,e]}*keys(){yield*this[Pt]()}*values(){yield*this[Pt]()}},Jf=class extends Map{#e=new FinalizationRegistry(e=>super.delete(e));#t(e){let t=super.delete(e);return t&&this.#e.unregister(e),t}get size(){return[...this].length}delete(e){return this.#t(Qn.get(e))}has(e){return super.has(Qn.get(e))}constructor(e=[]){super();for(let[t,n]of e)this.set(t,n)}clear(){for(let e of super.keys())this.#e.unregister(e);super.clear()}forEach(e,t){for(let[n,r]of[...this])e.call(t,r,n,this)}get(e){return super.get(Qn.get(e))}set(e,t){let n=ra(e);return super.has(n)||this.#e.register(e,n,n),super.set(n,t)}*[Pt](){for(let[e,t]of super[Pt]()){let n=e.deref();n?yield[n,t]:this.#t(e)}}*entries(){yield*this[Pt]()}*keys(){for(let[e]of this)yield e}*values(){for(let[e,t]of this)yield t}},Kf=class extends Map{#e=new FinalizationRegistry(e=>super.delete(e));get size(){return[...this].length}#t(e,t){let n=super.delete(e);return n&&this.#e.unregister(t),n}constructor(e=[]){super();for(let[t,n]of e)this.set(t,n)}clear(){for(let e of super.values())this.#e.unregister(e);super.clear()}delete(e){return this.#t(e,super.get(e))}forEach(e,t){for(let[n,r]of[...this])e.call(t,r,n,this)}get(e){return super.get(e)?.deref()}set(e,t){let n=super.get(e);return n&&this.#e.unregister(n),n=ra(t),this.#e.register(t,e,n),super.set(e,n)}*[Pt](){for(let[e,t]of super[Pt]()){let n=t.deref();n?yield[e,n]:this.#t(e,t)}}*entries(){yield*this[Pt]()}*keys(){for(let[e]of this)yield e}*values(){for(let[e,t]of this)yield t}};var sa=new gs,Ly=i=>{for(let e of sa){let t=ze(i,e);if(t)return t}return null},eu=i=>ze(i,document)||Ly(i);var tu=ye("pyexec");async function ys(i,e,t){if(Wn(t),await i._remote.pyscript_internal.uses_top_level_await(e)){let n=new Se("PY9000",`The use of top-level "await", "async for", and "async with" has been removed.
Please write a coroutine containing your code and schedule it using asyncio.ensure_future() or similar.
See https://docs.pyscript.net/latest/guides/asyncio.html for more information.`);return Os(n,t),{result:void 0}}try{return await i.run(e,t.id)}catch(n){return Os(n,t),{result:void 0}}}async function oa(i,e,t={}){let n=await i.globals.get("display");try{await n.callKwargs(e,t)}finally{n.destroy()}}function Os(i,e){let t=document.createElement("pre");t.className="py-error",i.name==="PythonError"?(tu.error(`Python exception:
`+i.message),t.innerText=i.message):(tu.error(`Non-python exception:
`+i.toString()),t.innerText=i.toString()),e.appendChild(t)}async function on(i,e){let t;try{t=await fetch(i,e)}catch(n){let r=n,s;throw i.startsWith("http")?s=`Fetching from URL ${i} failed with error '${r.message}'. Are your filename and path correct?`:s=`PyScript: Access to local files
        (using [[fetch]] configurations in &lt;py-config&gt;)
        is not available when directly opening a HTML file;
        you must use a webserver to serve the additional files.
        See <a style="text-decoration: underline;" href="https://github.com/pyscript/pyscript/issues/257#issuecomment-1119595062">this reference</a>
        on starting a simple webserver with Python.
            `,new Et("PY0001",s)}if(!t.ok){let n=`Fetching from URL ${i} failed with error ${t.status} (${t.statusText}). Are your filename and path correct?`;switch(t.status){case 404:throw new Et("PY0404",n);case 401:throw new Et("PY0401",n);case 403:throw new Et("PY0403",n);case 500:throw new Et("PY0500",n);case 503:throw new Et("PY0503",n);default:throw new Et("PY0001",n)}}return t}var nu=ye("py-script"),Ss=new WeakSet;function iu(i,e){let t=async(s,o)=>{e.incrementPendingTags();let l;try{l=await e.tagExecutionLock(),Wn(s);let a=await n(s,o);await e.plugins.beforePyScriptExec({interpreter:i,src:a,pyScriptTag:s});let{result:h}=await ys(i,a,s);await e.plugins.afterPyScriptExec({interpreter:i,src:a,pyScriptTag:s,result:h})}finally{l(),e.decrementPendingTags()}},n=async(s,o)=>{if(s.hasAttribute("src"))try{return await(await on(s.getAttribute("src"))).text()}catch(l){let a=l;throw Ft(a.message),a}return o()};class r extends HTMLElement{constructor(){super(...arguments);this._fetchSourceFallback=()=>ti(this.srcCode)}async connectedCallback(){Ss.has(this)||(Ss.add(this),this.srcCode=this.innerHTML,this.innerHTML="",await t(this,this._fetchSourceFallback))}getPySrc(){return n(this,this._fetchSourceFallback)}}if(!customElements.get("py-script")){let s='script[type="py"],script[type="pyscript"],script[type="py-script"]',o=u=>{if(Ss.has(u))return;Ss.add(u);let m=document.createElement("py-script-tag");for(let g of["output","src","stderr"]){let y=u.getAttribute(g);y&&m.setAttribute(g,y)}u.after(m),t(m,()=>Al(u.textContent.replace(/^[\r\n]+/,""))).catch(()=>m.remove())},l=u=>{for(let m of xt(s,u))o(m)},a=new MutationObserver(u=>{for(let{type:m,target:g,attributeName:y,addedNodes:P}of u){if(m==="attributes"){y.startsWith("py-")&&(g.hasAttribute(y)?hu(la(g),g,y.slice(3)):g.removeEventListener(y.slice(3),au));continue}for(let x of P)x.nodeType===Node.ELEMENT_NODE&&(x.matches(s)?o(x):(ou(x),l(x)))}}),h=u=>(a.observe(u,{childList:!0,subtree:!0,attributes:!0}),u),{attachShadow:c}=Element.prototype;Object.assign(Element.prototype,{attachShadow(u){let m=h(c.call(this,u));return sa.add(m),m}}),l(document),h(document)}return r}var ru=new WeakMap,la=i=>ru.get(i)||su,su,ou=i=>{let e=pf('.//@*[starts-with(name(), "py-")]',i);for(let{name:t,ownerElement:n}of e)hu(la(n),n,t.slice(3))};function lu(i){nu.debug("Initializing py-* event handlers..."),su=i,ou(document)}var au=async({type:i,currentTarget:e})=>{try{await la(e).run(e.getAttribute(`py-${i}`))}catch(t){Os(t,e.parentElement)}};function hu(i,e,t){e.id.length===0&&Wn(e),ru.set(e,i),e.addEventListener(t,au)}async function cu(i){let e=xt("[py-mount]",document);nu.info(`py-mount: found ${e.length} elements`),e.length>0&&ls('The "py-mount" attribute is deprecated. Please add references to HTML Elements manually in your script.',"py-mount");let t="";for(let n of e){let r=n.getAttribute("py-mount")||n.id.split("-").join("_");t+=`
${r} = Element("${n.id}")`}await i.run(t)}function fu(i){for(let{files:e,to_file:t,from:n=""}of i){if(e!==void 0&&t!==void 0)throw new Se("PY1000","Cannot use 'to_file' and 'files' parameters together!");if(e===void 0&&t===void 0&&n.endsWith("/"))throw new Se("PY1000",`Couldn't determine the filename from the path ${n}, please supply 'to_file' parameter.`)}return i.flatMap(function({from:e="",to_folder:t=".",to_file:n,files:r}){if(r!==void 0)return r.map(l=>({url:os([e,l]),path:os([t,l])}));let s=n||e.slice(1+e.lastIndexOf("/")),o=os([t,s]);return[{url:e,path:o}]})}var X=class{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){let r=[];return this.decompose(0,e,r,2),n.length&&n.decompose(0,n.length,r,3),this.decompose(t,this.length,r,1),ft.from(r,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let n=[];return this.decompose(e,t,n,0),ft.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),r=new Dn(this),s=new Dn(e);for(let o=t,l=t;;){if(r.next(o),s.next(o),o=0,r.lineBreak!=s.lineBreak||r.done!=s.done||r.value!=s.value)return!1;if(l+=r.value.length,r.done||l>=n)return!0}}iter(e=1){return new Dn(this,e)}iterRange(e,t=this.length){return new Ps(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;n=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new vs(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?X.empty:e.length<=32?new ue(e):ft.from(ue.split(e,[]))}},ue=class extends X{constructor(e,t=qy(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.text[s],l=r+o.length;if((t?n:l)>=e)return new ha(r,l,n,o);r=l+1,n++}}decompose(e,t,n,r){let s=e<=0&&t>=this.length?this:new ue(uu(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let o=n.pop(),l=xs(s.text,o.text.slice(),0,s.length);if(l.length<=32)n.push(new ue(l,o.length+s.length));else{let a=l.length>>1;n.push(new ue(l.slice(0,a)),new ue(l.slice(a)))}}else n.push(s)}replace(e,t,n){if(!(n instanceof ue))return super.replace(e,t,n);let r=xs(this.text,xs(n.text,uu(this.text,0,e)),t),s=this.length+n.length-(t-e);return r.length<=32?new ue(r,s):ft.from(ue.split(r,[]),s)}sliceString(e,t=this.length,n=`
`){let r="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(r+=n),e<a&&t>s&&(r+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],r=-1;for(let s of e)n.push(s),r+=s.length+1,n.length==32&&(t.push(new ue(n,r)),n=[],r=-1);return r>-1&&t.push(new ue(n,r)),t}},ft=class extends X{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,r){for(let s=0;;s++){let o=this.children[s],l=r+o.length,a=n+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,n,r);r=l+1,n=a+1}}decompose(e,t,n,r){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let h=r&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!h?n.push(l):l.decompose(e-o,t-o,n,h)}o=a+1}}replace(e,t,n){if(n.lines<this.lines)for(let r=0,s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,n),h=this.lines-o.lines+a.lines;if(a.lines<h>>5-1&&a.lines>h>>5+1){let c=this.children.slice();return c[r]=a,new ft(c,this.length-(t-e)+n.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){let r="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(r+=n),e<a&&t>o&&(r+=l.sliceString(e-o,t-o,n)),o=a+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof ft))return 0;let n=0,[r,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,s+=t){if(r==o||s==l)return n;let a=this.children[r],h=e.children[s];if(a!=h)return n+a.scanIdentical(h,t);n+=a.length+1}}static from(e,t=e.reduce((n,r)=>n+r.length+1,-1)){let n=0;for(let g of e)n+=g.lines;if(n<32){let g=[];for(let y of e)y.flatten(g);return new ue(g,t)}let r=Math.max(32,n>>5),s=r<<1,o=r>>1,l=[],a=0,h=-1,c=[];function u(g){let y;if(g.lines>s&&g instanceof ft)for(let P of g.children)u(P);else g.lines>o&&(a>o||!a)?(m(),l.push(g)):g instanceof ue&&a&&(y=c[c.length-1])instanceof ue&&g.lines+y.lines<=32?(a+=g.lines,h+=g.length+1,c[c.length-1]=new ue(y.text.concat(g.text),y.length+1+g.length)):(a+g.lines>r&&m(),a+=g.lines,h+=g.length+1,c.push(g))}function m(){a!=0&&(l.push(c.length==1?c[0]:ft.from(c,h)),h=-1,a=c.length=0)}for(let g of e)u(g);return m(),l.length==1?l[0]:new ft(l,t)}};X.empty=new ue([""],0);function qy(i){let e=-1;for(let t of i)e+=t.length+1;return e}function xs(i,e,t=0,n=1e9){for(let r=0,s=0,o=!0;s<i.length&&r<=n;s++){let l=i[s],a=r+l.length;a>=t&&(a>n&&(l=l.slice(0,n-r)),r<t&&(l=l.slice(t-r)),o?(e[e.length-1]+=l,o=!1):e.push(l)),r=a+1}return e}function uu(i,e,t){return xs(i,[""],e,t)}var Dn=class{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ue?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,r=this.nodes[n],s=this.offsets[n],o=s>>1,l=r instanceof ue?r.text.length:r.children.length;if(o==(t>0?l:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof ue){let a=r.text[o+(t<0?-1:0)];if(this.offsets[n]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=r.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof ue?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},Ps=class{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new Dn(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=n?r:t<0?r.slice(r.length-n):r.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},vs=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:r}=this.inner.next(e);return t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(X.prototype[Symbol.iterator]=function(){return this.iter()},Dn.prototype[Symbol.iterator]=Ps.prototype[Symbol.iterator]=vs.prototype[Symbol.iterator]=function(){return this});var ha=class{constructor(e,t,n,r){this.from=e,this.to=t,this.number=n,this.text=r}get length(){return this.to-this.from}},li="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(i=>i?parseInt(i,36):1);for(let i=1;i<li.length;i++)li[i]+=li[i-1];function By(i){for(let e=1;e<li.length;e+=2)if(li[e]>i)return li[e-1]<=i;return!1}function du(i){return i>=127462&&i<=127487}var pu=8205;function Qe(i,e,t=!0,n=!0){return(t?bu:Zy)(i,e,n)}function bu(i,e,t){if(e==i.length)return e;e&&wu(i.charCodeAt(e))&&xu(i.charCodeAt(e-1))&&e--;let n=_e(i,e);for(e+=He(n);e<i.length;){let r=_e(i,e);if(n==pu||r==pu||t&&By(r))e+=He(r),n=r;else if(du(r)){let s=0,o=e-2;for(;o>=0&&du(_e(i,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function Zy(i,e,t){for(;e>0;){let n=bu(i,e-2,t);if(n<e)return n;e--}return 0}function wu(i){return i>=56320&&i<57344}function xu(i){return i>=55296&&i<56320}function _e(i,e){let t=i.charCodeAt(e);if(!xu(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return wu(n)?(t-55296<<10)+(n-56320)+65536:t}function or(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function He(i){return i<65536?1:2}var ca=/\r\n?|\n/,ke=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(ke||(ke={})),tt=class{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,r=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,s),r+=s):r+=o,n+=s}}iterChangedRanges(e,t=!1){fa(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];r<0?e.push(n,r):e.push(r,n)}return new tt(e)}composeDesc(e){return this.empty?e:e.empty?this:Pu(this,e)}mapDesc(e,t=!1){return e.empty?this:ua(this,e,t)}mapPos(e,t=-1,n=ke.Simple){let r=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],h=r+l;if(a<0){if(h>e)return s+(e-r);s+=l}else{if(n!=ke.Simple&&h>=e&&(n==ke.TrackDel&&r<e&&h>e||n==ke.TrackBefore&&r<e||n==ke.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!l)return e==r||t<0?s:s+a;s+=a}r=h}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return s}touchesRange(e,t=e){for(let n=0,r=0;n<this.sections.length&&r<=t;){let s=this.sections[n++],o=this.sections[n++],l=r+s;if(o>=0&&r<=t&&l>=e)return r<e&&l>t?"cover":!0;r=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new tt(e)}static create(e){return new tt(e)}},de=class extends tt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return fa(this,(t,n,r,s,o)=>e=e.replace(r,r+(n-t),o),!1),e}mapDesc(e,t=!1){return ua(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let r=0,s=0;r<t.length;r+=2){let o=t[r],l=t[r+1];if(l>=0){t[r]=l,t[r+1]=o;let a=r>>1;for(;n.length<a;)n.push(X.empty);n.push(o?e.slice(s,s+o):X.empty)}s+=o}return new de(t,n)}compose(e){return this.empty?e:e.empty?this:Pu(this,e,!0)}map(e,t=!1){return e.empty?this:ua(this,e,t,!0)}iterChanges(e,t=!1){fa(this,e,t)}get desc(){return tt.create(this.sections)}filter(e){let t=[],n=[],r=[],s=new Ln(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);Ze(r,c,-1);let u=s.ins==-1?-1:s.off==0?s.ins:0;Ze(t,c,u),u>0&&ln(n,t,s.text),s.forward(c),l+=c}let h=e[o++];for(;l<h;){if(s.done)break e;let c=Math.min(s.len,h-l);Ze(t,c,-1),Ze(r,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new de(t,n),filtered:tt.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],r=this.sections[t+1];r<0?e.push(n):r==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let r=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!r.length)return;o<t&&Ze(r,t-o,-1);let u=new de(r,s);l=l?l.compose(u.map(l)):u,r=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let u of c)h(u);else if(c instanceof de){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:u,to:m=u,insert:g}=c;if(u>m||u<0||m>t)throw new RangeError(`Invalid change range ${u} to ${m} (in doc of length ${t})`);let y=g?typeof g=="string"?X.of(g.split(n||ca)):g:X.empty,P=y.length;if(u==m&&P==0)return;u<o&&a(),u>o&&Ze(r,u-o,-1),Ze(r,m-u,P),ln(s,r,y),o=m}}return h(e),a(!l),l}static empty(e){return new de(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let r=0;r<e.length;r++){let s=e[r];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;n.length<r;)n.push(X.empty);n[r]=X.of(s.slice(1)),t.push(s[0],n[r].length)}}}return new de(t,n)}static createSet(e,t){return new de(e,t)}};function Ze(i,e,t,n=!1){if(e==0&&t<=0)return;let r=i.length-2;r>=0&&t<=0&&t==i[r+1]?i[r]+=e:e==0&&i[r]==0?i[r+1]+=t:n?(i[r]+=e,i[r+1]+=t):i.push(e,t)}function ln(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(X.empty);i.push(t)}}function fa(i,e,t){let n=i.inserted;for(let r=0,s=0,o=0;o<i.sections.length;){let l=i.sections[o++],a=i.sections[o++];if(a<0)r+=l,s+=l;else{let h=r,c=s,u=X.empty;for(;h+=l,c+=a,a&&n&&(u=u.append(n[o-2>>1])),!(t||o==i.sections.length||i.sections[o+1]<0);)l=i.sections[o++],a=i.sections[o++];e(r,h,s,c,u),r=h,s=c}}}function ua(i,e,t,n=!1){let r=[],s=n?[]:null,o=new Ln(i),l=new Ln(e);for(let a=-1;;)if(o.ins==-1&&l.ins==-1){let h=Math.min(o.len,l.len);Ze(r,h,-1),o.forward(h),l.forward(h)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let h=l.len;for(Ze(r,l.ins,-1);h;){let c=Math.min(o.len,h);o.ins>=0&&a<o.i&&o.len<=c&&(Ze(r,0,o.ins),s&&ln(s,r,o.text),a=o.i),o.forward(c),h-=c}l.next()}else if(o.ins>=0){let h=0,c=o.len;for(;c;)if(l.ins==-1){let u=Math.min(c,l.len);h+=u,c-=u,l.forward(u)}else if(l.ins==0&&l.len<c)c-=l.len,l.next();else break;Ze(r,h,a<o.i?o.ins:0),s&&a<o.i&&ln(s,r,o.text),a=o.i,o.forward(o.len-c)}else{if(o.done&&l.done)return s?de.createSet(r,s):tt.create(r);throw new Error("Mismatched change set lengths")}}function Pu(i,e,t=!1){let n=[],r=t?[]:null,s=new Ln(i),o=new Ln(e);for(let l=!1;;){if(s.done&&o.done)return r?de.createSet(n,r):tt.create(n);if(s.ins==0)Ze(n,s.len,0,l),s.next();else if(o.len==0&&!o.done)Ze(n,0,o.ins,l),r&&ln(r,n,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),h=n.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Ze(n,a,c,l),r&&c&&ln(r,n,o.text)}else o.ins==-1?(Ze(n,s.off?0:s.len,a,l),r&&ln(r,n,s.textBit(a))):(Ze(n,s.off?0:s.len,o.off?0:o.ins,l),r&&!o.off&&ln(r,n,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||n.length>h),s.forward2(a),o.forward(a)}}}}var Ln=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?X.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?X.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},Xt=class{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let n,r;return this.empty?n=r=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),n==this.from&&r==this.to?this:new Xt(n,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return $.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return $.range(this.anchor,n)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return $.range(e.anchor,e.head)}static create(e,t,n){return new Xt(e,t,n)}},$=class{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:$.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new $([this.main],0)}addRange(e,t=!0){return $.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,$.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new $(e.ranges.map(t=>Xt.fromJSON(t)),e.main)}static single(e,t=e){return new $([$.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,r=0;r<e.length;r++){let s=e[r];if(s.empty?s.from<=n:s.from<n)return $.normalized(e.slice(),t);n=s.to}return new $(e,t)}static cursor(e,t=0,n,r){return Xt.create(e,e,(t==0?0:t<0?4:8)|(n==null?3:Math.min(2,n))|(r??33554431)<<5)}static range(e,t,n,r){let s=(n??33554431)<<5|(r==null?3:Math.min(2,r));return t<e?Xt.create(t,e,24|s):Xt.create(e,t,(t>e?4:0)|s)}static normalized(e,t=0){let n=e[t];e.sort((r,s)=>r.from-s.from),t=e.indexOf(n);for(let r=1;r<e.length;r++){let s=e[r],o=e[r-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);r<=t&&t--,e.splice(--r,2,s.anchor>s.head?$.range(a,l):$.range(l,a))}}return new $(e,t)}};function vu(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}var ba=0,M=class{constructor(e,t,n,r,s){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=r,this.id=ba++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}static define(e={}){return new M(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:wa),!!e.static,e.enables)}of(e){return new ai([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ai(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ai(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}};function wa(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}var ai=class{constructor(e,t,n,r){this.dependencies=e,this.facet=t,this.type=n,this.value=r,this.id=ba++}dynamicSlot(e){var t;let n=this.value,r=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,h=!1,c=[];for(let u of this.dependencies)u=="doc"?a=!0:u=="selection"?h=!0:((t=e[u.id])!==null&&t!==void 0?t:1)&1||c.push(e[u.id]);return{create(u){return u.values[o]=n(u),1},update(u,m){if(a&&m.docChanged||h&&(m.docChanged||m.selection)||da(u,c)){let g=n(u);if(l?!mu(g,u.values[o],r):!r(g,u.values[o]))return u.values[o]=g,1}return 0},reconfigure:(u,m)=>{let g,y=m.config.address[s];if(y!=null){let P=$s(m,y);if(this.dependencies.every(x=>x instanceof M?m.facet(x)===u.facet(x):x instanceof le?m.field(x,!1)==u.field(x,!1):!0)||(l?mu(g=n(u),P,r):r(g=n(u),P)))return u.values[o]=P,0}else g=n(u);return u.values[o]=g,1}}}};function mu(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function da(i,e){let t=!1;for(let n of e)ir(i,n)&1&&(t=!0);return t}function Vy(i,e,t){let n=t.map(a=>i[a.id]),r=t.map(a=>a.type),s=n.filter(a=>!(a&1)),o=i[e.id]>>1;function l(a){let h=[];for(let c=0;c<n.length;c++){let u=$s(a,n[c]);if(r[c]==2)for(let m of u)h.push(m);else h.push(u)}return e.combine(h)}return{create(a){for(let h of n)ir(a,h);return a.values[o]=l(a),1},update(a,h){if(!da(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,h){let c=da(a,n),u=h.config.facets[e.id],m=h.facet(e);if(u&&!c&&wa(t,u))return a.values[o]=m,0;let g=l(a);return e.compare(g,m)?(a.values[o]=m,0):(a.values[o]=g,1)}}}var gu=M.define({static:!0}),le=class{constructor(e,t,n,r,s){this.id=e,this.createF=t,this.updateF=n,this.compareF=r,this.spec=s,this.provides=void 0}static define(e){let t=new le(ba++,e.create,e.update,e.compare||((n,r)=>n===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(gu).find(n=>n.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,r)=>{let s=n.values[t],o=this.updateF(s,r);return this.compareF(s,o)?0:(n.values[t]=o,1)},reconfigure:(n,r)=>r.config.address[this.id]!=null?(n.values[t]=r.field(this),0):(n.values[t]=this.create(n),1)}}init(e){return[this,gu.of({field:this,create:e})]}get extension(){return this}},Rn={lowest:4,low:3,default:2,high:1,highest:0};function nr(i){return e=>new _s(e,i)}var _t={highest:nr(Rn.highest),high:nr(Rn.high),default:nr(Rn.default),low:nr(Rn.low),lowest:nr(Rn.lowest)},_s=class{constructor(e,t){this.inner=e,this.prec=t}},an=class{of(e){return new rr(this,e)}reconfigure(e){return an.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}},rr=class{constructor(e,t){this.compartment=e,this.inner=t}},ci=class{constructor(e,t,n,r,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=r,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let r=[],s=Object.create(null),o=new Map;for(let m of Yy(e,t,o))m instanceof le?r.push(m):(s[m.facet.id]||(s[m.facet.id]=[])).push(m);let l=Object.create(null),a=[],h=[];for(let m of r)l[m.id]=h.length<<1,h.push(g=>m.slot(g));let c=n?.config.facets;for(let m in s){let g=s[m],y=g[0].facet,P=c&&c[m]||[];if(g.every(x=>x.type==0))if(l[y.id]=a.length<<1|1,wa(P,g))a.push(n.facet(y));else{let x=y.combine(g.map(k=>k.value));a.push(n&&y.compare(x,n.facet(y))?n.facet(y):x)}else{for(let x of g)x.type==0?(l[x.id]=a.length<<1|1,a.push(x.value)):(l[x.id]=h.length<<1,h.push(k=>x.dynamicSlot(k)));l[y.id]=h.length<<1,h.push(x=>Vy(x,y,g))}}let u=h.map(m=>m(l));return new ci(e,o,u,l,a,s)}};function Yy(i,e,t){let n=[[],[],[],[],[]],r=new Map;function s(o,l){let a=r.get(o);if(a!=null){if(a<=l)return;let h=n[a].indexOf(o);h>-1&&n[a].splice(h,1),o instanceof rr&&t.delete(o.compartment)}if(r.set(o,l),Array.isArray(o))for(let h of o)s(h,l);else if(o instanceof rr){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,l)}else if(o instanceof _s)s(o.inner,o.prec);else if(o instanceof le)n[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof ai)n[l].push(o),o.facet.extensions&&s(o.facet.extensions,Rn.default);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,l)}}return s(i,Rn.default),n.reduce((o,l)=>o.concat(l))}function ir(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let r=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|r}function $s(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}var _u=M.define(),$u=M.define({combine:i=>i.some(e=>e),static:!0}),Tu=M.define({combine:i=>i.length?i[0]:void 0,static:!0}),ku=M.define(),Iu=M.define(),Au=M.define(),Cu=M.define({combine:i=>i.length?i[0]:!1}),Ke=class{constructor(e,t){this.type=e,this.value=t}static define(){return new pa}},pa=class{of(e){return new Ke(this,e)}},ma=class{constructor(e){this.map=e}of(e){return new V(this,e)}},V=class{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new V(this.type,t)}is(e){return this.type==e}static define(e={}){return new ma(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let r of e){let s=r.map(t);s&&n.push(s)}return n}};V.reconfigure=V.define();V.appendConfig=V.define();var pe=class{constructor(e,t,n,r,s,o){this.startState=e,this.changes=t,this.selection=n,this.effects=r,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,n&&vu(n,t.newLength),s.some(l=>l.type==pe.time)||(this.annotations=s.concat(pe.time.of(Date.now())))}static create(e,t,n,r,s,o){return new pe(e,t,n,r,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(pe.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}};pe.time=Ke.define();pe.userEvent=Ke.define();pe.addToHistory=Ke.define();pe.remote=Ke.define();function Ny(i,e){let t=[];for(let n=0,r=0;;){let s,o;if(n<i.length&&(r==e.length||e[r]>=i[n]))s=i[n++],o=i[n++];else if(r<e.length)s=e[r++],o=e[r++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Eu(i,e,t){var n;let r,s,o;return t?(r=e.changes,s=de.empty(e.changes.length),o=i.changes.compose(e.changes)):(r=e.changes.map(i.changes),s=i.changes.mapDesc(e.changes,!0),o=i.changes.compose(r)),{changes:o,selection:e.selection?e.selection.map(s):(n=i.selection)===null||n===void 0?void 0:n.map(r),effects:V.mapEffects(i.effects,r).concat(V.mapEffects(e.effects,s)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function ga(i,e,t){let n=e.selection,r=hi(e.annotations);return e.userEvent&&(r=r.concat(pe.userEvent.of(e.userEvent))),{changes:e.changes instanceof de?e.changes:de.of(e.changes||[],t,i.facet(Tu)),selection:n&&(n instanceof $?n:$.single(n.anchor,n.head)),effects:hi(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function Wu(i,e,t){let n=ga(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;n=Eu(n,ga(i,e[s],o?n.changes.newLength:i.doc.length),o)}let r=pe.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Fy(t?Uy(r):r)}function Uy(i){let e=i.startState,t=!0;for(let r of e.facet(ku)){let s=r(i);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Ny(t,s))}if(t!==!0){let r,s;if(t===!1)s=i.changes.invertedDesc,r=de.empty(e.doc.length);else{let o=i.changes.filter(t);r=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}i=pe.create(e,r,i.selection&&i.selection.map(s),V.mapEffects(i.effects,s),i.annotations,i.scrollIntoView)}let n=e.facet(Iu);for(let r=n.length-1;r>=0;r--){let s=n[r](i);s instanceof pe?i=s:Array.isArray(s)&&s.length==1&&s[0]instanceof pe?i=s[0]:i=Wu(e,hi(s),!1)}return i}function Fy(i){let e=i.startState,t=e.facet(Au),n=i;for(let r=t.length-1;r>=0;r--){let s=t[r](i);s&&Object.keys(s).length&&(n=Eu(n,ga(e,s,i.changes.newLength),!0))}return n==i?i:pe.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}var jy=[];function hi(i){return i==null?jy:Array.isArray(i)?i:[i]}var ie=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(ie||(ie={})),Xy=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Oa;try{Oa=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function zy(i){if(Oa)return Oa.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Xy.test(t)))return!0}return!1}function Hy(i){return e=>{if(!/\S/.test(e))return ie.Space;if(zy(e))return ie.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return ie.Word;return ie.Other}}var j=class{constructor(e,t,n,r,s,o){this.config=e,this.doc=t,this.selection=n,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)ir(this,l<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return ir(this,n),$s(this,n)}update(...e){return Wu(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:r}=t;for(let o of e.effects)o.is(an.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,a)=>r.set(a,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(V.reconfigure)?(t=null,n=o.value):o.is(V.appendConfig)&&(t=null,n=hi(n).concat(o.value));let s;t?s=e.startState.values.slice():(t=ci.resolve(n,r,this),s=new j(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,a)=>a.reconfigure(l,this),null).values),new j(t,e.newDoc,e.newSelection,s,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:$.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),s=[n.range],o=hi(n.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),h=this.changes(a.changes),c=h.map(r);for(let m=0;m<l;m++)s[m]=s[m].map(c);let u=r.mapDesc(h,!0);s.push(a.range.map(u)),r=r.compose(c),o=V.mapEffects(o,c).concat(V.mapEffects(hi(a.effects),u))}return{changes:r,selection:$.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof de?e:de.of(e,this.doc.length,this.facet(j.lineSeparator))}toText(e){return X.of(e.split(this.facet(j.lineSeparator)||ca))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(ir(this,t),$s(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let r=e[n];r instanceof le&&this.config.address[r.id]!=null&&(t[n]=r.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let o=n[s],l=e[s];r.push(o.init(a=>o.spec.fromJSON(l,a)))}}return j.create({doc:e.doc,selection:$.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=ci.resolve(e.extensions||[],new Map),n=e.doc instanceof X?e.doc:X.of((e.doc||"").split(t.staticFacet(j.lineSeparator)||ca)),r=e.selection?e.selection instanceof $?e.selection:$.single(e.selection.anchor,e.selection.head):$.single(0);return vu(r,n.length),t.staticFacet($u)||(r=r.asSingle()),new j(t,n,r,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(j.tabSize)}get lineBreak(){return this.facet(j.lineSeparator)||`
`}get readOnly(){return this.facet(Cu)}phrase(e,...t){for(let n of this.facet(j.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,r)=>{if(r=="$")return"$";let s=+(r||1);return!s||s>t.length?n:t[s-1]})),e}languageDataAt(e,t,n=-1){let r=[];for(let s of this.facet(_u))for(let o of s(this,t,n))Object.prototype.hasOwnProperty.call(o,e)&&r.push(o[e]);return r}charCategorizer(e){return Hy(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:r}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-n,l=e-n;for(;o>0;){let a=Qe(t,o,!1);if(s(t.slice(a,o))!=ie.Word)break;o=a}for(;l<r;){let a=Qe(t,l);if(s(t.slice(l,a))!=ie.Word)break;l=a}return o==l?null:$.range(o+n,l+n)}};j.allowMultipleSelections=$u;j.tabSize=M.define({combine:i=>i.length?i[0]:4});j.lineSeparator=Tu;j.readOnly=Cu;j.phrases=M.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(r=>i[r]==e[r])}});j.languageData=_u;j.changeFilter=ku;j.transactionFilter=Iu;j.transactionExtender=Au;an.reconfigure=V.define();function Ve(i,e,t={}){let n={};for(let r of i)for(let s of Object.keys(r)){let o=r[s],l=n[s];if(l===void 0)n[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))n[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let r in e)n[r]===void 0&&(n[r]=e[r]);return n}var vt=class{eq(e){return this==e}range(e,t=e){return qn.create(e,t,this)}};vt.prototype.startSide=vt.prototype.endSide=0;vt.prototype.point=!1;vt.prototype.mapMode=ke.TrackDel;var qn=class{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new qn(e,t,n)}};function ya(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}var sr=class{constructor(e,t,n,r){this.from=e,this.to=t,this.value=n,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,r=0){let s=n?this.to:this.from;for(let o=r,l=s.length;;){if(o==l)return o;let a=o+l>>1,h=s[a]-e||(n?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return h>=0?o:l;h>=0?l=a:o=a+1}}between(e,t,n,r){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(n,1e9,!1,s);s<o;s++)if(r(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let n=[],r=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let h=this.value[a],c=this.from[a]+e,u=this.to[a]+e,m,g;if(c==u){let y=t.mapPos(c,h.startSide,h.mapMode);if(y==null||(m=g=y,h.startSide!=h.endSide&&(g=t.mapPos(c,h.endSide),g<m)))continue}else if(m=t.mapPos(c,h.startSide),g=t.mapPos(u,h.endSide),m>g||m==g&&h.startSide>0&&h.endSide<=0)continue;(g-m||h.endSide-h.startSide)<0||(o<0&&(o=m),h.point&&(l=Math.max(l,g-m)),n.push(h),r.push(m-o),s.push(g-o))}return{mapped:n.length?new sr(r,s,n,l):null,pos:o}}},H=class{constructor(e,t,n,r){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=r}static create(e,t,n,r){return new H(e,t,n,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:r=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(n&&(t=t.slice().sort(ya)),this.isEmpty)return t.length?H.of(t):this;let l=new Ts(this,null,-1).goto(0),a=0,h=[],c=new nt;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let u=t[a++];c.addInner(u.from,u.to,u.value)||h.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||r>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||r>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||h.push(qn.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?H.empty:this.nextLayer.update({add:h,filter:o,filterFrom:r,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],r=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],h=e.touchesRange(l,l+a.length);if(h===!1)r=Math.max(r,a.maxPoint),t.push(a),n.push(e.mapPos(l));else if(h===!0){let{mapped:c,pos:u}=a.map(l,e);c&&(r=Math.max(r,c.maxPoint),t.push(c),n.push(u))}}let s=this.nextLayer.map(e);return t.length==0?s:new H(n,t,s||H.empty,r)}between(e,t,n){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Bn.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Bn.from(e).goto(t)}static compare(e,t,n,r,s=-1){let o=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),l=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),a=Ou(o,l,n),h=new Mn(o,a,s),c=new Mn(l,a,s);n.iterGaps((u,m,g)=>yu(h,u,c,m,g,r)),n.empty&&n.length==0&&yu(h,0,c,0,0,r)}static eq(e,t,n=0,r){r==null&&(r=1e9-1);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Ou(s,o),a=new Mn(s,l,0).goto(n),h=new Mn(o,l,0).goto(n);for(;;){if(a.to!=h.to||!Sa(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>r)return!0;a.next(),h.next()}}static spans(e,t,n,r,s=-1){let o=new Mn(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let h=Math.min(o.to,n);if(o.point){let c=o.activeForPoint(o.to),u=o.pointFrom<t?c.length+1:Math.min(c.length,a);r.point(l,h,o.point,c,u,o.pointRank),a=Math.min(o.openEnd(h),c.length)}else h>l&&(r.span(l,h,o.active,a),a=o.openEnd(h));if(o.to>n)return a+(o.point&&o.to>n?1:0);l=o.to,o.next()}}static of(e,t=!1){let n=new nt;for(let r of e instanceof qn?[e]:t?Gy(e):e)n.add(r.from,r.to,r.value);return n.finish()}};H.empty=new H([],[],null,-1);function Gy(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(ya(e,n)>0)return i.slice().sort(ya);e=n}return i}H.empty.nextLayer=H.empty;var nt=class{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new sr(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new nt)).add(e,t,n)}addInner(e,t,n){let r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(H.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=H.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}};function Ou(i,e,t){let n=new Map;for(let s of i)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&n.set(s.chunk[o],s.chunkPos[o]);let r=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=n.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!t?.touchesRange(l,l+s.chunk[o].length)&&r.add(s.chunk[o])}return r}var Ts=class{constructor(e,t,n,r=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},Bn=class{constructor(e){this.heap=e}static from(e,t=null,n=-1){let r=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&r.push(new Ts(o,t,n,s));return r.length==1?r[0]:new Bn(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)aa(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)aa(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),aa(this.heap,0)}}};function aa(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let r=i[n];if(n+1<i.length&&r.compare(i[n+1])>=0&&(r=i[n+1],n++),t.compare(r)<0)break;i[n]=t,i[e]=r,e=n}}var Mn=class{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Bn.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){bs(this.active,e),bs(this.activeTo,e),bs(this.activeRank,e),this.minActive=Su(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:r,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;ws(this.active,t,n),ws(this.activeTo,t,r),ws(this.activeRank,t,s),e&&ws(e,t,this.cursor.from),this.minActive=Su(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),n&&bs(n,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let r=n.length-1;r>=0&&n[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}};function yu(i,e,t,n,r,s){i.goto(e),t.goto(n);let o=n+r,l=n,a=n-e;for(;;){let h=i.to+a-t.to||i.endSide-t.endSide,c=h<0?i.to+a:t.to,u=Math.min(c,o);if(i.point||t.point?i.point&&t.point&&(i.point==t.point||i.point.eq(t.point))&&Sa(i.activeForPoint(i.to+a),t.activeForPoint(t.to))||s.comparePoint(l,u,i.point,t.point):u>l&&!Sa(i.active,t.active)&&s.compareRange(l,u,i.active,t.active),c>o)break;l=c,h<=0&&i.next(),h>=0&&t.next()}}function Sa(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!i[t].eq(e[t]))return!1;return!0}function bs(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function ws(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function Su(i,e){let t=-1,n=1e9;for(let r=0;r<e.length;r++)(e[r]-n||i[r].endSide-i[t].endSide)<0&&(t=r,n=e[r]);return t}function hn(i,e,t=i.length){let n=0;for(let r=0;r<t;)i.charCodeAt(r)==9?(n+=e-n%e,r++):(n++,r=Qe(i,r));return n}function ks(i,e,t,n){for(let r=0,s=0;;){if(s>=e)return r;if(r==i.length)break;s+=i.charCodeAt(r)==9?t-s%t:1,r=Qe(i,r)}return n===!0?-1:i.length}var xa="\u037C",Qu=typeof Symbol>"u"?"__"+xa:Symbol.for(xa),Pa=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Ru=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},ut=class{constructor(e,t){this.rules=[];let{finish:n}=t||{};function r(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,h){let c=[],u=/^@(\w+)\b/.exec(o[0]),m=u&&u[1]=="keyframes";if(u&&l==null)return a.push(o[0]+";");for(let g in l){let y=l[g];if(/&/.test(g))s(g.split(/,\s*/).map(P=>o.map(x=>P.replace(/&/,x))).reduce((P,x)=>P.concat(x)),y,a);else if(y&&typeof y=="object"){if(!u)throw new RangeError("The value of a property ("+g+") should be a primitive value.");s(r(g),y,c,m)}else y!=null&&c.push(g.replace(/_.*/,"").replace(/[A-Z]/g,P=>"-"+P.toLowerCase())+": "+y+";")}(c.length||m)&&a.push((n&&!u&&!h?o.map(n):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(r(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Ru[Qu]||1;return Ru[Qu]=e+1,xa+e.toString(36)}static mount(e,t){(e[Pa]||new va(e)).mount(Array.isArray(t)?t:[t])}},Is=null,va=class{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(Is)return e.adoptedStyleSheets=[Is.sheet,...e.adoptedStyleSheets],e[Pa]=Is;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],Is=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[Pa]=this}mount(e){let t=this.sheet,n=0,r=0;for(let s=0;s<e.length;s++){let o=e[s],l=this.modules.indexOf(o);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,o),t)for(let a=0;a<o.rules.length;a++)t.insertRule(o.rules[a],n++)}else{for(;r<l;)n+=this.modules[r++].rules.length;n+=o.rules.length,r++}}if(!t){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}};var zt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},fi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Mu=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),n_=typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent),Jy=typeof navigator<"u"&&/Mac/.test(navigator.platform),Ky=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),eS=Jy||Mu&&+Mu[1]<57;for($e=0;$e<10;$e++)zt[48+$e]=zt[96+$e]=String($e);var $e;for($e=1;$e<=24;$e++)zt[$e+111]="F"+$e;var $e;for($e=65;$e<=90;$e++)zt[$e]=String.fromCharCode($e+32),fi[$e]=String.fromCharCode($e);var $e;for(As in zt)fi.hasOwnProperty(As)||(fi[As]=zt[As]);var As;function Du(i){var e=eS&&(i.ctrlKey||i.altKey||i.metaKey)||Ky&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?fi:zt)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Ys(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function Oi(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function tS(i){let e=i.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Ls(i,e){if(!e.anchorNode)return!1;try{return Oi(i,e.anchorNode)}catch{return!1}}function mr(i){return i.nodeType==3?yi(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function Ns(i,e,t,n){return t?Lu(i,e,t,n,-1)||Lu(i,e,t,n,1):!1}function Us(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function Lu(i,e,t,n,r){for(;;){if(i==t&&e==n)return!0;if(e==(r<0?0:gr(i))){if(i.nodeName=="DIV")return!1;let s=i.parentNode;if(!s||s.nodeType!=1)return!1;e=Us(i)+(r<0?0:1),i=s}else if(i.nodeType==1){if(i=i.childNodes[e+(r<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=r<0?gr(i):0}else return!1}}function gr(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}var vd={left:0,right:0,top:0,bottom:0};function Oh(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function nS(i){return{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function iS(i,e,t,n,r,s,o,l){let a=i.ownerDocument,h=a.defaultView||window;for(let c=i;c;)if(c.nodeType==1){let u,m=c==a.body;if(m)u=nS(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let P=c.getBoundingClientRect();u={left:P.left,right:P.left+c.clientWidth,top:P.top,bottom:P.top+c.clientHeight}}let g=0,y=0;if(r=="nearest")e.top<u.top?(y=-(u.top-e.top+o),t>0&&e.bottom>u.bottom+y&&(y=e.bottom-u.bottom+y+o)):e.bottom>u.bottom&&(y=e.bottom-u.bottom+o,t<0&&e.top-y<u.top&&(y=-(u.top+y-e.top+o)));else{let P=e.bottom-e.top,x=u.bottom-u.top;y=(r=="center"&&P<=x?e.top+P/2-x/2:r=="start"||r=="center"&&t<0?e.top-o:e.bottom-x+o)-u.top}if(n=="nearest"?e.left<u.left?(g=-(u.left-e.left+s),t>0&&e.right>u.right+g&&(g=e.right-u.right+g+s)):e.right>u.right&&(g=e.right-u.right+s,t<0&&e.left<u.left+g&&(g=-(u.left+g-e.left+s))):g=(n=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:n=="start"==l?e.left-s:e.right-(u.right-u.left)+s)-u.left,g||y)if(m)h.scrollBy(g,y);else{let P=0,x=0;if(y){let k=c.scrollTop;c.scrollTop+=y,x=c.scrollTop-k}if(g){let k=c.scrollLeft;c.scrollLeft+=g,P=c.scrollLeft-k}e={left:e.left-P,top:e.top-x,right:e.right-P,bottom:e.bottom-x},P&&Math.abs(P-g)<1&&(n="nearest"),x&&Math.abs(x-y)<1&&(r="nearest")}if(m)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function rS(i){let e=i.ownerDocument;for(let t=i.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}var Ea=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}},ui=null;function _d(i){if(i.setActive)return i.setActive();if(ui)return i.focus(ui);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(ui==null?{get preventScroll(){return ui={preventScroll:!0},!0}}:void 0),!ui){ui=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],s=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=s&&(n.scrollLeft=s)}}}var qu;function yi(i,e,t=e){let n=qu||(qu=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function gi(i,e,t){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,i.dispatchEvent(r);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,i.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function sS(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function $d(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function oS(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(;;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=gr(t))}else{if(t==i)return!0;n=Us(t),t=t.parentNode}}var Ae=class{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Ae(e.parentNode,Us(e),t)}static after(e,t){return new Ae(e.parentNode,Us(e)+1,t)}},yh=[],oe=class{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e,t){if(this.dirty&2){let n=this.dom,r=null,s;for(let o of this.children){if(o.dirty){if(!o.dom&&(s=r?r.nextSibling:n.firstChild)){let l=oe.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.dirty=0}if(s=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&s!=o.dom&&(t.written=!0),o.dom.parentNode==n)for(;s&&s!=o.dom;)s=Bu(s);else n.insertBefore(o.dom,s);r=o.dom}for(s=r?r.nextSibling:n.firstChild,s&&t&&t.node==n&&(t.written=!0);s;)s=Bu(s)}else if(this.dirty&1)for(let n of this.children)n.dirty&&(n.sync(e,t),n.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=gr(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;r==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?r=-1:r=1),e=s}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!oe.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,s=0;;r++){let o=this.children[r];if(o.dom==n)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,s=-1,o=-1,l=-1;for(let a=0,h=n,c=n;a<this.children.length;a++){let u=this.children[a],m=h+u.length;if(h<e&&m>t)return u.domBoundsAround(e,t,h);if(m>=e&&r==-1&&(r=a,s=h),h>t&&u.dom.parentNode==this.dom){o=a,l=c;break}c=m,h=m+u.breakAfter}return{from:s,to:l<0?n+this.length:l,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=yh){this.markDirty();for(let r=e;r<t;r++){let s=this.children[r];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Fs(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}merge(e,t,n,r,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}};oe.prototype.breakAfter=0;function Bu(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}var Fs=class{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function Td(i,e,t,n,r,s,o,l,a){let{children:h}=i,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,m=u?u.breakAfter:o;if(!(e==n&&c&&!o&&!m&&s.length<2&&c.merge(t,r,s.length?u:null,t==0,l,a))){if(n<h.length){let g=h[n];g&&r<g.length?(e==n&&(g=g.split(r),r=0),!m&&u&&g.merge(0,r,u,!0,0,a)?s[s.length-1]=g:(r&&g.merge(0,r,null,!1,0,a),s.push(g))):g?.breakAfter&&(u?u.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,l,0),e++));e<n&&s.length;)if(h[n-1].become(s[s.length-1]))n--,s.pop(),a=s.length?0:l;else if(h[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||s.length)&&i.replaceChildren(e,n,s)}}function kd(i,e,t,n,r,s){let o=i.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:h,off:c}=o.findPos(e,-1),u=e-t;for(let m of n)u+=m.length;i.length+=u,Td(i,h,c,l,a,n,0,r,s)}var it=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Wa=typeof document<"u"?document:{documentElement:{style:{}}},Qa=/Edge\/(\d+)/.exec(it.userAgent),Id=/MSIE \d/.test(it.userAgent),Ra=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(it.userAgent),so=!!(Id||Ra||Qa),Zu=!so&&/gecko\/(\d+)/i.test(it.userAgent),_a=!so&&/Chrome\/(\d+)/.exec(it.userAgent),Vu="webkitFontSmoothing"in Wa.documentElement.style,Ad=!so&&/Apple Computer/.test(it.vendor),Yu=Ad&&(/Mobile\/\w+/.test(it.userAgent)||it.maxTouchPoints>2),L={mac:Yu||/Mac/.test(it.platform),windows:/Win/.test(it.platform),linux:/Linux|X11/.test(it.platform),ie:so,ie_version:Id?Wa.documentMode||6:Ra?+Ra[1]:Qa?+Qa[1]:0,gecko:Zu,gecko_version:Zu?+(/Firefox\/(\d+)/.exec(it.userAgent)||[0,0])[1]:0,chrome:!!_a,chrome_version:_a?+_a[1]:0,ios:Yu,android:/Android\b/.test(it.userAgent),webkit:Vu,safari:Ad,webkit_version:Vu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Wa.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"},lS=256,Dt=class extends oe{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return n&&(!(n instanceof Dt)||this.length-(t-e)+n.length>lS)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Dt(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Ae(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Ma(this.dom,e,t)}},pt=class extends oe{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if($d(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,t){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,s,o){return n&&(!(n instanceof pt&&n.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(kd(this,e,t,n?n.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,s=0;for(let l of this.children){let a=n+l.length;a>e&&t.push(n<e?l.split(e-n):l),r<0&&n>=e&&(r=s),n=a,s++}let o=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new pt(this.mark,t,o)}domAtPos(e){return Ed(this,e)}coordsAt(e,t){return Qd(this,e,t)}};function Ma(i,e,t){let n=i.nodeValue.length;e>n&&(e=n);let r=e,s=e,o=0;e==0&&t<0||e==n&&t>=0?L.chrome||L.gecko||(e?(r--,o=1):s<n&&(s++,o=-1)):t<0?r--:s<n&&s++;let l=yi(i,r,s).getClientRects();if(!l.length)return vd;let a=l[(o?o<0:t>=0)?0:l.length-1];return L.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,h=>h.width)||a),o?Oh(a,o<0):a||null}var Mt=class extends oe{constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}static create(e,t,n){return new(e.customView||Mt)(e,t,n)}split(e){let t=Mt.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,r,s,o){return n&&(!(n instanceof Mt)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Mt&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return X.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):X.empty}domAtPos(e){return e==0?Ae.before(this.dom):Ae.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.dom.getClientRects(),r=null;if(!n.length)return vd;for(let s=e>0?n.length-1:0;r=n[s],!(e>0?s==0:s==n.length-1||r.top<r.bottom);s+=e>0?-1:1);return this.length?r:Oh(r,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},js=class extends Mt{domAtPos(e){let{topView:t,text:n}=this.widget;return t?Da(e,0,t,n,(r,s)=>r.domAtPos(s),r=>new Ae(n,Math.min(r,n.nodeValue.length))):new Ae(n,Math.min(e,n.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:n,text:r}=this.widget;return n?Cd(e,t,n,r):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:n,text:r}=this.widget;return n?Da(e,t,n,r,(s,o,l)=>s.coordsAt(o,l),(s,o)=>Ma(r,s,o)):Ma(r,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}};function Da(i,e,t,n,r,s){if(t instanceof pt){for(let o=t.dom.firstChild;o;o=o.nextSibling){let l=oe.get(o);if(!l)return s(i,e);let a=Oi(o,n),h=l.length+(a?n.nodeValue.length:0);if(i<h||i==h&&l.getSide()<=0)return a?Da(i,e,l,n,r,s):r(l,i,e);i-=h}return r(t,t.length,-1)}else return t.dom==n?s(i,e):r(t,i,e)}function Cd(i,e,t,n){if(t instanceof pt){let r=0;for(let s of t.children){let o=Oi(s.dom,n);if(Oi(s.dom,i))return r+(o?Cd(i,e,s,n):s.localPosFromDOM(i,e));r+=o?n.nodeValue.length:s.length}}else if(t.dom==n)return Math.min(e,n.nodeValue.length);return t.localPosFromDOM(i,e)}var dn=class extends oe{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof dn&&e.side==this.side}split(){return new dn(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Ae.before(this.dom):Ae.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),n=aS(this,this.side>0?-1:1);return n&&n.top<t.bottom&&n.bottom>t.top?{left:t.left,right:t.right,top:n.top,bottom:n.bottom}:t}get overrideDOMText(){return X.empty}};Dt.prototype.children=Mt.prototype.children=dn.prototype.children=yh;function aS(i,e){let t=i.parent,n=t?t.children.indexOf(i):-1;for(;t&&n>=0;)if(e<0?n>0:n<t.children.length){let r=t.children[n+e];if(r instanceof Dt){let s=r.coordsAt(e<0?r.length:0,e);if(s)return s}n+=e}else if(t instanceof pt&&t.parent)n=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let r=t.dom.lastChild;if(r&&r.nodeName=="BR")return r.getClientRects()[0];break}}function Ed(i,e){let t=i.dom,{children:n}=i,r=0;for(let s=0;r<n.length;r++){let o=n[r],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=r;s>0;s--){let o=n[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=r;s<n.length;s++){let o=n[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Ae(t,0)}function Wd(i,e,t){let n,{children:r}=i;t>0&&e instanceof pt&&r.length&&(n=r[r.length-1])instanceof pt&&n.mark.eq(e.mark)?Wd(n,e.children[0],t-1):(r.push(e),e.setParent(i)),i.length+=e.length}function Qd(i,e,t){let n=null,r=-1,s=null,o=-1;function l(h,c){for(let u=0,m=0;u<h.children.length&&m<=c;u++){let g=h.children[u],y=m+g.length;y>=c&&(g.children.length?l(g,c-m):!s&&(y>c||m==y&&g.getSide()>0)?(s=g,o=c-m):(m<c||m==y&&g.getSide()<0)&&(n=g,r=c-m)),m=y}}l(i,e);let a=(t<0?n:s)||n||s;return a?a.coordsAt(Math.max(0,a==n?r:o),t):hS(i)}function hS(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=mr(e);return t[t.length-1]||null}function La(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}function Sh(i,e){if(i==e)return!0;if(!i||!e)return!1;let t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r of t)if(n.indexOf(r)==-1||i[r]!==e[r])return!1;return!0}function qa(i,e,t){let n=null;if(e)for(let r in e)t&&r in t||i.removeAttribute(n=r);if(t)for(let r in t)e&&e[r]==t[r]||i.setAttribute(n=r,t[r]);return!!n}var et=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}},se=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(se||(se={})),q=class extends vt{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Si(e)}static widget(e){let t=e.side||0,n=!!e.block;return t+=n?t>0?3e8:-4e8:t>0?1e8:-1e8,new Gt(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:s,end:o}=Rd(e,t);n=(s?t?-3e8:-1:5e8)-1,r=(o?t?2e8:1:-6e8)+1}return new Gt(e,n,r,t,e.widget||null,!0)}static line(e){return new Zn(e)}static set(e,t=!1){return H.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};q.none=H.empty;var Si=class extends q{constructor(e){let{start:t,end:n}=Rd(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Si&&this.tagName==e.tagName&&this.class==e.class&&Sh(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}};Si.prototype.point=!1;var Zn=class extends q{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Zn&&this.spec.class==e.spec.class&&Sh(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}};Zn.prototype.mapMode=ke.TrackBefore;Zn.prototype.point=!0;var Gt=class extends q{constructor(e,t,n,r,s,o){super(t,n,s,e),this.block=r,this.isReplace=o,this.mapMode=r?t<=0?ke.TrackBefore:ke.TrackAfter:ke.TrackDel}get type(){return this.startSide<this.endSide?se.WidgetRange:this.startSide<=0?se.WidgetBefore:se.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Gt&&cS(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}};Gt.prototype.point=!0;function Rd(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function cS(i,e){return i==e||!!(i&&e&&i.compare(e))}function Ba(i,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=i?t[r]=Math.max(t[r],e):t.push(i,e)}var De=class extends oe{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,s,o){if(n){if(!(n instanceof De))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),kd(this,e,t,n?n.children:[],s,o),!0}split(e){let t=new De;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)t.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Sh(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Wd(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=La(t,this.attrs||{})),n&&(this.attrs=La({class:n},this.attrs||{}))}domAtPos(e){return Ed(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,t){var n;this.dom?this.dirty&4&&($d(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(qa(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&oe.get(r)instanceof pt;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=oe.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!L.ios||!this.children.some(s=>s instanceof Dt))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof Dt)||/[^ -~]/.test(n.text))return null;let r=mr(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=Qd(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-r.lineHeight)<2&&r.textHeight<s){let o=(s-r.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return!1}get type(){return se.Text}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let s=e.children[n],o=r+s.length;if(o>=t){if(s instanceof De)return s;if(o>t)break}r=o+s.breakAfter}return null}},Ht=class extends oe{constructor(e,t,n){super(),this.widget=e,this.length=t,this.type=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,s,o){return n&&(!(n instanceof Ht)||!this.widget.compare(n.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Ae.before(this.dom):Ae.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Ht(this.widget,t,this.type);return n.breakAfter=this.breakAfter,n}get children(){return yh}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):X.empty}domBoundsAround(){return null}become(e){return e instanceof Ht&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Or=class{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Ht&&e.type==se.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new De),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Cs(new dn(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Cs(new Dt(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,s,o){if(this.disallowBlockEffectsFor[o]&&n instanceof Gt){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(n instanceof Gt)if(n.block){let{type:a}=n;a==se.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ht(n.widget||new Xs("div"),l,a))}else{let a=Mt.create(n.widget||new Xs("span"),l,l?0:n.startSide),h=this.atCursorPos&&!a.isEditable&&s<=r.length&&(e<t||n.startSide>0),c=!a.isEditable&&(e<t||s>r.length||n.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!h&&(this.pendingBuffer=0),this.flushBuffer(r),h&&(u.append(Cs(new dn(1),r),s),s=r.length+Math.max(0,s-r.length)),u.append(Cs(a,r),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,n,r,s){let o=new Or(e,t,n,s);return o.openEnd=H.spans(r,t,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}};function Cs(i,e){for(let t of e)i=new pt(t,[i],i.length);return i}var Xs=class extends et{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}},Md=M.define(),Dd=M.define(),Ld=M.define(),qd=M.define(),Za=M.define(),Bd=M.define(),Zd=M.define(),Vd=M.define({combine:i=>i.some(e=>e)}),Yd=M.define({combine:i=>i.some(e=>e)}),bi=class{constructor(e,t="nearest",n="nearest",r=5,s=5){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=s}map(e){return e.empty?this:new bi(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}},Nu=V.define({map:(i,e)=>i.map(e)});function Ye(i,e,t){let n=i.facet(qd);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}var oo=M.define({combine:i=>i.length?i[0]:!0}),fS=0,lr=M.define(),ae=class{constructor(e,t,n,r){this.id=e,this.create=t,this.domEventHandlers=n,this.extension=r(this)}static define(e,t){let{eventHandlers:n,provide:r,decorations:s}=t||{};return new ae(fS++,e,n,o=>{let l=[lr.of(o)];return s&&l.push(yr.of(a=>{let h=a.plugin(o);return h?s(h):q.none})),r&&l.push(r(o)),l})}static fromClass(e,t){return ae.define(n=>new e(n),t)}},fr=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Ye(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Ye(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){Ye(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},Nd=M.define(),bh=M.define(),yr=M.define(),Ud=M.define(),Fd=M.define(),ar=M.define(),dt=class{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new dt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,s=0,o=0,l=0;;r++){let a=r==e.length?null:e[r],h=o-l,c=a?a.fromB:1e9;for(;s<t.length&&t[s]<c;){let u=t[s],m=t[s+1],g=Math.max(l,u),y=Math.min(c,m);if(g<=y&&new dt(g+h,y+h,g,y).addToSet(n),m>c)break;s+=2}if(!a)return n;new dt(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),o=a.toA,l=a.toB}}},wi=class{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=de.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let r=[];this.changes.iterChangedRanges((s,o,l,a)=>r.push(new dt(s,o,l,a))),this.changedRanges=r}static create(e,t,n){return new wi(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}},ce=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(ce||(ce={})),Va=ce.LTR,uS=ce.RTL;function jd(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}var dS=jd("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),pS=jd("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ya=Object.create(null),Rt=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);Ya[e]=t,Ya[t]=-e}function mS(i){return i<=247?dS[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?pS[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8203?256:64336<=i&&i<=65023?4:i==8204?256:1}var gS=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,un=class{constructor(e,t,n){this.from=e,this.to=t,this.level=n}get dir(){return this.level%2?uS:Va}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,r){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==n)return o;(s<0||(r!=0?r<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}},me=[];function OS(i,e){let t=i.length,n=e==Va?1:2,r=e==Va?2:1;if(!i||n==1&&!gS.test(i))return Xd(t);for(let o=0,l=n,a=n;o<t;o++){let h=mS(i.charCodeAt(o));h==512?h=l:h==8&&a==4&&(h=16),me[o]=h==4?2:h,h&7&&(a=h),l=h}for(let o=0,l=n,a=n;o<t;o++){let h=me[o];if(h==128)o<t-1&&l==me[o+1]&&l&24?h=me[o]=l:me[o]=256;else if(h==64){let c=o+1;for(;c<t&&me[c]==64;)c++;let u=o&&l==8||c<t&&me[c]==8?a==1?1:8:256;for(let m=o;m<c;m++)me[m]=u;o=c-1}else h==8&&a==1&&(me[o]=1);l=h,h&7&&(a=h)}for(let o=0,l=0,a=0,h,c,u;o<t;o++)if(c=Ya[h=i.charCodeAt(o)])if(c<0){for(let m=l-3;m>=0;m-=3)if(Rt[m+1]==-c){let g=Rt[m+2],y=g&2?n:g&4?g&1?r:n:0;y&&(me[o]=me[Rt[m]]=y),l=m;break}}else{if(Rt.length==189)break;Rt[l++]=o,Rt[l++]=h,Rt[l++]=a}else if((u=me[o])==2||u==1){let m=u==n;a=m?0:1;for(let g=l-3;g>=0;g-=3){let y=Rt[g+2];if(y&2)break;if(m)Rt[g+2]|=2;else{if(y&4)break;Rt[g+2]|=4}}}for(let o=0;o<t;o++)if(me[o]==256){let l=o+1;for(;l<t&&me[l]==256;)l++;let a=(o?me[o-1]:n)==1,h=(l<t?me[l]:n)==1,c=a==h?a?1:2:n;for(let u=o;u<l;u++)me[u]=c;o=l-1}let s=[];if(n==1)for(let o=0;o<t;){let l=o,a=me[o++]!=1;for(;o<t&&a==(me[o]!=1);)o++;if(a)for(let h=o;h>l;){let c=h,u=me[--h]!=2;for(;h>l&&u==(me[h-1]!=2);)h--;s.push(new un(h,c,u?2:1))}else s.push(new un(l,o,0))}else for(let o=0;o<t;){let l=o,a=me[o++]==2;for(;o<t&&a==(me[o]==2);)o++;s.push(new un(l,o,a?1:2))}return s}function Xd(i){return[new un(0,i,0)]}var zd="";function yS(i,e,t,n,r){var s;let o=n.head-i.from,l=-1;if(o==0){if(!r||!i.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),l=0)}else if(o==i.length){if(r)return null;let m=e[e.length-1];m.level!=t&&(o=m.side(!0,t),l=e.length-1)}l<0&&(l=un.find(e,o,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc));let a=e[l];o==a.side(r,t)&&(a=e[l+=r?1:-1],o=a.side(!r,t));let h=r==(a.dir==t),c=Qe(i.text,o,h);if(zd=i.text.slice(Math.min(o,c),Math.max(o,c)),c!=a.side(r,t))return $.cursor(c+i.from,h?-1:1,a.level);let u=l==(r?e.length-1:0)?null:e[l+(r?1:-1)];return!u&&a.level!=t?$.cursor(r?i.to:i.from,r?-1:1,t):u&&u.level<a.level?$.cursor(u.side(!r,t)+i.from,r?1:-1,u.level):$.cursor(c+i.from,r?-1:1,a.level)}var fn="\uFFFF",zs=class{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(j.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=fn}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r),this.readNode(r);let s=r.nextSibling;if(s==t)break;let o=oe.get(r),l=oe.get(s);(o&&l?o.breakAfter:(o?o.breakAfter:Uu(r))||Uu(s)&&(r.nodeName!="BR"||r.cmIgnore))&&this.lineBreak(),r=s}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(l=r.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=oe.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+Math.min(t,n.offset))}};function Uu(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}var Hs=class{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}},Gs=class extends oe{constructor(e){super(),this.view=e,this.compositionDeco=q.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new De],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new dt(0,0,0,e.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:l})=>l<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=q.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=bS(this.view,e.changes)),(L.ie||L.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let n=this.decorations,r=this.updateDeco(),s=xS(n,r,e.changes);return t=dt.extendWithRanges(t,s),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=L.chrome||L.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,s),this.dirty=0,s&&(s.written||n.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof Ht&&s.widget instanceof Js&&r.push(s.dom);n.updateGaps(r)}updateChildren(e,t){let n=this.childCursor(t);for(let r=e.length-1;;r--){let s=r>=0?e[r]:null;if(!s)break;let{fromA:o,toA:l,fromB:a,toB:h}=s,{content:c,breakAtStart:u,openStart:m,openEnd:g}=Or.build(this.view.state.doc,a,h,this.decorations,this.dynamicDecorationMap),{i:y,off:P}=n.findPos(l,1),{i:x,off:k}=n.findPos(o,-1);Td(this,x,k,y,P,c,u,m,g)}}updateSelection(e=!1,t=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection()))return;let n=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,s=this.domAtPos(r.anchor),o=r.empty?s:this.domAtPos(r.head);if(L.gecko&&r.empty&&SS(s)){let a=document.createTextNode("");this.view.observer.ignore(()=>s.node.insertBefore(a,s.node.childNodes[s.offset]||null)),s=o=new Ae(a,0),n=!0}let l=this.view.observer.selectionRange;(n||!l.focusNode||!Ns(s.node,s.offset,l.anchorNode,l.anchorOffset)||!Ns(o.node,o.offset,l.focusNode,l.focusOffset))&&(this.view.observer.ignore(()=>{L.android&&L.chrome&&this.dom.contains(l.focusNode)&&PS(l.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let a=Ys(this.view.root);if(a)if(r.empty){if(L.gecko){let h=wS(s.node,s.offset);if(h&&h!=3){let c=Gd(s.node,s.offset,h==1?1:-1);c&&(s=new Ae(c,h==1?0:c.nodeValue.length))}}a.collapse(s.node,s.offset),r.bidiLevel!=null&&l.cursorBidiLevel!=null&&(l.cursorBidiLevel=r.bidiLevel)}else if(a.extend){a.collapse(s.node,s.offset);try{a.extend(o.node,o.offset)}catch{}}else{let h=document.createRange();r.anchor>r.head&&([s,o]=[o,s]),h.setEnd(o.node,o.offset),h.setStart(s.node,s.offset),a.removeAllRanges(),a.addRange(h)}}),this.view.observer.setSelectionRange(s,o)),this.impreciseAnchor=s.precise?null:new Ae(l.anchorNode,l.anchorOffset),this.impreciseHead=o.precise?null:new Ae(l.focusNode,l.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,t=e.state.selection.main,n=Ys(e.root),{anchorNode:r,anchorOffset:s}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let o=De.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),h=this.coordsAt(t.head,1);if(!a||!h||a.bottom>h.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let u=e.observer.selectionRange;e.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=t.from&&n.collapse(r,s)}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||Ls(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let t=e;t;){let n=oe.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof De)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){for(let n=this.length,r=this.children.length-1;;r--){let s=this.children[r],o=n-s.breakAfter-s.length;if(e>o||e==o&&s.type!=se.WidgetBefore&&s.type!=se.WidgetAfter&&(!r||t==2||this.children[r-1].breakAfter||this.children[r-1].type==se.WidgetBefore&&t>-2))return s.coordsAt(e-o,t);n=o}}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==ce.LTR;for(let h=0,c=0;c<this.children.length;c++){let u=this.children[c],m=h+u.length;if(m>r)break;if(h>=n){let g=u.dom.getBoundingClientRect();if(t.push(g.height),o){let y=u.dom.lastChild,P=y?mr(y):[];if(P.length){let x=P[P.length-1],k=a?x.right-g.left:g.right-x.left;k>l&&(l=k,this.minWidth=s,this.minWidthFrom=h,this.minWidthTo=m)}}}h=m+u.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ce.RTL:ce.LTR}measureTextSize(){for(let s of this.children)if(s instanceof De){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=mr(e.firstChild)[0];t=e.getBoundingClientRect().height,n=s?s.width/27:7,r=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Fs(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let s=r==t.viewports.length?null:t.viewports[r],o=s?s.from-1:this.length;if(o>n){let l=t.lineBlockAt(o).bottom-t.lineBlockAt(n).top;e.push(q.replace({widget:new Js(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!s)break;n=s.to+1}return q.set(e)}updateDeco(){let e=this.view.state.facet(yr).map((t,n)=>(this.dynamicDecorationMap[n]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let s=0,o=0,l=0,a=0;for(let c of this.view.state.facet(Fd).map(u=>u(this.view)))if(c){let{left:u,right:m,top:g,bottom:y}=c;u!=null&&(s=Math.max(s,u)),m!=null&&(o=Math.max(o,m)),g!=null&&(l=Math.max(l,g)),y!=null&&(a=Math.max(a,y))}let h={left:n.left-s,top:n.top-l,right:n.right+o,bottom:n.bottom+a};iS(this.view.scrollDOM,h,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==ce.LTR)}};function SS(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}var Js=class extends et{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}};function Hd(i){let e=i.observer.selectionRange,t=e.focusNode&&Gd(e.focusNode,e.focusOffset,0);if(!t)return null;let n=i.docView.nearest(t);if(!n)return null;if(n instanceof De){let r=t;for(;r.parentNode!=n.dom;)r=r.parentNode;let s=r.previousSibling;for(;s&&!oe.get(s);)s=s.previousSibling;let o=s?oe.get(s).posAtEnd:n.posAtStart;return{from:o,to:o,node:r,text:t}}else{for(;;){let{parent:s}=n;if(!s)return null;if(s instanceof De)break;n=s}let r=n.posAtStart;return{from:r,to:r+n.length,node:n.dom,text:t}}}function bS(i,e){let t=Hd(i);if(!t)return q.none;let{from:n,to:r,node:s,text:o}=t,l=e.mapPos(n,1),a=Math.max(l,e.mapPos(r,-1)),{state:h}=i,c=s.nodeType==3?s.nodeValue:new zs([],h).readRange(s.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),fn)==c)a=l+c.length;else if(h.doc.sliceString(Math.max(0,a-c.length),a,fn)==c)l=a-c.length;else return q.none;else if(h.doc.sliceString(l,a,fn)!=c)return q.none;let u=oe.get(s);return u instanceof js?u=u.widget.topView:u&&(u.parent=null),q.set(q.replace({widget:new Na(s,o,u),inclusive:!0}).range(l,a))}var Na=class extends et{constructor(e,t,n){super(),this.top=e,this.text=t,this.topView=n}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return js}};function Gd(i,e,t){if(t<=0)for(let n=i,r=e;;){if(n.nodeType==3)return n;if(n.nodeType==1&&r>0)n=n.childNodes[r-1],r=gr(n);else break}if(t>=0)for(let n=i,r=e;;){if(n.nodeType==3)return n;if(n.nodeType==1&&r<n.childNodes.length&&t>=0)n=n.childNodes[r],r=0;else break}return null}function wS(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}var Ua=class{constructor(){this.changes=[]}compareRange(e,t){Ba(e,t,this.changes)}comparePoint(e,t){Ba(e,t,this.changes)}};function xS(i,e,t){let n=new Ua;return H.compare(i,e,t,n),n.changes}function PS(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function vS(i,e,t=1){let n=i.charCategorizer(e),r=i.doc.lineAt(e),s=e-r.from;if(r.length==0)return $.cursor(e);s==0?t=1:s==r.length&&(t=-1);let o=s,l=s;t<0?o=Qe(r.text,s,!1):l=Qe(r.text,s);let a=n(r.text.slice(o,l));for(;o>0;){let h=Qe(r.text,o,!1);if(n(r.text.slice(h,o))!=a)break;o=h}for(;l<r.length;){let h=Qe(r.text,l);if(n(r.text.slice(l,h))!=a)break;l=h}return $.range(o+r.from,l+r.from)}function _S(i,e){return e.left>i?e.left-i:Math.max(0,i-e.right)}function $S(i,e){return e.top>i?e.top-i:Math.max(0,i-e.bottom)}function $a(i,e){return i.top<e.bottom-1&&i.bottom>e.top+1}function Fu(i,e){return e<i.top?{top:e,left:i.left,right:i.right,bottom:i.bottom}:i}function ju(i,e){return e>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:e}:i}function Fa(i,e,t){let n,r,s,o,l=!1,a,h,c,u;for(let y=i.firstChild;y;y=y.nextSibling){let P=mr(y);for(let x=0;x<P.length;x++){let k=P[x];r&&$a(r,k)&&(k=Fu(ju(k,r.bottom),r.top));let Q=_S(e,k),D=$S(t,k);if(Q==0&&D==0)return y.nodeType==3?Xu(y,e,t):Fa(y,e,t);if(!n||o>D||o==D&&s>Q){n=y,r=k,s=Q,o=D;let I=D?t<k.top?-1:1:Q?e<k.left?-1:1:0;l=!I||(I>0?x<P.length-1:x>0)}Q==0?t>k.bottom&&(!c||c.bottom<k.bottom)?(a=y,c=k):t<k.top&&(!u||u.top>k.top)&&(h=y,u=k):c&&$a(c,k)?c=ju(c,k.bottom):u&&$a(u,k)&&(u=Fu(u,k.top))}}if(c&&c.bottom>=t?(n=a,r=c):u&&u.top<=t&&(n=h,r=u),!n)return{node:i,offset:0};let m=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return Xu(n,m,t);if(l&&n.contentEditable!="false")return Fa(n,m,t);let g=Array.prototype.indexOf.call(i.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:i,offset:g}}function Xu(i,e,t){let n=i.nodeValue.length,r=-1,s=1e9,o=0;for(let l=0;l<n;l++){let a=yi(i,l,l+1).getClientRects();for(let h=0;h<a.length;h++){let c=a[h];if(c.top==c.bottom)continue;o||(o=e-c.left);let u=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&u<s){let m=e>=(c.left+c.right)/2,g=m;if((L.chrome||L.gecko)&&yi(i,l).getBoundingClientRect().left==c.right&&(g=!m),u<=0)return{node:i,offset:l+(g?1:0)};r=l+(g?1:0),s=u}}}return{node:i,offset:r>-1?r:o>0?i.nodeValue.length:0}}function Jd(i,e,t,n=-1){var r,s;let o=i.contentDOM.getBoundingClientRect(),l=o.top+i.viewState.paddingTop,a,{docHeight:h}=i.viewState,{x:c,y:u}=e,m=u-l;if(m<0)return 0;if(m>h)return i.state.doc.length;for(let I=i.defaultLineHeight/2,E=!1;a=i.elementAtHeight(m),a.type!=se.Text;)for(;m=n>0?a.bottom+I:a.top-I,!(m>=0&&m<=h);){if(E)return t?null:0;E=!0,n=-n}u=l+m;let g=a.from;if(g<i.viewport.from)return i.viewport.from==0?0:t?null:zu(i,o,a,c,u);if(g>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:t?null:zu(i,o,a,c,u);let y=i.dom.ownerDocument,P=i.root.elementFromPoint?i.root:y,x=P.elementFromPoint(c,u);x&&!i.contentDOM.contains(x)&&(x=null),x||(c=Math.max(o.left+1,Math.min(o.right-1,c)),x=P.elementFromPoint(c,u),x&&!i.contentDOM.contains(x)&&(x=null));let k,Q=-1;if(x&&((r=i.docView.nearest(x))===null||r===void 0?void 0:r.isEditable)!=!1){if(y.caretPositionFromPoint){let I=y.caretPositionFromPoint(c,u);I&&({offsetNode:k,offset:Q}=I)}else if(y.caretRangeFromPoint){let I=y.caretRangeFromPoint(c,u);I&&({startContainer:k,startOffset:Q}=I,(!i.contentDOM.contains(k)||L.safari&&TS(k,Q,c)||L.chrome&&kS(k,Q,c))&&(k=void 0))}}if(!k||!i.docView.dom.contains(k)){let I=De.find(i.docView,g);if(!I)return m>a.top+a.height/2?a.to:a.from;({node:k,offset:Q}=Fa(I.dom,c,u))}let D=i.docView.nearest(k);if(!D)return null;if(D.isWidget&&((s=D.dom)===null||s===void 0?void 0:s.nodeType)==1){let I=D.dom.getBoundingClientRect();return e.y<I.top||e.y<=I.bottom&&e.x<=(I.left+I.right)/2?D.posAtStart:D.posAtEnd}else return D.localPosFromDOM(k,Q)+D.posAtStart}function zu(i,e,t,n,r){let s=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let l=Math.floor((r-t.top)/i.defaultLineHeight);s+=l*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(t.from,t.to);return t.from+ks(o,s,i.state.tabSize)}function TS(i,e,t){let n;if(i.nodeType!=3||e!=(n=i.nodeValue.length))return!1;for(let r=i.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return yi(i,n-1,n).getBoundingClientRect().left>t}function kS(i,e,t){if(e!=0)return!1;for(let r=i;;){let s=r.parentNode;if(!s||s.nodeType!=1||s.firstChild!=r)return!1;if(s.classList.contains("cm-line"))break;r=s}let n=i.nodeType==1?i.getBoundingClientRect():yi(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function IS(i,e,t,n){let r=i.state.doc.lineAt(e.head),s=!n||!i.lineWrapping?null:i.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(s){let a=i.dom.getBoundingClientRect(),h=i.textDirectionAt(r.from),c=i.posAtCoords({x:t==(h==ce.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(c!=null)return $.cursor(c,t?-1:1)}let o=De.find(i.docView,e.head),l=o?t?o.posAtEnd:o.posAtStart:t?r.to:r.from;return $.cursor(l,t?-1:1)}function Hu(i,e,t,n){let r=i.state.doc.lineAt(e.head),s=i.bidiSpans(r),o=i.textDirectionAt(r.from);for(let l=e,a=null;;){let h=yS(r,s,o,l,t),c=zd;if(!h){if(r.number==(t?i.state.doc.lines:1))return l;c=`
`,r=i.state.doc.line(r.number+(t?1:-1)),s=i.bidiSpans(r),h=$.cursor(t?r.from:r.to)}if(a){if(!a(c))return l}else{if(!n)return h;a=n(c)}l=h}}function AS(i,e,t){let n=i.state.charCategorizer(e),r=n(t);return s=>{let o=n(s);return r==ie.Space&&(r=o),r==o}}function CS(i,e,t,n){let r=e.head,s=t?1:-1;if(r==(t?i.state.doc.length:0))return $.cursor(r,e.assoc);let o=e.goalColumn,l,a=i.contentDOM.getBoundingClientRect(),h=i.coordsAtPos(r),c=i.documentTop;if(h)o==null&&(o=h.left-a.left),l=s<0?h.top:h.bottom;else{let g=i.viewState.lineBlockAt(r);o==null&&(o=Math.min(a.right-a.left,i.defaultCharacterWidth*(r-g.from))),l=(s<0?g.top:g.bottom)+c}let u=a.left+o,m=n??i.defaultLineHeight>>1;for(let g=0;;g+=10){let y=l+(m+g)*s,P=Jd(i,{x:u,y},!1,s);if(y<a.top||y>a.bottom||(s<0?P<r:P>r))return $.cursor(P,e.assoc,void 0,o)}}function Ta(i,e,t){let n=i.state.facet(Ud).map(r=>r(i));for(;;){let r=!1;for(let s of n)s.between(t.from-1,t.from+1,(o,l,a)=>{t.from>o&&t.from<l&&(t=e.head>t.from?$.cursor(o,1):$.cursor(l,-1),r=!0)});if(!r)return t}}var ja=class{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.mouseSelection=null;let t=(n,r)=>{this.ignoreDuringComposition(r)||r.type=="keydown"&&this.keydown(e,r)||(this.mustFlushObserver(r)&&e.observer.forceFlush(),this.runCustomHandlers(r.type,e,r)?r.preventDefault():n(e,r))};for(let n in Ce){let r=Ce[n];e.contentDOM.addEventListener(n,s=>{Gu(e,s)&&t(r,s)},za[n]),this.registeredEvents.push(n)}e.scrollDOM.addEventListener("mousedown",n=>{if(n.target==e.scrollDOM&&n.clientY>e.contentDOM.getBoundingClientRect().bottom&&(t(Ce.mousedown,n),!n.defaultPrevented&&n.button==2)){let r=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=r,200)}}),L.chrome&&L.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,L.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var n;let r;this.customHandlers=[];for(let s of t)if(r=(n=s.update(e).spec)===null||n===void 0?void 0:n.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:r});for(let o in r)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,l=>{Gu(e,l)&&this.runCustomHandlers(o,e,l)&&l.preventDefault()}))}}runCustomHandlers(e,t,n){for(let r of this.customHandlers){let s=r.handlers[e];if(s)try{if(s.call(r.plugin,n,t)||n.defaultPrevented)return!0}catch(o){Ye(t.state,o)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let n of this.customHandlers){let r=n.handlers.scroll;if(r)try{r.call(n.plugin,t,e)}catch(s){Ye(e.state,s)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(L.android&&L.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let n;return L.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((n=Kd.find(r=>r.keyCode==t.keyCode))&&!t.ctrlKey||ES.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=n||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,gi(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:L.safari&&!L.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}},Kd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],ES="dthko",ep=[16,17,18,20,91,92,224,225];function Es(i){return i*.7+8}var Xa=class{constructor(e,t,n,r){this.view=e,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=rS(e.contentDOM);let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(j.allowMultipleSelections)&&WS(e,t),this.dragMove=QS(e,t),this.dragging=RS(e,t)&&rp(t)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let n=0,r=0,s=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=s.left?n=-Es(s.left-e.clientX):e.clientX>=s.right&&(n=Es(e.clientX-s.right)),e.clientY<=s.top?r=-Es(s.top-e.clientY):e.clientY>=s.bottom&&(r=Es(e.clientY-s.bottom)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}};function WS(i,e){let t=i.state.facet(Md);return t.length?t[0](e):L.mac?e.metaKey:e.ctrlKey}function QS(i,e){let t=i.state.facet(Dd);return t.length?t[0](e):L.mac?!e.altKey:!e.ctrlKey}function RS(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=Ys(i.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let s=0;s<r.length;s++){let o=r[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Gu(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=oe.get(t))&&n.ignoreEvent(e))return!1;return!0}var Ce=Object.create(null),za=Object.create(null),tp=L.ie&&L.ie_version<15||L.ios&&L.webkit_version<604;function MS(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),np(i,t.value)},50)}function np(i,e){let{state:t}=i,n,r=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Ha!=null&&t.selection.ranges.every(a=>a.empty)&&Ha==s.toString()){let a=-1;n=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==a)return{range:h};a=c.from;let u=t.toText((o?s.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:u},range:$.cursor(h.from+u.length)}})}else o?n=t.changeByRange(a=>{let h=s.line(r++);return{changes:{from:a.from,to:a.to,insert:h.text},range:$.cursor(a.from+h.length)}}):n=t.replaceSelection(s);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ce.keydown=(i,e)=>{i.inputState.setSelectionOrigin("select"),e.keyCode==27?i.inputState.lastEscPress=Date.now():ep.indexOf(e.keyCode)<0&&(i.inputState.lastEscPress=0)};Ce.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};Ce.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};za.touchstart=za.touchmove={passive:!0};Ce.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return;let t=null;for(let n of i.state.facet(Ld))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=qS(i,e)),t){let n=i.root.activeElement!=i.contentDOM;i.inputState.startMouseSelection(new Xa(i,e,t,n)),n&&i.observer.ignore(()=>_d(i.contentDOM)),i.inputState.mouseSelection&&i.inputState.mouseSelection.start(e)}};function Ju(i,e,t,n){if(n==1)return $.cursor(e,t);if(n==2)return vS(i.state,e,t);{let r=De.find(i.docView,e),s=i.state.doc.lineAt(r?r.posAtEnd:e),o=r?r.posAtStart:s.from,l=r?r.posAtEnd:s.to;return l<i.state.doc.length&&l==s.to&&l++,$.range(o,l)}}var ip=(i,e)=>i>=e.top&&i<=e.bottom,Ku=(i,e,t)=>ip(e,t)&&i>=t.left&&i<=t.right;function DS(i,e,t,n){let r=De.find(i.docView,e);if(!r)return 1;let s=e-r.posAtStart;if(s==0)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&Ku(t,n,o))return-1;let l=r.coordsAt(s,1);return l&&Ku(t,n,l)?1:o&&ip(n,o)?-1:1}function ed(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:DS(i,t,e.clientX,e.clientY)}}var LS=L.ie&&L.ie_version<=11,td=null,nd=0,id=0;function rp(i){if(!LS)return i.detail;let e=td,t=id;return td=i,id=Date.now(),nd=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(nd+1)%3:1}function qS(i,e){let t=ed(i,e),n=rp(e),r=i.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),r=r.map(s.changes))},get(s,o,l){let a=ed(i,s),h=Ju(i,a.pos,a.bias,n);if(t.pos!=a.pos&&!o){let c=Ju(i,t.pos,t.bias,n),u=Math.min(c.from,h.from),m=Math.max(c.to,h.to);h=u<h.from?$.range(u,m):$.range(m,u)}return o?r.replaceRange(r.main.extend(h.from,h.to)):l&&r.ranges.length>1&&r.ranges.some(c=>c.eq(h))?BS(r,h):l?r.addRange(h):$.create([h])}}}function BS(i,e){for(let t=0;;t++)if(i.ranges[t].eq(e))return $.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}Ce.dragstart=(i,e)=>{let{selection:{main:t}}=i.state,{mouseSelection:n}=i.inputState;n&&(n.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",i.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function rd(i,e,t,n){if(!t)return;let r=i.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=i.inputState,o=n&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,l={from:r,insert:t},a=i.state.changes(o?[o,l]:l);i.focus(),i.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"})}Ce.drop=(i,e)=>{if(!e.dataTransfer)return;if(i.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let n=Array(t.length),r=0,s=()=>{++r==t.length&&rd(i,e,n.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[o]=l.result),s()},l.readAsText(t[o])}}else rd(i,e,e.dataTransfer.getData("Text"),!0)};Ce.paste=(i,e)=>{if(i.state.readOnly)return e.preventDefault();i.observer.flush();let t=tp?null:e.clipboardData;t?(np(i,t.getData("text/plain")||t.getData("text/uri-text")),e.preventDefault()):MS(i)};function ZS(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function VS(i){let e=[],t=[],n=!1;for(let r of i.selection.ranges)r.empty||(e.push(i.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:s}of i.selection.ranges){let o=i.doc.lineAt(s);o.number>r&&(e.push(o.text),t.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),r=o.number}n=!0}return{text:e.join(i.lineBreak),ranges:t,linewise:n}}var Ha=null;Ce.copy=Ce.cut=(i,e)=>{let{text:t,ranges:n,linewise:r}=VS(i.state);if(!t&&!r)return;Ha=r?t:null;let s=tp?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):ZS(i,t),e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})};var sp=Ke.define();function op(i,e){let t=[];for(let n of i.facet(Zd)){let r=n(i,e);r&&t.push(r)}return t?i.update({effects:t,annotations:sp.of(!0)}):null}function lp(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=op(i.state,e);t?i.dispatch(t):i.update([])}},10)}Ce.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),lp(i)};Ce.blur=i=>{i.observer.clearSelectionRange(),lp(i)};Ce.compositionstart=Ce.compositionupdate=i=>{i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0)};Ce.compositionend=i=>{i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionFirstChange=null,L.chrome&&L.android&&i.observer.flushSoon(),setTimeout(()=>{i.inputState.composing<0&&i.docView.compositionDeco.size&&i.update([])},50)};Ce.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};Ce.beforeinput=(i,e)=>{var t;let n;if(L.chrome&&L.android&&(n=Kd.find(r=>r.inputType==e.inputType))&&(i.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}};var sd=["pre-wrap","normal","pre-line","break-spaces"],Ga=class{constructor(e){this.lineWrapping=e,this.doc=X.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return sd.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,s,o){let l=sd.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=s,a){this.heightSamples={};for(let h=0;h<o.length;h++){let c=o[h];c<0?h++:this.heightSamples[Math.floor(c*10)]=!0}}return a}},Ja=class{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}},$t=class{constructor(e,t,n,r,s){this.from=e,this.length=t,this.top=n,this.height=r,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new $t(this.from,this.length+e.length,this.top,this.height+e.height,t)}},he=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(he||(he={})),qs=.001,Le=class{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>qs&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return Le.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let s=this,o=n.doc;for(let l=r.length-1;l>=0;l--){let{fromA:a,toA:h,fromB:c,toB:u}=r[l],m=s.lineAt(a,he.ByPosNoHeight,n.setDoc(t),0,0),g=m.to>=h?m:s.lineAt(h,he.ByPosNoHeight,n,0,0);for(u+=g.to-h,h=g.to;l>0&&m.from<=r[l-1].toA;)a=r[l-1].fromA,c=r[l-1].fromB,l--,a<m.from&&(m=s.lineAt(a,he.ByPosNoHeight,n,0,0));c+=m.from-a,a=m.from;let y=Sr.build(n.setDoc(o),e,c,u);s=s.replace(a,h,y)}return s.updateHeight(n,0)}static empty(){return new Ge(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,s=0;for(;;)if(t==n)if(r>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),n+=1+l.break,r-=l.size}else if(s>r*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,s-=l.size}else break;else if(r<s){let l=e[t++];l&&(r+=l.size)}else{let l=e[--n];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,n++),new Ka(Le.of(e.slice(0,t)),o,Le.of(e.slice(n)))}};Le.prototype.size=1;var Ks=class extends Le{constructor(e,t,n){super(e,t),this.type=n}blockAt(e,t,n,r){return new $t(r,this.length,n,this.height,this.type)}lineAt(e,t,n,r,s){return this.blockAt(0,n,r,s)}forEachLine(e,t,n,r,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,n,r,s))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},Ge=class extends Ks{constructor(e,t){super(e,t,se.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof Ge||r instanceof Ie&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Ie?r=new Ge(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Le.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},Ie=class extends Le{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-n+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,l=(this.height-a)/(this.length-s-1)}else o=this.height/s;return{firstLine:n,lastLine:r,perLine:o,perChar:l}}blockAt(e,t,n,r){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,r);if(t.lineWrapping){let h=r+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),c=t.doc.lineAt(h),u=l+c.length*a,m=Math.max(n,e-u/2);return new $t(c.from,c.length,m,u,se.Text)}else{let h=Math.max(0,Math.min(o-s,Math.floor((e-n)/l))),{from:c,length:u}=t.doc.line(s+h);return new $t(c,u,n+l*h,l,se.Text)}}lineAt(e,t,n,r,s){if(t==he.ByHeight)return this.blockAt(e,n,r,s);if(t==he.ByPosNoHeight){let{from:g,to:y}=n.doc.lineAt(e);return new $t(g,y-g,0,0,se.Text)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(n,s),h=n.doc.lineAt(e),c=l+h.length*a,u=h.number-o,m=r+l*u+a*(h.from-s-u);return new $t(h.from,h.length,Math.max(r,Math.min(m,r+this.height-c)),c,se.Text)}forEachLine(e,t,n,r,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:h}=this.heightMetrics(n,s);for(let c=e,u=r;c<=t;){let m=n.doc.lineAt(c);if(c==e){let y=m.number-l;u+=a*y+h*(e-s-y)}let g=a+h*m.length;o(new $t(m.from,m.length,u,g,se.Text)),u+=g,c=m.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let s=n[n.length-1];s instanceof Ie?n[n.length-1]=new Ie(s.length+r):n.push(null,new Ie(r-1))}if(e>0){let s=n[0];s instanceof Ie?n[0]=new Ie(e+s.length):n.unshift(new Ie(e-1),null)}return Le.of(n)}decomposeLeft(e,t){t.push(new Ie(e-1),null)}decomposeRight(e,t){t.push(null,new Ie(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let s=t+this.length;if(r&&r.from<=t+this.length&&r.more){let o=[],l=Math.max(t,r.from),a=-1;for(r.from>t&&o.push(new Ie(r.from-t-1).updateHeight(e,t));l<=s&&r.more;){let c=e.doc.lineAt(l).length;o.length&&o.push(null);let u=r.heights[r.index++];a==-1?a=u:Math.abs(u-a)>=qs&&(a=-2);let m=new Ge(c,u);m.outdated=!1,o.push(m),l+=c+1}l<=s&&o.push(null,new Ie(s-l).updateHeight(e,l));let h=Le.of(o);return(a<0||Math.abs(h.height-this.height)>=qs||Math.abs(a-this.heightMetrics(e,t).perLine)>=qs)&&(e.heightChanged=!0),h}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}},Ka=class extends Le{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let s=n+this.left.height;return e<s?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,s,r+this.left.length+this.break)}lineAt(e,t,n,r,s){let o=r+this.left.height,l=s+this.left.length+this.break,a=t==he.ByHeight?e<o:e<l,h=a?this.left.lineAt(e,t,n,r,s):this.right.lineAt(e,t,n,o,l);if(this.break||(a?h.to<l:h.from>l))return h;let c=t==he.ByPosNoHeight?he.ByPosNoHeight:he.ByPos;return a?h.join(this.right.lineAt(l,c,n,o,l)):this.left.lineAt(l,c,n,r,s).join(h)}forEachLine(e,t,n,r,s,o){let l=r+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,r,s,o),t>=a&&this.right.forEachLine(e,t,n,l,a,o);else{let h=this.lineAt(a,he.ByPos,n,r,s);e<h.from&&this.left.forEachLine(e,h.from-1,n,r,s,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,n,l,a,o)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of n)s.push(l);if(e>0&&od(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),od(s,l)}return Le.of(s)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Le.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return r&&r.from<=t+s.length&&r.more?a=s=s.updateHeight(e,t,n,r):s.updateHeight(e,t,n),r&&r.from<=l+o.length&&r.more?a=o=o.updateHeight(e,l,n,r):o.updateHeight(e,l,n),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function od(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof Ie&&(n=i[e+1])instanceof Ie&&i.splice(e-1,3,new Ie(t.length+1+n.length))}var YS=5,Sr=class{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Ge?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Ge(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0;r<0&&(r=this.oracle.lineHeight);let s=t-e;n.block?this.addBlock(new Ks(s,r,n.type)):(s||r>=YS)&&this.addLineDeco(r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ge(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new Ie(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ge)return e;let t=new Ge(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==se.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=se.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let n=this.ensureLine();n.length+=t,n.collapsed+=t,n.widgetHeight=Math.max(n.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ge)&&!this.isCovered?this.nodes.push(new Ge(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof Ge&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let s=new Sr(n,e);return H.spans(t,n,r,s,0),s.finish(n)}};function NS(i,e,t){let n=new eh;return H.compare(i,e,t,n,0),n.changes}var eh=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&Ba(e,t,this.changes,5)}};function US(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.defaultView||window,s=Math.max(0,t.left),o=Math.min(r.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(r.innerHeight,t.bottom);for(let h=i.parentNode;h&&h!=n.body;)if(h.nodeType==1){let c=h,u=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&u.overflow!="visible"){let m=c.getBoundingClientRect();s=Math.max(s,m.left),o=Math.min(o,m.right),l=Math.max(l,m.top),a=h==i.parentNode?m.bottom:Math.min(a,m.bottom)}h=u.position=="absolute"||u.position=="fixed"?c.offsetParent:c.parentNode}else if(h.nodeType==11)h=h.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function FS(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}var ur=class{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],s=t[n];if(r.from!=s.from||r.to!=s.to||r.size!=s.size)return!1}return!0}draw(e){return q.replace({widget:new th(this.size,e)}).range(this.from,this.to)}},th=class extends et{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},eo=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=ld,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ce.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(bh).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Ga(t),this.stateDeco=e.facet(yr).filter(n=>typeof n!="function"),this.heightMap=Le.empty().applyChanges(this.stateDeco,X.empty,this.heightOracle.setDoc(e.doc),[new dt(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=q.set(this.lineGaps.map(n=>n.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:s,to:o})=>r>=s&&r<=o)){let{from:s,to:o}=this.lineBlockAt(r);e.push(new di(s,o))}}this.viewports=e.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?ld:new nh(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:hr(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(yr).filter(h=>typeof h!="function");let r=e.changedRanges,s=dt.extendWithRanges(r,NS(n,this.stateDeco,e?e.changes:de.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let a=!e.changes.empty||e.flags&2||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Yd)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?ce.RTL:ce.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let h=0,c=0,u=parseInt(n.paddingTop)||0,m=parseInt(n.paddingBottom)||0;(this.paddingTop!=u||this.paddingBottom!=m)&&(this.paddingTop=u,this.paddingBottom=m,h|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=8);let g=(this.printing?FS:US)(t,this.paddingTop),y=g.top-this.pixelViewport.top,P=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let x=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(x!=this.inView&&(this.inView=x,x&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let k=l.width;if((this.contentDOMWidth!=k||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,h|=8),a){let D=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(D)&&(o=!0),o||r.lineWrapping&&Math.abs(k-this.contentDOMWidth)>r.charWidth){let{lineHeight:I,charWidth:E,textHeight:W}=e.docView.measureTextSize();o=I>0&&r.refresh(s,I,E,W,k/E,D),o&&(e.docView.minWidth=0,h|=8)}y>0&&P>0?c=Math.max(y,P):y<0&&P<0&&(c=Math.min(y,P)),r.heightChanged=!1;for(let I of this.viewports){let E=I.from==this.viewport.from?D:e.docView.measureVisibleLineHeights(I);this.heightMap=(o?Le.empty().applyChanges(this.stateDeco,X.empty,this.heightOracle,[new dt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,o,new Ja(I.from,E))}r.heightChanged&&(h|=2)}let Q=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Q&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(h&2||Q)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new di(r.lineAt(o-n*1e3,he.ByHeight,s,0,0).from,r.lineAt(l+(1-n)*1e3,he.ByHeight,s,0,0).to);if(t){let{head:h}=t.range;if(h<a.from||h>a.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=r.lineAt(h,he.ByPos,s,0,0),m;t.y=="center"?m=(u.top+u.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&h<a.from?m=u.top:m=u.bottom-c,a=new di(r.lineAt(m-1e3/2,he.ByHeight,s,0,0).from,r.lineAt(m+c+1e3/2,he.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new di(this.heightMap.lineAt(n,he.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,he.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,he.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,he.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||r<=o-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(n,250)))&&r>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new ur(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,s=r>>1,o=r<<1;if(this.defaultTextDirection!=ce.LTR&&!n)return[];let l=[],a=(h,c,u,m)=>{if(c-h<s)return;let g=this.state.selection.main,y=[g.from];g.empty||y.push(g.to);for(let x of y)if(x>h&&x<c){a(h,x-10,u,m),a(x+10,c,u,m);return}let P=XS(e,x=>x.from>=u.from&&x.to<=u.to&&Math.abs(x.from-h)<s&&Math.abs(x.to-c)<s&&!y.some(k=>x.from<k&&x.to>k));if(!P){if(c<u.to&&t&&n&&t.visibleRanges.some(x=>x.from<=c&&x.to>=c)){let x=t.moveToLineBoundary($.cursor(c),!1,!0).head;x>h&&(c=x)}P=new ur(h,c,this.gapSize(u,h,c,m))}l.push(P)};for(let h of this.viewportLines){if(h.length<o)continue;let c=jS(h.from,h.to,this.stateDeco);if(c.total<o)continue;let u=this.scrollTarget?this.scrollTarget.range.head:null,m,g;if(n){let y=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,P,x;if(u!=null){let k=Qs(c,u),Q=((this.visibleBottom-this.visibleTop)/2+y)/h.height;P=k-Q,x=k+Q}else P=(this.visibleTop-h.top-y)/h.height,x=(this.visibleBottom-h.top+y)/h.height;m=Ws(c,P),g=Ws(c,x)}else{let y=c.total*this.heightOracle.charWidth,P=r*this.heightOracle.charWidth,x,k;if(u!=null){let Q=Qs(c,u),D=((this.pixelViewport.right-this.pixelViewport.left)/2+P)/y;x=Q-D,k=Q+D}else x=(this.pixelViewport.left-P)/y,k=(this.pixelViewport.right+P)/y;m=Ws(c,x),g=Ws(c,k)}m>h.from&&a(h.from,m,h,c),g<h.to&&a(g,h.to,h,c)}return l}gapSize(e,t,n,r){let s=Qs(r,n)-Qs(r,t);return this.heightOracle.lineWrapping?e.height*s:r.total*this.heightOracle.charWidth*s}updateLineGaps(e){ur.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=q.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];H.spans(e,this.viewport.from,this.viewport.to,{span(r,s){t.push({from:r,to:s})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,s)=>r.from!=t[s].from||r.to!=t[s].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||hr(this.heightMap.lineAt(e,he.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return hr(this.heightMap.lineAt(this.scaler.fromDOM(e),he.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return hr(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},di=class{constructor(e,t){this.from=e,this.to=t}};function jS(i,e,t){let n=[],r=i,s=0;return H.spans(t,i,e,{span(){},point(o,l){o>r&&(n.push({from:r,to:o}),s+=o-r),r=l}},20),r<e&&(n.push({from:r,to:e}),s+=e-r),{total:s,ranges:n}}function Ws({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let r=0;;r++){let{from:s,to:o}=e[r],l=o-s;if(n<=l)return s+n;n-=l}}function Qs(i,e){let t=0;for(let{from:n,to:r}of i.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/i.total}function XS(i,e){for(let t of i)if(e(t))return t}var ld={toDOM(i){return i},fromDOM(i){return i},scale:1},nh=class{constructor(e,t,n){let r=0,s=0,o=0;this.viewports=n.map(({from:l,to:a})=>{let h=t.lineAt(l,he.ByPos,e,0,0).top,c=t.lineAt(a,he.ByPos,e,0,0).bottom;return r+=c-h,{from:l,to:a,top:h,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return r+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,r=s.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return n+(e-r)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,r=s.domBottom}}};function hr(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new $t(i.from,i.length,t,n-t,Array.isArray(i.type)?i.type.map(r=>hr(r,e)):i.type)}var Rs=M.define({combine:i=>i.join(" ")}),ih=M.define({combine:i=>i.indexOf(!0)>-1}),rh=ut.newName(),ap=ut.newName(),hp=ut.newName(),cp={"&light":"."+ap,"&dark":"."+hp};function sh(i,e,t){return new ut(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return i;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):i+" "+n}})}var zS=sh("."+rh,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},cp),oh=class{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let l=s||o?[]:GS(e),a=new zs(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=JS(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!Oi(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),h=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!Oi(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset);this.newSel=$.single(h,a)}}};function fp(i,e){let t,{newSel:n}=e,r=i.state.selection.main;if(e.bounds){let{from:s,to:o}=e.bounds,l=r.from,a=null;(i.inputState.lastKeyCode===8&&i.inputState.lastKeyTime>Date.now()-100||L.android&&e.text.length<o-s)&&(l=r.to,a="end");let h=HS(i.state.doc.sliceString(s,o,fn),e.text,l-s,a);h&&(L.chrome&&i.inputState.lastKeyCode==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==fn+fn&&h.toB--,t={from:s+h.from,to:s+h.toA,insert:X.of(e.text.slice(h.from,h.toB).split(fn))})}else n&&(!i.hasFocus&&i.state.facet(oo)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:i.state.doc.slice(r.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,r.to))}:(L.mac||L.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=$.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:X.of([" "])}):L.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=$.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:X.of([" "])}),t){let s=i.state;if(L.ios&&i.inputState.flushIOSKey(i)||L.android&&(t.from==r.from&&t.to==r.to&&t.insert.length==1&&t.insert.lines==2&&gi(i.contentDOM,"Enter",13)||t.from==r.from-1&&t.to==r.to&&t.insert.length==0&&gi(i.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&t.insert.length==0&&gi(i.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();if(i.state.facet(Bd).some(h=>h(i,t.from,t.to,o)))return!0;i.inputState.composing>=0&&i.inputState.composing++;let l;if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&i.inputState.composing<0){let h=r.from<t.from?s.sliceDoc(r.from,t.from):"",c=r.to>t.to?s.sliceDoc(t.to,r.to):"";l=s.replaceSelection(i.state.toText(h+t.insert.sliceString(0,void 0,i.state.lineBreak)+c))}else{let h=s.changes(t),c=n&&!s.selection.main.eq(n.main)&&n.main.to<=h.newLength?n.main:void 0;if(s.selection.ranges.length>1&&i.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let u=i.state.sliceDoc(t.from,t.to),m=Hd(i)||i.state.doc.lineAt(r.head),g=r.to-t.to,y=r.to-r.from;l=s.changeByRange(P=>{if(P.from==r.from&&P.to==r.to)return{changes:h,range:c||P.map(h)};let x=P.to-g,k=x-u.length;if(P.to-P.from!=y||i.state.sliceDoc(k,x)!=u||m&&P.to>=m.from&&P.from<=m.to)return{range:P};let Q=s.changes({from:k,to:x,insert:t.insert}),D=P.to-r.to;return{changes:Q,range:c?$.range(Math.max(0,c.anchor+D),Math.max(0,c.head+D)):P.map(Q)}})}else l={changes:h,selection:c&&s.selection.replaceRange(c)}}let a="input.type";return i.composing&&(a+=".compose",i.inputState.compositionFirstChange&&(a+=".start",i.inputState.compositionFirstChange=!1)),i.dispatch(l,{scrollIntoView:!0,userEvent:a}),!0}else if(n&&!n.main.eq(r)){let s=!1,o="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(s=!0),o=i.inputState.lastSelectionOrigin),i.dispatch({selection:n,scrollIntoView:s,userEvent:o}),!0}else return!1}function HS(i,e,t,n){let r=Math.min(i.length,e.length),s=0;for(;s<r&&i.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==r&&i.length==e.length)return null;let o=i.length,l=e.length;for(;o>0&&l>0&&i.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(n=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&i.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function GS(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:s}=i.observer.selectionRange;return t&&(e.push(new Hs(t,n)),(r!=t||s!=n)&&e.push(new Hs(r,s))),e}function JS(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?$.single(t+e,n+e):null}var KS={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ka=L.ie&&L.ie_version<=11,lh=class{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Ea,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(L.ie&&L.ie_version<=11||L.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),ka&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(oo)?n.root.activeElement!=this.dom:!Ls(n.dom,r))return;let s=r.anchorNode&&n.docView.nearest(r.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(L.ie&&L.ie_version<=11||L.android&&L.chrome)&&!n.state.selection.main.empty&&r.focusNode&&Ns(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=L.safari&&e.root.nodeType==11&&tS(this.dom.ownerDocument)==this.dom&&eb(this.view)||Ys(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=Ls(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&oS(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,KS),ka&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ka&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),!this.flush()&&s.force&&gi(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(r=!0),t==-1?{from:t,to:n}=o:(t=Math.min(o.from,t),n=Math.max(o.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&Ls(this.dom,this.selectionRange);return e<0&&!r?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new oh(this.view,e,t,n))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return!1;let n=this.view.state,r=fp(this.view,t);return this.view.state==n&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let n=ad(t,e.previousSibling||e.target.previousSibling,-1),r=ad(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect(),(r=this.resizeContent)===null||r===void 0||r.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}};function ad(i,e,t){for(;e;){let n=oe.get(e);if(n&&n.parent==i)return n;let r=e.parentNode;e=r!=i.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function eb(i){let e=null;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}if(i.contentDOM.addEventListener("beforeinput",t,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let n=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,l=i.docView.domAtPos(i.state.selection.main.anchor);return Ns(l.node,l.offset,s,o)&&([n,r,s,o]=[s,o,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:o}}var R=class{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||sS(e.parent)||document,this.viewState=new eo(e.state||j.create(e)),this.plugins=this.state.facet(lr).map(t=>new fr(t));for(let t of this.plugins)t.update(this);this.observer=new lh(this),this.inputState=new ja(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Gs(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof pe?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,s=this.state;for(let m of e){if(m.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=m.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(m=>m.annotation(sp))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=op(s,o),a||(l=1));let h=this.observer.delayedAndroidKey,c=null;if(h?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(j.phrases)!=this.state.facet(j.phrases))return this.setState(s);r=wi.create(this,s,e),r.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(u&&(u=u.map(m.changes)),m.scrollIntoView){let{main:g}=m.state.selection;u=new bi(g.empty?g:$.cursor(g.head,g.head>g.anchor?-1:1))}for(let g of m.effects)g.is(Nu)&&(u=g.value)}this.viewState.update(r,u),this.bidiCache=xi.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(ar)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Rs)!=r.state.facet(Rs)&&(this.viewState.mustMeasureContent=!0),(t||n||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let m of this.state.facet(Za))m(r);(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!fp(this,c)&&h.force&&gi(this.contentDOM,h.key,h.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new eo(e),this.plugins=e.facet(lr).map(n=>new fr(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView=new Gs(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(lr),n=e.state.facet(lr);if(t!=n){let r=[];for(let s of n){let o=t.indexOf(s);if(o<0)r.push(new fr(s));else{let l=this.plugins[o];l.mustUpdate=e,r.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,{scrollHeight:n,scrollTop:r,clientHeight:s}=this.scrollDOM,o=r>n-s-4?n:r;try{for(let l=0;;l++){this.updateState=1;let a=this.viewport,h=this.viewState.lineBlockAtHeight(o),c=this.viewState.measure(this);if(!c&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];c&4||([this.measureRequests,u]=[u,this.measureRequests]);let m=u.map(x=>{try{return x.read(this)}catch(k){return Ye(this.state,k),hd}}),g=wi.create(this,this.state,[]),y=!1,P=!1;g.flags|=c,t?t.flags|=c:t=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),y=this.docView.update(g));for(let x=0;x<u.length;x++)if(m[x]!=hd)try{let k=u[x];k.write&&k.write(m[x],this)}catch(k){Ye(this.state,k)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,P=!0;else{let x=this.viewState.lineBlockAt(h.from).top-h.top;(x>1||x<-1)&&(this.scrollDOM.scrollTop+=x,P=!0)}if(y&&this.docView.updateSelection(!0),this.viewport.from==a.from&&this.viewport.to==a.to&&!P&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(Za))l(t)}get themeClasses(){return rh+" "+(this.state.facet(ih)?hp:ap)+" "+this.state.facet(Rs)}updateAttrs(){let e=cd(this,Nd,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(oo)?"true":"false",class:"cm-content",style:`${L.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),cd(this,bh,t);let n=this.observer.ignore(()=>{let r=qa(this.contentDOM,this.contentAttrs,t),s=qa(this.dom,this.editorAttrs,e);return r||s});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(R.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(ar),ut.mount(this.root,this.styleModules.concat(zS).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Ta(this,e,Hu(this,e,t,n))}moveByGroup(e,t){return Ta(this,e,Hu(this,e,t,n=>AS(this,e.head,n)))}moveToLineBoundary(e,t,n=!0){return IS(this,e,t,n)}moveVertically(e,t,n){return Ta(this,e,CS(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Jd(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),s=this.bidiSpans(r),o=s[un.find(s,e-r.from,-1,t)];return Oh(n,o.dir==ce.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Vd)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>tb)return Xd(e.length);let t=this.textDirectionAt(e.from);for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t)return r.order;let n=OS(e.text,t);return this.bidiCache.push(new xi(e.from,e.to,t,n)),n}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||L.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{_d(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Nu.of(new bi(typeof e=="number"?$.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return ae.define(()=>({}),{eventHandlers:e})}static theme(e,t){let n=ut.newName(),r=[Rs.of(n),ar.of(sh(`.${n}`,e))];return t&&t.dark&&r.push(ih.of(!0)),r}static baseTheme(e){return _t.lowest(ar.of(sh("."+rh,e,cp)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&oe.get(n)||oe.get(e);return((t=r?.rootView)===null||t===void 0?void 0:t.view)||null}};R.styleModule=ar;R.inputHandler=Bd;R.focusChangeEffect=Zd;R.perLineTextDirection=Vd;R.exceptionSink=qd;R.updateListener=Za;R.editable=oo;R.mouseSelectionStyle=Ld;R.dragMovesSelection=Dd;R.clickAddsSelectionRange=Md;R.decorations=yr;R.atomicRanges=Ud;R.scrollMargins=Fd;R.darkTheme=ih;R.contentAttributes=bh;R.editorAttributes=Nd;R.lineWrapping=R.contentAttributes.of({class:"cm-lineWrapping"});R.announce=V.define();var tb=4096,hd={},xi=class{constructor(e,t,n,r){this.from=e,this.to=t,this.dir=n,this.order=r}static update(e,t){if(t.empty)return e;let n=[],r=e.length?e[e.length-1].dir:ce.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==r&&!t.touchesRange(o.from,o.to)&&n.push(new xi(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return n}};function cd(i,e,t){for(let n=i.state.facet(e),r=n.length-1;r>=0;r--){let s=n[r],o=typeof s=="function"?s(i):s;o&&La(o,t)}return t}var nb=L.mac?"mac":L.windows?"win":L.linux?"linux":"key";function ib(i,e){let t=i.split(/-(?!$)/),n=t[t.length-1];n=="Space"&&(n=" ");let r,s,o,l;for(let a=0;a<t.length-1;++a){let h=t[a];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))s=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),l&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function Ms(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}var rb=_t.default(R.domEventHandlers({keydown(i,e){return pp(up(e.state),i,e,"editor")}})),pn=M.define({enables:rb}),fd=new WeakMap;function up(i){let e=i.facet(pn),t=fd.get(e);return t||fd.set(e,t=ob(e.reduce((n,r)=>n.concat(r),[]))),t}function dp(i,e,t){return pp(up(i.state),e,i,t)}var cn=null,sb=4e3;function ob(i,e=nb){let t=Object.create(null),n=Object.create(null),r=(o,l)=>{let a=n[o];if(a==null)n[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,h)=>{var c,u;let m=t[o]||(t[o]=Object.create(null)),g=l.split(/ (?!$)/).map(x=>ib(x,e));for(let x=1;x<g.length;x++){let k=g.slice(0,x).join(" ");r(k,!0),m[k]||(m[k]={preventDefault:!0,run:[Q=>{let D=cn={view:Q,prefix:k,scope:o};return setTimeout(()=>{cn==D&&(cn=null)},sb),!0}]})}let y=g.join(" ");r(y,!1);let P=m[y]||(m[y]={preventDefault:!1,run:((u=(c=m._any)===null||c===void 0?void 0:c.run)===null||u===void 0?void 0:u.slice())||[]});a&&P.run.push(a),h&&(P.preventDefault=!0)};for(let o of i){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let h of l){let c=t[h]||(t[h]=Object.create(null));c._any||(c._any={preventDefault:!1,run:[]});for(let u in c)c[u].run.push(o.any)}let a=o[e]||o.key;if(a)for(let h of l)s(h,a,o.run,o.preventDefault),o.shift&&s(h,"Shift-"+a,o.shift,o.preventDefault)}return t}function pp(i,e,t,n){let r=Du(e),s=_e(r,0),o=He(s)==r.length&&r!=" ",l="",a=!1;cn&&cn.view==t&&cn.scope==n&&(l=cn.prefix+" ",(a=ep.indexOf(e.keyCode)<0)&&(cn=null));let h=new Set,c=y=>{if(y){for(let P of y.run)if(!h.has(P)&&(h.add(P),P(t,e)))return!0;y.preventDefault&&(a=!0)}return!1},u=i[n],m,g;if(u){if(c(u[l+Ms(r,e,!o)]))return!0;if(o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(L.windows&&e.ctrlKey&&e.altKey)&&(m=zt[e.keyCode])&&m!=r){if(c(u[l+Ms(m,e,!0)]))return!0;if(e.shiftKey&&(g=fi[e.keyCode])!=r&&g!=m&&c(u[l+Ms(g,e,!1)]))return!0}else if(o&&e.shiftKey&&c(u[l+Ms(r,e,!0)]))return!0;if(c(u._any))return!0}return a}var Vn=class{constructor(e,t,n,r,s){this.className=e,this.left=t,this.top=n,this.width=r,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let s=mp(e);return[new Vn(t,r.left-s.left,r.top-s.top,null,r.bottom-r.top)]}else return lb(e,t,n)}};function mp(i){let e=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==ce.LTR?e.left:e.right-i.scrollDOM.clientWidth)-i.scrollDOM.scrollLeft,top:e.top-i.scrollDOM.scrollTop}}function ud(i,e,t){let n=$.cursor(e);return{from:Math.max(t.from,i.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,i.moveToLineBoundary(n,!0,!0).from),type:se.Text}}function dd(i,e){let t=i.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==se.Text))return n}return t}function lb(i,e,t){if(t.to<=i.viewport.from||t.from>=i.viewport.to)return[];let n=Math.max(t.from,i.viewport.from),r=Math.min(t.to,i.viewport.to),s=i.textDirection==ce.LTR,o=i.contentDOM,l=o.getBoundingClientRect(),a=mp(i),h=o.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),u=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),m=l.right-(c?parseInt(c.paddingRight):0),g=dd(i,n),y=dd(i,r),P=g.type==se.Text?g:null,x=y.type==se.Text?y:null;if(i.lineWrapping&&(P&&(P=ud(i,n,P)),x&&(x=ud(i,r,x))),P&&x&&P.from==x.from)return Q(D(t.from,t.to,P));{let E=P?D(t.from,null,P):I(g,!1),W=x?D(null,t.to,x):I(y,!0),Z=[];return(P||g).to<(x||y).from-1?Z.push(k(u,E.bottom,m,W.top)):E.bottom<W.top&&i.elementAtHeight((E.bottom+W.top)/2).type==se.Text&&(E.bottom=W.top=(E.bottom+W.top)/2),Q(E).concat(Z).concat(Q(W))}function k(E,W,Z,te){return new Vn(e,E-a.left,W-a.top-.01,Z-E,te-W+.01)}function Q({top:E,bottom:W,horizontal:Z}){let te=[];for(let U=0;U<Z.length;U+=2)te.push(k(Z[U],E,Z[U+1],W));return te}function D(E,W,Z){let te=1e9,U=-1e9,F=[];function K(qe,Te,We,ht,Be){let ge=i.coordsAtPos(qe,qe==Z.to?-2:2),Pe=i.coordsAtPos(We,We==Z.from?2:-2);te=Math.min(ge.top,Pe.top,te),U=Math.max(ge.bottom,Pe.bottom,U),Be==ce.LTR?F.push(s&&Te?u:ge.left,s&&ht?m:Pe.right):F.push(!s&&ht?u:Pe.left,!s&&Te?m:ge.right)}let be=E??Z.from,Ee=W??Z.to;for(let qe of i.visibleRanges)if(qe.to>be&&qe.from<Ee)for(let Te=Math.max(qe.from,be),We=Math.min(qe.to,Ee);;){let ht=i.state.doc.lineAt(Te);for(let Be of i.bidiSpans(ht)){let ge=Be.from+ht.from,Pe=Be.to+ht.from;if(ge>=We)break;Pe>Te&&K(Math.max(ge,Te),E==null&&ge<=be,Math.min(Pe,We),W==null&&Pe>=Ee,Be.dir)}if(Te=ht.to+1,Te>=We)break}return F.length==0&&K(be,E==null,Ee,W==null,i.textDirection),{top:te,bottom:U,horizontal:F}}function I(E,W){let Z=l.top+(W?E.top:E.bottom);return{top:Z,bottom:Z,horizontal:[]}}}function ab(i,e){return i.constructor==e.constructor&&i.eq(e)}var ah=class{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Bs)!=e.state.facet(Bs)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(Bs);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!ab(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}},Bs=M.define();function gp(i){return[ae.define(e=>new ah(e,i)),Bs.of(i)]}var Op=!L.ios,br=M.define({combine(i){return Ve(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function yp(i={}){return[br.of(i),hb,cb,fb,Yd.of(!0)]}function Sp(i){return i.startState.facet(br)!=i.state.facet(br)}var hb=gp({above:!0,markers(i){let{state:e}=i,t=e.facet(br),n=[];for(let r of e.selection.ranges){let s=r==e.selection.main;if(r.empty?!s||Op:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=r.empty?r:$.cursor(r.head,r.head>r.anchor?-1:1);for(let a of Vn.forRange(i,o,l))n.push(a)}}return n},update(i,e){i.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Sp(i);return t&&pd(i.state,e),i.docChanged||i.selectionSet||t},mount(i,e){pd(e.state,i)},class:"cm-cursorLayer"});function pd(i,e){e.style.animationDuration=i.facet(br).cursorBlinkRate+"ms"}var cb=gp({above:!1,markers(i){return i.state.selection.ranges.map(e=>e.empty?[]:Vn.forRange(i,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(i,e){return i.docChanged||i.selectionSet||i.viewportChanged||Sp(i)},class:"cm-selectionLayer"}),bp={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Op&&(bp[".cm-line"].caretColor="transparent !important");var fb=_t.highest(R.theme(bp)),wp=V.define({map(i,e){return i==null?null:e.mapPos(i)}}),cr=le.define({create(){return null},update(i,e){return i!=null&&(i=e.changes.mapPos(i)),e.effects.reduce((t,n)=>n.is(wp)?n.value:t,i)}}),ub=ae.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var e;let t=i.state.field(cr);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(cr)!=t||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let i=this.view.state.field(cr),e=i!=null&&this.view.coordsAtPos(i);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(i){this.cursor&&(i?(this.cursor.style.left=i.left+"px",this.cursor.style.top=i.top+"px",this.cursor.style.height=i.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(cr)!=i&&this.view.dispatch({effects:wp.of(i)})}},{eventHandlers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function xp(){return[cr,ub]}function md(i,e,t,n,r){e.lastIndex=0;for(let s=i.iterRange(t,n),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)r(o+l.index,l)}function db(i,e){let t=i.visibleRanges;if(t.length==1&&t[0].from==i.viewport.from&&t[0].to==i.viewport.to)return t;let n=[];for(let{from:r,to:s}of t)r=Math.max(i.state.doc.lineAt(r).from,r-e),s=Math.min(i.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=s:n.push({from:r,to:s});return n}var hh=class{constructor(e){let{regexp:t,decoration:n,decorate:r,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(l,a,h,c)=>r(c,h,h+l[0].length,l,a);else if(typeof n=="function")this.addMatch=(l,a,h,c)=>{let u=n(l,a,h);u&&c(h,h+l[0].length,u)};else if(n)this.addMatch=(l,a,h,c)=>c(h,h+l[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new nt,n=t.add.bind(t);for(let{from:r,to:s}of db(e,this.maxLength))md(e.state.doc,this.regexp,r,s,(o,l)=>this.addMatch(l,e,o,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>e.view.viewport.from&&l<e.view.viewport.to&&(n=Math.min(l,n),r=Math.max(a,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let s of e.visibleRanges){let o=Math.max(s.from,n),l=Math.min(s.to,r);if(l>o){let a=e.state.doc.lineAt(o),h=a.to<l?e.state.doc.lineAt(l):a,c=Math.max(s.from,a.from),u=Math.min(s.to,h.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){c=o;break}for(;l<h.to;l++)if(this.boundary.test(h.text[l-h.from])){u=l;break}}let m=[],g,y=(P,x,k)=>m.push(k.range(P,x));if(a==h)for(this.regexp.lastIndex=c-a.from;(g=this.regexp.exec(a.text))&&g.index<u-a.from;)this.addMatch(g,e,g.index+a.from,y);else md(e.state.doc,this.regexp,c,u,(P,x)=>this.addMatch(x,e,P,y));t=t.update({filterFrom:c,filterTo:u,filter:(P,x)=>P<c||x>u,add:m})}}return t}},ch=/x/.unicode!=null?"gu":"g",pb=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,ch),mb={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},Ia=null;function gb(){var i;if(Ia==null&&typeof document<"u"&&document.body){let e=document.body.style;Ia=((i=e.tabSize)!==null&&i!==void 0?i:e.MozTabSize)!=null}return Ia||!1}var Zs=M.define({combine(i){let e=Ve(i,{render:null,specialChars:pb,addSpecialChars:null});return(e.replaceTabs=!gb())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ch)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ch)),e}});function Pp(i={}){return[Zs.of(i),Ob()]}var gd=null;function Ob(){return gd||(gd=ae.fromClass(class{constructor(i){this.view=i,this.decorations=q.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(Zs)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new hh({regexp:i.specialChars,decoration:(e,t,n)=>{let{doc:r}=t.state,s=_e(e[0],0);if(s==9){let o=r.lineAt(n),l=t.state.tabSize,a=hn(o.text,l,n-o.from);return q.replace({widget:new uh((l-a%l)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=q.replace({widget:new fh(i,s)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let e=i.state.facet(Zs);i.startState.facet(Zs)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}var yb="\u2022";function Sb(i){return i>=32?yb:i==10?"\u2424":String.fromCharCode(9216+i)}var fh=class extends et{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Sb(this.code),n=e.state.phrase("Control character")+" "+(mb[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;let s=document.createElement("span");return s.textContent=t,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}},uh=class extends et{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}};function vp(){return wb}var bb=q.line({class:"cm-activeLine"}),wb=ae.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=-1,t=[];for(let n of i.state.selection.ranges){let r=i.lineBlockAt(n.head);r.from>e&&(t.push(bb.range(r.from)),e=r.from)}return q.set(t)}},{decorations:i=>i.decorations});var dh=2e3;function xb(i,e,t){let n=Math.min(e.line,t.line),r=Math.max(e.line,t.line),s=[];if(e.off>dh||t.off>dh||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=n;a<=r;a++){let h=i.doc.line(a);h.length<=l&&s.push($.range(h.from+o,h.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=n;a<=r;a++){let h=i.doc.line(a),c=ks(h.text,o,i.tabSize,!0);if(c<0)s.push($.cursor(h.to));else{let u=ks(h.text,l,i.tabSize);s.push($.range(h.from+c,h.from+u))}}}return s}function Pb(i,e){let t=i.coordsAtPos(i.viewport.from);return t?Math.round(Math.abs((t.left-e)/i.defaultCharacterWidth)):-1}function Od(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1),n=i.state.doc.lineAt(t),r=t-n.from,s=r>dh?-1:r==n.length?Pb(i,e.clientX):hn(n.text,i.state.tabSize,t-n.from);return{line:n.number,col:s,off:r}}function vb(i,e){let t=Od(i,e),n=i.state.selection;return t?{update(r){if(r.docChanged){let s=r.changes.mapPos(r.startState.doc.line(t.line).from),o=r.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},n=n.map(r.changes)}},get(r,s,o){let l=Od(i,r);if(!l)return n;let a=xb(i.state,t,l);return a.length?o?$.create(a.concat(n.ranges)):$.create(a):n}}:null}function _p(i){let e=i?.eventFilter||(t=>t.altKey&&t.button==0);return R.mouseSelectionStyle.of((t,n)=>e(n)?vb(t,n):null)}var _b={Alt:[18,i=>i.altKey],Control:[17,i=>i.ctrlKey],Shift:[16,i=>i.shiftKey],Meta:[91,i=>i.metaKey]},$b={style:"cursor: crosshair"};function $p(i={}){let[e,t]=_b[i.key||"Alt"],n=ae.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventHandlers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[n,R.contentAttributes.of(r=>{var s;return!((s=r.plugin(n))===null||s===void 0)&&s.isDown?$b:null})]}var Ds="-10000px",to=class{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(n)}update(e){var t;let n=e.state.facet(this.facet),r=n.filter(o=>o);if(n===this.input){for(let o of this.tooltipViews)o.update&&o.update(e);return!1}let s=[];for(let o=0;o<r.length;o++){let l=r[o],a=-1;if(l){for(let h=0;h<this.tooltips.length;h++){let c=this.tooltips[h];c&&c.create==l.create&&(a=h)}if(a<0)s[o]=this.createTooltipView(l);else{let h=s[o]=this.tooltipViews[a];h.update&&h.update(e)}}}for(let o of this.tooltipViews)s.indexOf(o)<0&&(o.dom.remove(),(t=o.destroy)===null||t===void 0||t.call(o));return this.input=n,this.tooltips=r,this.tooltipViews=s,!0}};function Tb(i){let{win:e}=i;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}var Aa=M.define({combine:i=>{var e,t,n;return{position:L.ios?"absolute":((e=i.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Tb}}}),yd=new WeakMap,Tp=ae.fromClass(class{constructor(i){this.view=i,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(Aa);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new to(i,xr,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(Aa);if(n.position!=this.position){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i){let e=i.create(this.view);if(e.dom.classList.add("cm-tooltip"),i.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Ds,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var i,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(i=t.destroy)===null||i===void 0||i.call(t);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=this.view.dom.getBoundingClientRect();return{editor:i,parent:this.parent?this.container.getBoundingClientRect():i,pos:this.manager.tooltips.map((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Aa).tooltipSpace(this.view)}}writeMeasure(i){var e;let{editor:t,space:n}=i,r=[];for(let s=0;s<this.manager.tooltips.length;s++){let o=this.manager.tooltips[s],l=this.manager.tooltipViews[s],{dom:a}=l,h=i.pos[s],c=i.size[s];if(!h||h.bottom<=Math.max(t.top,n.top)||h.top>=Math.min(t.bottom,n.bottom)||h.right<Math.max(t.left,n.left)-.1||h.left>Math.min(t.right,n.right)+.1){a.style.top=Ds;continue}let u=o.arrow?l.dom.querySelector(".cm-tooltip-arrow"):null,m=u?7:0,g=c.right-c.left,y=(e=yd.get(l))!==null&&e!==void 0?e:c.bottom-c.top,P=l.offset||Ib,x=this.view.textDirection==ce.LTR,k=c.width>n.right-n.left?x?n.left:n.right-c.width:x?Math.min(h.left-(u?14:0)+P.x,n.right-g):Math.max(n.left,h.left-g+(u?14:0)-P.x),Q=!!o.above;!o.strictSide&&(Q?h.top-(c.bottom-c.top)-P.y<n.top:h.bottom+(c.bottom-c.top)+P.y>n.bottom)&&Q==n.bottom-h.bottom>h.top-n.top&&(Q=!Q);let D=(Q?h.top-n.top:n.bottom-h.bottom)-m;if(D<y&&l.resize!==!1){if(D<this.view.defaultLineHeight){a.style.top=Ds;continue}yd.set(l,y),a.style.height=(y=D)+"px"}else a.style.height&&(a.style.height="");let I=Q?h.top-y-m-P.y:h.bottom+m+P.y,E=k+g;if(l.overlap!==!0)for(let W of r)W.left<E&&W.right>k&&W.top<I+y&&W.bottom>I&&(I=Q?W.top-y-2-m:W.bottom+m+2);this.position=="absolute"?(a.style.top=I-i.parent.top+"px",a.style.left=k-i.parent.left+"px"):(a.style.top=I+"px",a.style.left=k+"px"),u&&(u.style.left=`${h.left+(x?P.x:-P.x)-(k+14-7)}px`),l.overlap!==!0&&r.push({left:k,top:I,right:E,bottom:I+y}),a.classList.toggle("cm-tooltip-above",Q),a.classList.toggle("cm-tooltip-below",!Q),l.positioned&&l.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Ds}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),kb=R.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ib={x:0,y:0},xr=M.define({enables:[Tp,kb]}),no=M.define(),wr=class{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new to(e,no,t=>this.createHostedView(t))}static create(e){return new wr(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}},Ab=xr.compute([no],i=>{let e=i.facet(no).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:wr.create,above:e[0].above,arrow:e.some(t=>t.arrow)}}),ph=class{constructor(e,t,n,r,s){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let n=this.view.coordsAtPos(t);if(n==null||e.y<n.top||e.y>n.bottom||e.x<n.left-this.view.defaultCharacterWidth||e.x>n.right+this.view.defaultCharacterWidth)return;let r=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(l=>l.from<=t&&l.to>=t),s=r&&r.dir==ce.RTL?-1:1,o=this.source(this.view,t,e.x<n.left?-s:s);if(o?.then){let l=this.pending={pos:t};o.then(a=>{this.pending==l&&(this.pending=null,a&&this.view.dispatch({effects:this.setHover.of(a)}))},a=>Ye(this.view.state,a,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let n=this.active;if(n&&!Sd(this.lastMove.target)||this.pending){let{pos:r}=n||this.pending,s=(t=n?.end)!==null&&t!==void 0?t:r;(r==s?this.view.posAtCoords(this.lastMove)!=r:!Cb(this.view,r,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!Sd(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}};function Sd(i){for(let e=i;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Cb(i,e,t,n,r,s){let o=document.createRange(),l=i.domAtPos(e),a=i.domAtPos(t);o.setEnd(a.node,a.offset),o.setStart(l.node,l.offset);let h=o.getClientRects();o.detach();for(let c=0;c<h.length;c++){let u=h[c];if(Math.max(u.top-r,r-u.bottom,u.left-n,n-u.right)<=s)return!0}return!1}function kp(i,e={}){let t=V.define(),n=le.define({create(){return null},update(r,s){if(r&&(e.hideOnChange&&(s.docChanged||s.selection)||e.hideOn&&e.hideOn(s,r)))return null;if(r&&s.docChanged){let o=s.changes.mapPos(r.pos,-1,ke.TrackDel);if(o==null)return null;let l=Object.assign(Object.create(null),r);l.pos=o,r.end!=null&&(l.end=s.changes.mapPos(r.end)),r=l}for(let o of s.effects)o.is(t)&&(r=o.value),o.is(Eb)&&(r=null);return r},provide:r=>no.from(r)});return[n,ae.define(r=>new ph(r,i,n,t,e.hoverTime||300)),Ab]}function Ip(i,e){let t=i.plugin(Tp);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}var Eb=V.define();var bd=M.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Nn(i,e){let t=i.plugin(Ap),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}var Ap=ae.fromClass(class{constructor(i){this.input=i.state.facet(Yn),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet(bd);this.top=new pi(i,!0,e.topContainer),this.bottom=new pi(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet(bd);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new pi(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new pi(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(Yn);if(t!=this.input){let n=t.filter(a=>a),r=[],s=[],o=[],l=[];for(let a of n){let h=this.specs.indexOf(a),c;h<0?(c=a(i.view),l.push(c)):(c=this.panels[h],c.update&&c.update(i)),r.push(c),(c.top?s:o).push(c)}this.specs=n,this.panels=r,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>R.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})}),pi=class{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=wd(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=wd(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function wd(i){let e=i.nextSibling;return i.remove(),e}var Yn=M.define({enables:Ap}),rt=class extends vt{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};rt.prototype.elementClass="";rt.prototype.toDOM=void 0;rt.prototype.mapMode=ke.TrackBefore;rt.prototype.startSide=rt.prototype.endSide=-1;rt.prototype.point=!0;var Vs=M.define(),Wb={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>H.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},dr=M.define();function wh(i){return[Cp(),dr.of(Object.assign(Object.assign({},Wb),i))]}var mh=M.define({combine:i=>i.some(e=>e)});function Cp(i){let e=[Qb];return i&&i.fixed===!1&&e.push(mh.of(!0)),e}var Qb=ae.fromClass(class{constructor(i){this.view=i,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=i.state.facet(dr).map(e=>new io(i,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!i.state.facet(mh),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}update(i){if(this.updateGutters(i)){let e=this.prevViewport,t=i.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}i.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(mh)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=i.view.viewport}syncGutters(i){let e=this.dom.nextSibling;i&&this.dom.remove();let t=H.iter(this.view.state.facet(Vs),this.view.viewport.from),n=[],r=this.gutters.map(s=>new gh(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks){let o;if(Array.isArray(s.type)){for(let l of s.type)if(l.type==se.Text){o=l;break}}else o=s.type==se.Text?s:void 0;if(o){n.length&&(n=[]),Ep(t,n,s.from);for(let l of r)l.line(this.view,o,n)}}for(let s of r)s.finish();i&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(i){let e=i.startState.facet(dr),t=i.state.facet(dr),n=i.docChanged||i.heightChanged||i.viewportChanged||!H.eq(i.startState.facet(Vs),i.state.facet(Vs),i.view.viewport.from,i.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(i)&&(n=!0);else{n=!0;let r=[];for(let s of t){let o=e.indexOf(s);o<0?r.push(new io(this.view,s)):(this.gutters[o].update(i),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove()}},{provide:i=>R.scrollMargins.of(e=>{let t=e.plugin(i);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ce.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function xd(i){return Array.isArray(i)?i:[i]}function Ep(i,e,t){for(;i.value&&i.from<=t;)i.from==t&&e.push(i.value),i.next()}var gh=class{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=H.iter(e.markers,t.from)}line(e,t,n){let r=[];Ep(this.cursor,r,t.from),n.length&&(r=r.concat(n));let s=this.gutter.config.lineMarker(e,t,r);s&&r.unshift(s);let o=this.gutter;if(r.length==0&&!o.config.renderEmptyElements)return;let l=t.top-this.height;if(this.i==o.elements.length){let a=new ro(e,t.height,l,r);o.elements.push(a),o.dom.appendChild(a.dom)}else o.elements[this.i].update(e,t.height,l,r);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}},io=class{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=r.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[n](e,l,r)&&r.preventDefault()});this.markers=xd(t.markers(e)),t.initialSpacer&&(this.spacer=new ro(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=xd(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!H.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}},ro=class{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Rb(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,h=!1;if(a){let c=a.elementClass;c&&(n+=" "+c);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(a)){l=u,h=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(r);let u=r.nextSibling;r.remove(),r=u}}if(!a)break;a.toDOM&&(h?r=r.nextSibling:this.dom.insertBefore(a.toDOM(e),r)),h&&o++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}};function Rb(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].compare(e[t]))return!1;return!0}var Mb=M.define(),mi=M.define({combine(i){return Ve(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let r in t){let s=n[r],o=t[r];n[r]=s?(l,a,h)=>s(l,a,h)||o(l,a,h):o}return n}})}}),pr=class extends rt{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}};function Ca(i,e){return i.state.facet(mi).formatNumber(e,i.state)}var Db=dr.compute([mi],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Mb)},lineMarker(e,t,n){return n.some(r=>r.toDOM)?null:new pr(Ca(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(mi)!=e.state.facet(mi),initialSpacer(e){return new pr(Ca(e,Pd(e.state.doc.lines)))},updateSpacer(e,t){let n=Ca(t.view,Pd(t.view.state.doc.lines));return n==e.number?e:new pr(n)},domEventHandlers:i.facet(mi).domEventHandlers}));function Wp(i={}){return[mi.of(i),Cp(),Db]}function Pd(i){let e=9;for(;e<i;)e=e*10+9;return e}var Lb=new class extends rt{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},qb=Vs.compute(["selection"],i=>{let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.head).from;r>t&&(t=r,e.push(Lb.range(r)))}return H.of(e)});function Qp(){return qb}var Bb=0,Pr=class{constructor(e,t){this.from=e,this.to=t}},Y=class{constructor(e={}){this.id=Bb++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Re.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};Y.closedBy=new Y({deserialize:i=>i.split(" ")});Y.openedBy=new Y({deserialize:i=>i.split(" ")});Y.group=new Y({deserialize:i=>i.split(" ")});Y.contextHash=new Y({perNode:!0});Y.lookAhead=new Y({perNode:!0});Y.mounted=new Y({perNode:!0});var Zb=Object.create(null),Re=class{constructor(e,t,n,r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Zb,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new Re(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Y.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return n=>{for(let r=n.prop(Y.group),s=-1;s<(r?r.length:0);s++){let o=t[s<0?n.name:r[s]];if(o)return o}}}};Re.none=new Re("",Object.create(null),0,8);var Un=class{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let s of e){let o=s(n);o&&(r||(r=Object.assign({},n.props)),r[o[0].id]=o[1])}t.push(r?new Re(n.name,r,n.id,n.flags):n)}return new Un(t)}},lo=new WeakMap,Rp=new WeakMap,we;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(we||(we={}));var fe=class{constructor(e,t,n,r,s){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=this.prop(Y.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let r=n.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new vi(this.topNode,e)}cursorAt(e,t=0,n=0){let r=lo.get(this)||this.topNode,s=new vi(r);return s.moveTo(e,t),lo.set(this,s._tree),s}get topNode(){return new st(this,0,0,null)}resolve(e,t=0){let n=Pi(lo.get(this)||this.topNode,e,t,!1);return lo.set(this,n),n}resolveInner(e,t=0){let n=Pi(Rp.get(this)||this.topNode,e,t,!0);return Rp.set(this,n),n}iterate(e){let{enter:t,leave:n,from:r=0,to:s=this.length}=e;for(let o=this.cursor((e.mode||0)|we.IncludeAnonymous);;){let l=!1;if(o.from<=s&&o.to>=r&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;l=!0}for(;l&&n&&!o.type.isAnonymous&&n(o),!o.nextSibling();){if(!o.parent())return;l=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:_h(Re.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,r)=>new fe(this.type,t,n,r,this.propValues),e.makeTree||((t,n,r)=>new fe(Re.none,t,n,r)))}static build(e){return Vb(e)}};fe.empty=new fe(Re.none,[],[],0);var vr=class{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new vr(this.buffer,this.index)}},Jt=class{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Re.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,n,r,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(Dp(s,r,o[a+1],o[a+2])&&(l=a,n>0));a=o[a+3]);return l}slice(e,t,n){let r=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=r[l++],s[a++]=r[l++]-n;let h=s[a++]=r[l++]-n;s[a++]=r[l++]-e,o=Math.max(o,h)}return new Jt(s,o,this.set)}};function Dp(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Lp(i,e){let t=i.childBefore(e);for(;t;){let n=t.lastChild;if(!n||n.to!=t.to)break;n.type.isError&&n.from==n.to?(i=t,t=n.prevSibling):t=n}return i}function Pi(i,e,t,n){for(var r;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let o=!n&&i instanceof st&&i.index<0?null:i.parent;if(!o)return i;i=o}let s=n?0:we.IgnoreOverlays;if(n)for(let o=i,l=o.parent;l;o=l,l=o.parent)o instanceof st&&o.index<0&&((r=l.enter(e,t,s))===null||r===void 0?void 0:r.from)!=o.from&&(i=l);for(;;){let o=i.enter(e,t,s);if(!o)return i;i=o}}var st=class{constructor(e,t,n,r){this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,r,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,h=t>0?l.length:-1;e!=h;e+=t){let c=l[e],u=a[e]+o.from;if(Dp(r,n,u,u+c.length)){if(c instanceof Jt){if(s&we.ExcludeBuffers)continue;let m=c.findChild(0,c.buffer.length,t,n-u,r);if(m>-1)return new mt(new xh(o,c,e,u),null,m)}else if(s&we.IncludeAnonymous||!c.type.isAnonymous||vh(c)){let m;if(!(s&we.IgnoreMounts)&&c.props&&(m=c.prop(Y.mounted))&&!m.overlay)return new st(m.tree,u,e,o);let g=new st(c,u,e,o);return s&we.IncludeAnonymous||!g.type.isAnonymous?g:g.nextChild(t<0?c.children.length-1:0,t,n,r)}}}if(s&we.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let r;if(!(n&we.IgnoreOverlays)&&(r=this._tree.prop(Y.mounted))&&r.overlay){let s=e-this.from;for(let{from:o,to:l}of r.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new st(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new vi(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return Pi(this,e,t,!1)}resolveInner(e,t=0){return Pi(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Lp(this,e)}getChild(e,t=null,n=null){let r=ho(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return ho(this,e,t,n)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return co(this,e)}};function ho(i,e,t,n){let r=i.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(;!r.type.is(t);)if(!r.nextSibling())return s}for(;;){if(n!=null&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return n==null?s:[]}}function co(i,e,t=e.length-1){for(let n=i.parent;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}var xh=class{constructor(e,t,n,r){this.parent=e,this.buffer=t,this.index=n,this.start=r}},mt=class{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new mt(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&we.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new mt(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new mt(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new mt(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new vi(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,s=n.buffer[this.index+3];if(s>r){let o=n.buffer[this.index+1];e.push(n.slice(r,s,o)),t.push(0)}return new fe(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Pi(this,e,t,!1)}resolveInner(e,t=0){return Pi(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Lp(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,n=null){let r=ho(this,e,t,n);return r.length?r[0]:null}getChildren(e,t=null,n=null){return ho(this,e,t,n)}get node(){return this}matchContext(e){return co(this,e)}},vi=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof st)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof st?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&we.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&we.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&we.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let s=t+e,o=e<0?-1:n._tree.children.length;s!=o;s+=e){let l=n._tree.children[s];if(this.mode&we.IncludeAnonymous||l instanceof Jt||!l.type.isAnonymous||vh(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==r){if(r==this.index)return o;t=o,n=s+1;break e}r=this.stack[--s]}for(let r=n;r<this.stack.length;r++)t=new mt(this.buffer,t,this.stack[r]);return this.bufferNode=new mt(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;r&&t&&t(this),r=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return co(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return co(this.node,e,r);let o=n[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[r]&&e[r]!=o.name)return!1;r--}}return!0}};function vh(i){return i.children.some(e=>e instanceof Jt||!e.type.isAnonymous||vh(e))}function Vb(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:r=1024,reused:s=[],minRepeatType:o=n.types.length}=i,l=Array.isArray(t)?new vr(t,t.length):t,a=n.types,h=0,c=0;function u(I,E,W,Z,te){let{id:U,start:F,end:K,size:be}=l,Ee=c;for(;be<0;)if(l.next(),be==-1){let Be=s[U];W.push(Be),Z.push(F-I);return}else if(be==-3){h=U;return}else if(be==-4){c=U;return}else throw new RangeError(`Unrecognized record size: ${be}`);let qe=a[U],Te,We,ht=F-I;if(K-F<=r&&(We=P(l.pos-E,te))){let Be=new Uint16Array(We.size-We.skip),ge=l.pos-We.size,Pe=Be.length;for(;l.pos>ge;)Pe=x(We.start,Be,Pe);Te=new Jt(Be,K-We.start,n),ht=We.start-I}else{let Be=l.pos-be;l.next();let ge=[],Pe=[],Nt=U>=o?U:-1,tn=0,Cn=K;for(;l.pos>Be;)Nt>=0&&l.id==Nt&&l.size>=0?(l.end<=Cn-r&&(g(ge,Pe,F,tn,l.end,Cn,Nt,Ee),tn=ge.length,Cn=l.end),l.next()):u(F,Be,ge,Pe,Nt);if(Nt>=0&&tn>0&&tn<ge.length&&g(ge,Pe,F,tn,F,Cn,Nt,Ee),ge.reverse(),Pe.reverse(),Nt>-1&&tn>0){let Yr=m(qe);Te=_h(qe,ge,Pe,0,ge.length,0,K-F,Yr,Yr)}else Te=y(qe,ge,Pe,K-F,Ee-K)}W.push(Te),Z.push(ht)}function m(I){return(E,W,Z)=>{let te=0,U=E.length-1,F,K;if(U>=0&&(F=E[U])instanceof fe){if(!U&&F.type==I&&F.length==Z)return F;(K=F.prop(Y.lookAhead))&&(te=W[U]+F.length+K)}return y(I,E,W,Z,te)}}function g(I,E,W,Z,te,U,F,K){let be=[],Ee=[];for(;I.length>Z;)be.push(I.pop()),Ee.push(E.pop()+W-te);I.push(y(n.types[F],be,Ee,U-te,K-U)),E.push(te-W)}function y(I,E,W,Z,te=0,U){if(h){let F=[Y.contextHash,h];U=U?[F].concat(U):[F]}if(te>25){let F=[Y.lookAhead,te];U=U?[F].concat(U):[F]}return new fe(I,E,W,Z,U)}function P(I,E){let W=l.fork(),Z=0,te=0,U=0,F=W.end-r,K={size:0,start:0,skip:0};e:for(let be=W.pos-I;W.pos>be;){let Ee=W.size;if(W.id==E&&Ee>=0){K.size=Z,K.start=te,K.skip=U,U+=4,Z+=4,W.next();continue}let qe=W.pos-Ee;if(Ee<0||qe<be||W.start<F)break;let Te=W.id>=o?4:0,We=W.start;for(W.next();W.pos>qe;){if(W.size<0)if(W.size==-3)Te+=4;else break e;else W.id>=o&&(Te+=4);W.next()}te=We,Z+=Ee,U+=Te}return(E<0||Z==I)&&(K.size=Z,K.start=te,K.skip=U),K.size>4?K:void 0}function x(I,E,W){let{id:Z,start:te,end:U,size:F}=l;if(l.next(),F>=0&&Z<o){let K=W;if(F>4){let be=l.pos-(F-4);for(;l.pos>be;)W=x(I,E,W)}E[--W]=K,E[--W]=U-I,E[--W]=te-I,E[--W]=Z}else F==-3?h=Z:F==-4&&(c=Z);return W}let k=[],Q=[];for(;l.pos>0;)u(i.start||0,i.bufferStart||0,k,Q,-1);let D=(e=i.length)!==null&&e!==void 0?e:k.length?Q[0]+k[0].length:0;return new fe(a[i.topID],k.reverse(),Q.reverse(),D)}var Mp=new WeakMap;function ao(i,e){if(!i.isAnonymous||e instanceof Jt||e.type!=i)return 1;let t=Mp.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof fe)){t=1;break}t+=ao(i,n)}Mp.set(e,t)}return t}function _h(i,e,t,n,r,s,o,l,a){let h=0;for(let y=n;y<r;y++)h+=ao(i,e[y]);let c=Math.ceil(h*1.5/8),u=[],m=[];function g(y,P,x,k,Q){for(let D=x;D<k;){let I=D,E=P[D],W=ao(i,y[D]);for(D++;D<k;D++){let Z=ao(i,y[D]);if(W+Z>=c)break;W+=Z}if(D==I+1){if(W>c){let Z=y[I];g(Z.children,Z.positions,0,Z.children.length,P[I]+Q);continue}u.push(y[I])}else{let Z=P[D-1]+y[D-1].length-E;u.push(_h(i,y,P,I,D,E,Z,null,a))}m.push(E+Q-s)}}return g(e,t,n,r,0),(l||a)(u,m,o)}var fo=class{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof mt?this.setBuffer(e.context.buffer,e.index,t):e instanceof st&&this.map.set(e.tree,t)}get(e){return e instanceof mt?this.getBuffer(e.context.buffer,e.index):e instanceof st?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},Lt=class{constructor(e,t,n,r,s=!1,o=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let r=[new Lt(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e,t,n=128){if(!t.length)return e;let r=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,h=0;;l++){let c=l<t.length?t[l]:null,u=c?c.fromA:1e9;if(u-a>=n)for(;o&&o.from<u;){let m=o;if(a>=m.from||u<=m.to||h){let g=Math.max(m.from,a)-h,y=Math.min(m.to,u)-h;m=g>=y?null:new Lt(g,y,m.tree,m.offset+h,l>0,!!c)}if(m&&r.push(m),o.to>u)break;o=s<e.length?e[s++]:null}if(!c)break;a=c.toA,h=c.toA-c.toB}return r}},_i=class{startParse(e,t,n){return typeof e=="string"&&(e=new Ph(e)),n=n?n.length?n.map(r=>new Pr(r.from,r.to)):[new Pr(0,0)]:[new Pr(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let r=this.startParse(e,t,n);for(;;){let s=r.advance();if(s)return s}}},Ph=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};var g_=new Y({perNode:!0});var Yb=0,gt=class{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=Yb++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let t=new gt([],null,[]);if(t.set.push(t),e)for(let n of e.set)t.set.push(n);return t}static defineModifier(){let e=new $i;return t=>t.modified.indexOf(e)>-1?t:$i.get(t.base||t,t.modified.concat(e).sort((n,r)=>n.id-r.id))}},Nb=0,$i=class{constructor(){this.instances=[],this.id=Nb++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(l=>l.base==e&&Ub(t,l.modified));if(n)return n;let r=[],s=new gt(r,e,t);for(let l of t)l.instances.push(s);let o=Fb(t);for(let l of e.set)if(!l.modified.length)for(let a of o)r.push($i.get(l,a));return s}};function Ub(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function Fb(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,r=e.length;n<r;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function go(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let r of t.split(" "))if(r){let s=[],o=2,l=r;for(let u=0;;){if(l=="..."&&u>0&&u+3==r.length){o=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!m)throw new RangeError("Invalid path: "+r);if(s.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),u+=m[0].length,u==r.length)break;let g=r[u++];if(u==r.length&&g=="!"){o=0;break}if(g!="/")throw new RangeError("Invalid path: "+r);l=r.slice(u)}let a=s.length-1,h=s[a];if(!h)throw new RangeError("Invalid path: "+r);let c=new Ti(n,o,a>0?s.slice(0,a):null);e[h]=c.sort(e[h])}}return Zp.add(e)}var Zp=new Y,Ti=class{constructor(e,t,n,r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};Ti.empty=new Ti([],2,null);function Ih(i,e){let t=Object.create(null);for(let s of i)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:n,all:r=null}=e||{};return{style:s=>{let o=r;for(let l of s)for(let a of l.set){let h=t[a.id];if(h){o=o?o+" "+h:h;break}}return o},scope:n}}function jb(i,e){let t=null;for(let n of i){let r=n.style(e);r&&(t=t?t+" "+r:r)}return t}function Vp(i,e,t,n=0,r=i.length){let s=new Th(n,Array.isArray(e)?e:[e],t);s.highlightRange(i.cursor(),n,r,"",s.highlighters),s.flush(r)}var Th=class{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,r,s){let{type:o,from:l,to:a}=e;if(l>=n||a<=t)return;o.isTop&&(s=this.highlighters.filter(g=>!g.scope||g.scope(o)));let h=r,c=Xb(e)||Ti.empty,u=jb(s,c.tags);if(u&&(h&&(h+=" "),h+=u,c.mode==1&&(r+=(r?" ":"")+u)),this.startSpan(e.from,h),c.opaque)return;let m=e.tree&&e.tree.prop(Y.mounted);if(m&&m.overlay){let g=e.node.enter(m.overlay[0].from+l,1),y=this.highlighters.filter(x=>!x.scope||x.scope(m.tree.type)),P=e.firstChild();for(let x=0,k=l;;x++){let Q=x<m.overlay.length?m.overlay[x]:null,D=Q?Q.from+l:a,I=Math.max(t,k),E=Math.min(n,D);if(I<E&&P)for(;e.from<E&&(this.highlightRange(e,I,E,r,s),this.startSpan(Math.min(E,e.to),h),!(e.to>=D||!e.nextSibling())););if(!Q||D>n)break;k=Q.to+l,k>t&&(this.highlightRange(g.cursor(),Math.max(t,Q.from+l),Math.min(n,k),r,y),this.startSpan(k,h))}P&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,s),this.startSpan(Math.min(n,e.to),h)}while(e.nextSibling());e.parent()}}};function Xb(i){let e=i.type.prop(Zp);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}var C=gt.define,uo=C(),mn=C(),qp=C(mn),Bp=C(mn),gn=C(),po=C(gn),$h=C(gn),Zt=C(),Fn=C(Zt),qt=C(),Bt=C(),kh=C(),_r=C(kh),mo=C(),w={comment:uo,lineComment:C(uo),blockComment:C(uo),docComment:C(uo),name:mn,variableName:C(mn),typeName:qp,tagName:C(qp),propertyName:Bp,attributeName:C(Bp),className:C(mn),labelName:C(mn),namespace:C(mn),macroName:C(mn),literal:gn,string:po,docString:C(po),character:C(po),attributeValue:C(po),number:$h,integer:C($h),float:C($h),bool:C(gn),regexp:C(gn),escape:C(gn),color:C(gn),url:C(gn),keyword:qt,self:C(qt),null:C(qt),atom:C(qt),unit:C(qt),modifier:C(qt),operatorKeyword:C(qt),controlKeyword:C(qt),definitionKeyword:C(qt),moduleKeyword:C(qt),operator:Bt,derefOperator:C(Bt),arithmeticOperator:C(Bt),logicOperator:C(Bt),bitwiseOperator:C(Bt),compareOperator:C(Bt),updateOperator:C(Bt),definitionOperator:C(Bt),typeOperator:C(Bt),controlOperator:C(Bt),punctuation:kh,separator:C(kh),bracket:_r,angleBracket:C(_r),squareBracket:C(_r),paren:C(_r),brace:C(_r),content:Zt,heading:Fn,heading1:C(Fn),heading2:C(Fn),heading3:C(Fn),heading4:C(Fn),heading5:C(Fn),heading6:C(Fn),contentSeparator:C(Zt),list:C(Zt),quote:C(Zt),emphasis:C(Zt),strong:C(Zt),link:C(Zt),monospace:C(Zt),strikethrough:C(Zt),inserted:C(),deleted:C(),changed:C(),invalid:C(),meta:mo,documentMeta:C(mo),annotation:C(mo),processingInstruction:C(mo),definition:gt.defineModifier(),constant:gt.defineModifier(),function:gt.defineModifier(),standard:gt.defineModifier(),local:gt.defineModifier(),special:gt.defineModifier()},S_=Ih([{tag:w.link,class:"tok-link"},{tag:w.heading,class:"tok-heading"},{tag:w.emphasis,class:"tok-emphasis"},{tag:w.strong,class:"tok-strong"},{tag:w.keyword,class:"tok-keyword"},{tag:w.atom,class:"tok-atom"},{tag:w.bool,class:"tok-bool"},{tag:w.url,class:"tok-url"},{tag:w.labelName,class:"tok-labelName"},{tag:w.inserted,class:"tok-inserted"},{tag:w.deleted,class:"tok-deleted"},{tag:w.literal,class:"tok-literal"},{tag:w.string,class:"tok-string"},{tag:w.number,class:"tok-number"},{tag:[w.regexp,w.escape,w.special(w.string)],class:"tok-string2"},{tag:w.variableName,class:"tok-variableName"},{tag:w.local(w.variableName),class:"tok-variableName tok-local"},{tag:w.definition(w.variableName),class:"tok-variableName tok-definition"},{tag:w.special(w.variableName),class:"tok-variableName2"},{tag:w.definition(w.propertyName),class:"tok-propertyName tok-definition"},{tag:w.typeName,class:"tok-typeName"},{tag:w.namespace,class:"tok-namespace"},{tag:w.className,class:"tok-className"},{tag:w.macroName,class:"tok-macroName"},{tag:w.propertyName,class:"tok-propertyName"},{tag:w.operator,class:"tok-operator"},{tag:w.comment,class:"tok-comment"},{tag:w.meta,class:"tok-meta"},{tag:w.invalid,class:"tok-invalid"},{tag:w.punctuation,class:"tok-punctuation"}]);var Ah,ki=new Y;function zb(i){return M.define({combine:i?e=>e.concat(i):void 0})}var Hb=new Y,ot=class{constructor(e,t,n=[],r=""){this.data=e,this.name=r,j.prototype.hasOwnProperty("tree")||Object.defineProperty(j.prototype,"tree",{get(){return xe(this)}}),this.parser=t,this.extension=[yn.of(this),j.languageData.of((s,o,l)=>{let a=Yp(s,o,l),h=a.type.prop(ki);if(!h)return[];let c=s.facet(h),u=a.type.prop(Hb);if(u){let m=a.resolve(o-a.from,l);for(let g of u)if(g.test(m,s)){let y=s.facet(g.facet);return g.type=="replace"?y:y.concat(c)}}return c})].concat(n)}isActiveAt(e,t,n=-1){return Yp(e,t,n).type.prop(ki)==this.data}findRegions(e){let t=e.facet(yn);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],r=(s,o)=>{if(s.prop(ki)==this.data){n.push({from:o,to:o+s.length});return}let l=s.prop(Y.mounted);if(l){if(l.tree.prop(ki)==this.data){if(l.overlay)for(let a of l.overlay)n.push({from:a.from+o,to:a.to+o});else n.push({from:o,to:o+s.length});return}else if(l.overlay){let a=n.length;if(r(l.tree,l.overlay[0].from+o),n.length>a)return}}for(let a=0;a<s.children.length;a++){let h=s.children[a];h instanceof fe&&r(h,s.positions[a]+o)}};return r(xe(e),0),n}get allowsNesting(){return!0}};ot.setState=V.define();function Yp(i,e,t){let n=i.facet(yn),r=xe(i).topNode;if(!n||n.allowsNesting)for(let s=r;s;s=s.enter(e,t,we.ExcludeBuffers))s.type.isTop&&(r=s);return r}var jn=class extends ot{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=zb(e.languageData);return new jn(t,e.parser.configure({props:[ki.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new jn(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function xe(i){let e=i.field(ot.state,!1);return e?e.tree:fe.empty}var Qh=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},$r=null,Ii=class{constructor(e,t,n=[],r,s,o,l,a){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Ii(e,t,[],fe.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Qh(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=fe.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Lt.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Lt.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=$r;$r=this;try{return e()}finally{$r=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Np(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((h,c,u,m)=>a.push({fromA:h,toA:c,fromB:u,toB:m})),n=Lt.applyChanges(n,a),r=fe.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let h of this.skipped){let c=e.mapPos(h.from,1),u=e.mapPos(h.to,-1);c<u&&l.push({from:c,to:u})}}}return new Ii(this.parser,t,n,r,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:r,to:s}=this.skipped[n];r<e.to&&s>e.from&&(this.fragments=Np(this.fragments,r,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends _i{createParse(t,n,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let a=$r;if(a){for(let h of r)a.tempSkipped.push(h);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new fe(Re.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return $r}};function Np(i,e,t){return Lt.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}var On=class{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new On(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=Ii.create(e.facet(yn).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new On(n)}};ot.state=le.define({create:On.init,update(i,e){for(let t of e.effects)if(t.is(ot.setState))return t.value;return e.startState.facet(yn)!=e.state.facet(yn)?On.init(e.state):i.apply(e)}});var Xp=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Xp=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});var Ch=typeof navigator<"u"&&(!((Ah=navigator.scheduling)===null||Ah===void 0)&&Ah.isInputPending)?()=>navigator.scheduling.isInputPending():null,Gb=ae.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(ot.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(ot.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=Xp(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,s=n.field(ot.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Ch?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<r&&n.doc.length>r+1e3,a=s.context.work(()=>Ch&&Ch()||Date.now()>o,r+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ot.setState.of(new On(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Ye(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yn=M.define({combine(i){return i.length?i[0]:null},enables:i=>[ot.state,Gb,R.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]}),Oo=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}};var Jb=M.define(),bn=M.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function Ir(i){let e=i.facet(bn);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Ai(i,e){let t="",n=i.tabSize,r=i.facet(bn)[0];if(r=="	"){for(;e>=n;)t+="	",e-=n;r=" "}for(let s=0;s<e;s++)t+=r;return t}function bo(i,e){i instanceof j&&(i=new Xn(i));for(let n of i.state.facet(Jb)){let r=n(i,e);if(r!==void 0)return r}let t=xe(i.state);return t?Kb(i,t,e):null}var Xn=class{constructor(e,t={}){this.state=e,this.options=t,this.unit=Ir(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=n.from&&r<=n.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.countColumn(n,e-r),o=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return o>-1&&(s+=o-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,t=e.length){return hn(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(r);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},qh=new Y;function Kb(i,e,t){return zp(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,i)}function ew(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function tw(i){let e=i.type.prop(qh);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(Y.closedBy))){let r=i.lastChild,s=r&&n.indexOf(r.name)>-1;return o=>Hp(o,!0,1,void 0,s&&!ew(o)?r.from:void 0)}return i.parent==null?nw:null}function zp(i,e,t){for(;i;i=i.parent){let n=tw(i);if(n)return n(kr.create(t,e,i))}return null}function nw(){return 0}var kr=class extends Xn{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.node=n}static create(e,t,n){return new kr(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(iw(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?zp(e,this.pos,this.base):0}};function iw(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function rw(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let r=i.options.simulateBreak,s=i.state.doc.lineAt(t.from),o=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==n)return null;if(!a.type.isSkipped)return a.from<o?t:null;l=a.to}}function wo({closing:i,align:e=!0,units:t=1}){return n=>Hp(n,e,t,i)}function Hp(i,e,t,n,r){let s=i.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==i.pos+o,a=e?rw(i):null;return a?l?i.column(a.from):i.column(a.to):i.baseIndent+(l?0:i.unit*t)}var sw=200;function Gp(){return j.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,r=t.lineAt(n);if(n>r.from+sw)return i;let s=t.sliceString(r.from,n);if(!e.some(h=>h.test(s)))return i;let{state:o}=i,l=-1,a=[];for(let{head:h}of o.selection.ranges){let c=o.doc.lineAt(h);if(c.from==l)continue;l=c.from;let u=bo(o,c.from);if(u==null)continue;let m=/^\s*/.exec(c.text)[0],g=Ai(o,u);m!=g&&a.push({from:c.from,to:c.from+m.length,insert:g})}return a.length?[i,{changes:a,sequential:!0}]:i})}var ow=M.define(),Bh=new Y;function Jp(i){let e=i.firstChild,t=i.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?i.to:t.from}:null}function lw(i,e,t){let n=xe(i);if(n.length<t)return null;let r=n.resolveInner(t,1),s=null;for(let o=r;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let l=o.type.prop(Bh);if(l&&(o.to<n.length-50||n.length==i.doc.length||!aw(o))){let a=l(o,i);a&&a.from<=t&&a.from>=e&&a.to>t&&(s=a)}}return s}function aw(i){let e=i.lastChild;return e&&e.to==i.to&&e.type.isError}function yo(i,e,t){for(let n of i.facet(ow)){let r=n(i,e,t);if(r)return r}return lw(i,e,t)}function Kp(i,e){let t=e.mapPos(i.from,1),n=e.mapPos(i.to,-1);return t>=n?void 0:{from:t,to:n}}var xo=V.define({map:Kp}),Ar=V.define({map:Kp});function em(i){let e=[];for(let{head:t}of i.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(i.lineBlockAt(t));return e}var zn=le.define({create(){return q.none},update(i,e){i=i.map(e.changes);for(let t of e.effects)t.is(xo)&&!hw(i,t.value.from,t.value.to)?i=i.update({add:[Up.range(t.value.from,t.value.to)]}):t.is(Ar)&&(i=i.update({filter:(n,r)=>t.value.from!=n||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;i.between(n,n,(r,s)=>{r<n&&s>n&&(t=!0)}),t&&(i=i.update({filterFrom:n,filterTo:n,filter:(r,s)=>s<=n||r>=n}))}return i},provide:i=>R.decorations.from(i),toJSON(i,e){let t=[];return i.between(0,e.doc.length,(n,r)=>{t.push(n,r)}),t},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<i.length;){let n=i[t++],r=i[t++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(Up.range(n,r))}return q.set(e,!0)}});function So(i,e,t){var n;let r=null;return(n=i.field(zn,!1))===null||n===void 0||n.between(e,t,(s,o)=>{(!r||r.from>s)&&(r={from:s,to:o})}),r}function hw(i,e,t){let n=!1;return i.between(e,e,(r,s)=>{r==e&&s==t&&(n=!0)}),n}function tm(i,e){return i.field(zn,!1)?e:e.concat(V.appendConfig.of(sm()))}var cw=i=>{for(let e of em(i)){let t=yo(i.state,e.from,e.to);if(t)return i.dispatch({effects:tm(i.state,[xo.of(t),nm(i,t)])}),!0}return!1},fw=i=>{if(!i.state.field(zn,!1))return!1;let e=[];for(let t of em(i)){let n=So(i.state,t.from,t.to);n&&e.push(Ar.of(n),nm(i,n,!1))}return e.length&&i.dispatch({effects:e}),e.length>0};function nm(i,e,t=!0){let n=i.state.doc.lineAt(e.from).number,r=i.state.doc.lineAt(e.to).number;return R.announce.of(`${i.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${r}.`)}var uw=i=>{let{state:e}=i,t=[];for(let n=0;n<e.doc.length;){let r=i.lineBlockAt(n),s=yo(e,r.from,r.to);s&&t.push(xo.of(s)),n=(s?i.lineBlockAt(s.to):r).to+1}return t.length&&i.dispatch({effects:tm(i.state,t)}),!!t.length},dw=i=>{let e=i.state.field(zn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,i.state.doc.length,(n,r)=>{t.push(Ar.of({from:n,to:r}))}),i.dispatch({effects:t}),!0};var im=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:cw},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:fw},{key:"Ctrl-Alt-[",run:uw},{key:"Ctrl-Alt-]",run:dw}],pw={placeholderDOM:null,placeholderText:"\u2026"},rm=M.define({combine(i){return Ve(i,pw)}});function sm(i){let e=[zn,gw];return i&&e.push(rm.of(i)),e}var Up=q.replace({widget:new class extends et{toDOM(i){let{state:e}=i,t=e.facet(rm),n=s=>{let o=i.lineBlockAt(i.posAtDOM(s.target)),l=So(i.state,o.from,o.to);l&&i.dispatch({effects:Ar.of(l)}),s.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(i,n);let r=document.createElement("span");return r.textContent=t.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=n,r}}}),mw={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},Tr=class extends rt{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}};function om(i={}){let e=Object.assign(Object.assign({},mw),i),t=new Tr(e,!0),n=new Tr(e,!1),r=ae.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(yn)!=o.state.facet(yn)||o.startState.field(zn,!1)!=o.state.field(zn,!1)||xe(o.startState)!=xe(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new nt;for(let a of o.viewportLineBlocks){let h=So(o.state,a.from,a.to)?n:yo(o.state,a.from,a.to)?t:null;h&&l.add(a.from,a.from,h)}return l.finish()}}),{domEventHandlers:s}=e;return[r,wh({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(r))===null||l===void 0?void 0:l.markers)||H.empty},initialSpacer(){return new Tr(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let h=So(o.state,l.from,l.to);if(h)return o.dispatch({effects:Ar.of(h)}),!0;let c=yo(o.state,l.from,l.to);return c?(o.dispatch({effects:xo.of(c)}),!0):!1}})}),sm()]}var gw=R.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),Sn=class{constructor(e,t){this.specs=e;let n;function r(l){let a=ut.newName();return(n||(n=Object.create(null)))["."+a]=l,a}let s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,o=t.scope;this.scope=o instanceof ot?l=>l.prop(ki)==o.data:o?l=>l==o:void 0,this.style=Ih(e.map(l=>({tag:l.tag,class:l.class||r(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=n?new ut(n):null,this.themeType=t.themeType}static define(e,t){return new Sn(e,t||{})}},Rh=M.define(),lm=M.define({combine(i){return i.length?[i[0]]:null}});function Eh(i){let e=i.facet(Rh);return e.length?e:i.facet(lm)}function Zh(i,e){let t=[Ow],n;return i instanceof Sn&&(i.module&&t.push(R.styleModule.of(i.module)),n=i.themeType),e?.fallback?t.push(lm.of(i)):n?t.push(Rh.computeN([R.darkTheme],r=>r.facet(R.darkTheme)==(n=="dark")?[i]:[])):t.push(Rh.of(i)),t}var Mh=class{constructor(e){this.markCache=Object.create(null),this.tree=xe(e.state),this.decorations=this.buildDeco(e,Eh(e.state))}update(e){let t=xe(e.state),n=Eh(e.state),r=n!=Eh(e.startState);t.length<e.view.viewport.to&&!r&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n))}buildDeco(e,t){if(!t||!this.tree.length)return q.none;let n=new nt;for(let{from:r,to:s}of e.visibleRanges)Vp(this.tree,t,(o,l,a)=>{n.add(o,l,this.markCache[a]||(this.markCache[a]=q.mark({class:a})))},r,s);return n.finish()}},Ow=_t.high(ae.fromClass(Mh,{decorations:i=>i.decorations})),am=Sn.define([{tag:w.meta,color:"#404740"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,textDecoration:"underline",fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strong,fontWeight:"bold"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.keyword,color:"#708"},{tag:[w.atom,w.bool,w.url,w.contentSeparator,w.labelName],color:"#219"},{tag:[w.literal,w.inserted],color:"#164"},{tag:[w.string,w.deleted],color:"#a11"},{tag:[w.regexp,w.escape,w.special(w.string)],color:"#e40"},{tag:w.definition(w.variableName),color:"#00f"},{tag:w.local(w.variableName),color:"#30a"},{tag:[w.typeName,w.namespace],color:"#085"},{tag:w.className,color:"#167"},{tag:[w.special(w.variableName),w.macroName],color:"#256"},{tag:w.definition(w.propertyName),color:"#00c"},{tag:w.comment,color:"#940"},{tag:w.invalid,color:"#f00"}]),yw=R.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),hm=1e4,cm="()[]{}",fm=M.define({combine(i){return Ve(i,{afterCursor:!0,brackets:cm,maxScanDistance:hm,renderMatch:ww})}}),Sw=q.mark({class:"cm-matchingBracket"}),bw=q.mark({class:"cm-nonmatchingBracket"});function ww(i){let e=[],t=i.matched?Sw:bw;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}var xw=le.define({create(){return q.none},update(i,e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(fm);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=Tt(e.state,r.head,-1,n)||r.head>0&&Tt(e.state,r.head-1,1,n)||n.afterCursor&&(Tt(e.state,r.head,1,n)||r.head<e.state.doc.length&&Tt(e.state,r.head+1,-1,n));s&&(t=t.concat(n.renderMatch(s,e.state)))}return q.set(t,!0)},provide:i=>R.decorations.from(i)}),Pw=[xw,yw];function um(i={}){return[fm.of(i),Pw]}var vw=new Y;function Dh(i,e,t){let n=i.prop(e<0?Y.openedBy:Y.closedBy);if(n)return n;if(i.name.length==1){let r=t.indexOf(i.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function Lh(i){let e=i.type.prop(vw);return e?e(i.node):i}function Tt(i,e,t,n={}){let r=n.maxScanDistance||hm,s=n.brackets||cm,o=xe(i),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let h=Dh(a.type,t,s);if(h&&a.from<a.to){let c=Lh(a);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return _w(i,e,t,a,c,h,s)}}return $w(i,e,t,o,l.type,r,s)}function _w(i,e,t,n,r,s,o){let l=n.parent,a={from:r.from,to:r.to},h=0,c=l?.cursor();if(c&&(t<0?c.childBefore(n.from):c.childAfter(n.to)))do if(t<0?c.to<=n.from:c.from>=n.to){if(h==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let u=Lh(c);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(Dh(c.type,t,o))h++;else if(Dh(c.type,-t,o)){if(h==0){let u=Lh(c);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}h--}}while(t<0?c.prevSibling():c.nextSibling());return{start:a,matched:!1}}function $w(i,e,t,n,r,s,o){let l=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},c=i.doc.iterRange(e,t>0?i.doc.length:0),u=0;for(let m=0;!c.next().done&&m<=s;){let g=c.value;t<0&&(m+=g.length);let y=e+m*t;for(let P=t>0?0:g.length-1,x=t>0?g.length:-1;P!=x;P+=t){let k=o.indexOf(g[P]);if(!(k<0||n.resolveInner(y+P,1).type!=r))if(k%2==0==t>0)u++;else{if(u==1)return{start:h,end:{from:y+P,to:y+P+1},matched:k>>1==a>>1};u--}}t>0&&(m+=g.length)}return c.done?{start:h,matched:!1}:null}var Tw=Object.create(null),Fp=[Re.none];var jp=[],kw=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])kw[i]=Iw(Tw,e);function Wh(i,e){jp.indexOf(i)>-1||(jp.push(i),console.warn(e))}function Iw(i,e){let t=null;for(let s of e.split(".")){let o=i[s]||w[s];o?typeof o=="function"?t?t=o(t):Wh(s,`Modifier ${s} used at start of tag`):t?Wh(s,`Tag ${s} used as modifier`):t=o:Wh(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let n=e.replace(/ /g,"_"),r=Re.define({id:Fp.length,name:n,props:[go({[n]:t})]});return Fp.push(r),r.id}var Aw=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=Xh(i.state,t.from);return n.line?Cw(i):n.block?Ww(i):!1};function jh(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=i(e,t);return r?(n(t.update(r)),!0):!1}}var Cw=jh(Mw,0);var Ew=jh(bm,0);var Ww=jh((i,e)=>bm(i,e,Rw(e)),0);function Xh(i,e){let t=i.languageDataAt("commentTokens",e);return t.length?t[0]:{}}var Cr=50;function Qw(i,{open:e,close:t},n,r){let s=i.sliceDoc(n-Cr,n),o=i.sliceDoc(r,r+Cr),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,h=s.length-l;if(s.slice(h-e.length,h)==e&&o.slice(a,a+t.length)==t)return{open:{pos:n-l,margin:l&&1},close:{pos:r+a,margin:a&&1}};let c,u;r-n<=2*Cr?c=u=i.sliceDoc(n,r):(c=i.sliceDoc(n,n+Cr),u=i.sliceDoc(r-Cr,r));let m=/^\s*/.exec(c)[0].length,g=/\s*$/.exec(u)[0].length,y=u.length-g-t.length;return c.slice(m,m+e.length)==e&&u.slice(y,y+t.length)==t?{open:{pos:n+m+e.length,margin:/\s/.test(c.charAt(m+e.length))?1:0},close:{pos:r-g-t.length,margin:/\s/.test(u.charAt(y-1))?1:0}}:null}function Rw(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),r=t.to<=n.to?n:i.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=r.to:e.push({from:n.from,to:r.to})}return e}function bm(i,e,t=e.selection.ranges){let n=t.map(s=>Xh(e,s.from).block);if(!n.every(s=>s))return null;let r=t.map((s,o)=>Qw(e,n[o],s.from,s.to));if(i!=2&&!r.every(s=>s))return{changes:e.changes(t.map((s,o)=>r[o]?[]:[{from:s.from,insert:n[o].open+" "},{from:s.to,insert:" "+n[o].close}]))};if(i!=1&&r.some(s=>s)){let s=[];for(let o=0,l;o<r.length;o++)if(l=r[o]){let a=n[o],{open:h,close:c}=l;s.push({from:h.pos-a.open.length,to:h.pos+h.margin},{from:c.pos-c.margin,to:c.pos+a.close.length})}return{changes:s}}return null}function Mw(i,e,t=e.selection.ranges){let n=[],r=-1;for(let{from:s,to:o}of t){let l=n.length,a=1e9,h=Xh(e,s).line;if(h){for(let c=s;c<=o;){let u=e.doc.lineAt(c);if(u.from>r&&(s==o||o>u.from)){r=u.from;let m=/^\s*/.exec(u.text)[0].length,g=m==u.length,y=u.text.slice(m,m+h.length)==h?m:-1;m<u.text.length&&m<a&&(a=m),n.push({line:u,comment:y,token:h,indent:m,empty:g,single:!1})}c=u.to+1}if(a<1e9)for(let c=l;c<n.length;c++)n[c].indent<n[c].line.text.length&&(n[c].indent=a);n.length==l+1&&(n[l].single=!0)}}if(i!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:h,empty:c,single:u}of n)(u||!c)&&s.push({from:l.from+h,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(i!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of n)if(l>=0){let h=o.from+l,c=h+a.length;o.text[c-o.from]==" "&&c++,s.push({from:h,to:c})}return{changes:s}}return null}var Yh=Ke.define(),Dw=Ke.define(),Lw=M.define(),wm=M.define({combine(i){return Ve(i,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}});function qw(i){let e=0;return i.iterChangedRanges((t,n)=>e=n),e}var xm=le.define({create(){return yt.empty},update(i,e){let t=e.state.facet(wm),n=e.annotation(Yh);if(n){let a=e.docChanged?$.single(qw(e.changes)):void 0,h=Ne.fromTransaction(e,a),c=n.side,u=c==0?i.undone:i.done;return h?u=vo(u,u.length,t.minDepth,h):u=$m(u,e.startState.selection),new yt(c==0?n.rest:u,c==0?u:n.rest)}let r=e.annotation(Dw);if((r=="full"||r=="before")&&(i=i.isolate()),e.annotation(pe.addToHistory)===!1)return e.changes.empty?i:i.addMapping(e.changes.desc);let s=Ne.fromTransaction(e),o=e.annotation(pe.time),l=e.annotation(pe.userEvent);return s?i=i.addChanges(s,o,l,t,e):e.selection&&(i=i.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(r=="full"||r=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(e=>e.toJSON()),undone:i.undone.map(e=>e.toJSON())}},fromJSON(i){return new yt(i.done.map(Ne.fromJSON),i.undone.map(Ne.fromJSON))}});function Pm(i={}){return[xm,wm.of(i),R.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?vm:e.inputType=="historyRedo"?Nh:null;return n?(e.preventDefault(),n(t)):!1}})]}function _o(i,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let r=t.field(xm,!1);if(!r)return!1;let s=r.pop(i,t,e);return s?(n(s),!0):!1}}var vm=_o(0,!1),Nh=_o(1,!1),Bw=_o(0,!0),Zw=_o(1,!0);var Ne=class{constructor(e,t,n,r,s){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=s}setSelAfter(e){return new Ne(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new Ne(e.changes&&de.fromJSON(e.changes),[],e.mapped&&tt.fromJSON(e.mapped),e.startSelection&&$.fromJSON(e.startSelection),e.selectionsAfter.map($.fromJSON))}static fromTransaction(e,t){let n=Ot;for(let r of e.startState.facet(Lw)){let s=r(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new Ne(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Ot)}static selection(e){return new Ne(void 0,Ot,void 0,void 0,e)}};function vo(i,e,t,n){let r=e+1>t+20?e-t-1:0,s=i.slice(r,e);return s.push(n),s}function Vw(i,e){let t=[],n=!1;return i.iterChangedRanges((r,s)=>t.push(r,s)),e.iterChangedRanges((r,s,o,l)=>{for(let a=0;a<t.length;){let h=t[a++],c=t[a++];l>=h&&o<=c&&(n=!0)}}),n}function Yw(i,e){return i.ranges.length==e.ranges.length&&i.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function _m(i,e){return i.length?e.length?i.concat(e):i:e}var Ot=[],Nw=200;function $m(i,e){if(i.length){let t=i[i.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Nw));return n.length&&n[n.length-1].eq(e)?i:(n.push(e),vo(i,i.length-1,1e9,t.setSelAfter(n)))}else return[Ne.selection([e])]}function Uw(i){let e=i[i.length-1],t=i.slice();return t[i.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Vh(i,e){if(!i.length)return i;let t=i.length,n=Ot;for(;t;){let r=Fw(i[t-1],e,n);if(r.changes&&!r.changes.empty||r.effects.length){let s=i.slice(0,t);return s[t-1]=r,s}else e=r.mapped,t--,n=r.selectionsAfter}return n.length?[Ne.selection(n)]:Ot}function Fw(i,e,t){let n=_m(i.selectionsAfter.length?i.selectionsAfter.map(l=>l.map(e)):Ot,t);if(!i.changes)return Ne.selection(n);let r=i.changes.map(e),s=e.mapDesc(i.changes,!0),o=i.mapped?i.mapped.composeDesc(s):s;return new Ne(r,V.mapEffects(i.effects,e),o,i.startSelection.map(s),n)}var jw=/^(input\.type|delete)($|\.)/,yt=class{constructor(e,t,n=0,r=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}isolate(){return this.prevTime?new yt(this.done,this.undone):this}addChanges(e,t,n,r,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!n||jw.test(n))&&(!l.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(s,Vw(l.changes,e.changes))||n=="input.type.compose")?o=vo(o,o.length-1,r.minDepth,new Ne(e.changes.compose(l.changes),_m(e.effects,l.effects),l.mapped,l.startSelection,Ot)):o=vo(o,o.length,r.minDepth,e),new yt(o,Ot,t,n)}addSelection(e,t,n,r){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Ot;return s.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&Yw(s[s.length-1],e)?this:new yt($m(this.done,e),this.undone,t,n)}addMapping(e){return new yt(Vh(this.done,e),Vh(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let s=r[r.length-1];if(n&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Yh.of({side:e,rest:Uw(r)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=r.length==1?Ot:r.slice(0,r.length-1);return s.mapped&&(o=Vh(o,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Yh.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}};yt.empty=new yt(Ot,Ot);var Tm=[{key:"Mod-z",run:vm,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Nh,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Nh,preventDefault:!0},{key:"Mod-u",run:Bw,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Zw,preventDefault:!0}];function Ci(i,e){return $.create(i.ranges.map(e),i.mainIndex)}function Vt(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function kt({state:i,dispatch:e},t){let n=Ci(i.selection,t);return n.eq(i.selection)?!1:(e(Vt(i,n)),!0)}function $o(i,e){return $.cursor(e?i.to:i.from)}function km(i,e){return kt(i,t=>t.empty?i.moveByChar(t,e):$o(t,e))}function Ue(i){return i.textDirectionAt(i.state.selection.main.head)==ce.LTR}var Im=i=>km(i,!Ue(i)),Am=i=>km(i,Ue(i));function Cm(i,e){return kt(i,t=>t.empty?i.moveByGroup(t,e):$o(t,e))}var Xw=i=>Cm(i,!Ue(i)),zw=i=>Cm(i,Ue(i));function Hw(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function To(i,e,t){let n=xe(i).resolveInner(e.head),r=t?Y.closedBy:Y.openedBy;for(let a=e.head;;){let h=t?n.childAfter(a):n.childBefore(a);if(!h)break;Hw(i,h,r)?n=h:a=t?h.to:h.from}let s=n.type.prop(r),o,l;return s&&(o=t?Tt(i,n.from,1):Tt(i,n.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?n.to:n.from,$.cursor(l,t?-1:1)}var Gw=i=>kt(i,e=>To(i.state,e,!Ue(i))),Jw=i=>kt(i,e=>To(i.state,e,Ue(i)));function Em(i,e){return kt(i,t=>{if(!t.empty)return $o(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}var Wm=i=>Em(i,!1),Qm=i=>Em(i,!0);function Rm(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,r;if(e){for(let s of i.state.facet(R.scrollMargins)){let o=s(i);o?.top&&(t=Math.max(o?.top,t)),o?.bottom&&(n=Math.max(o?.bottom,n))}r=i.scrollDOM.clientHeight-t-n}else r=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,r-5)}}function Mm(i,e){let t=Rm(i),{state:n}=i,r=Ci(n.selection,o=>o.empty?i.moveVertically(o,e,t.height):$o(o,e));if(r.eq(n.selection))return!1;let s;if(t.selfScroll){let o=i.coordsAtPos(n.selection.main.head),l=i.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,h=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<h&&(s=R.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-a}))}return i.dispatch(Vt(n,r),{effects:s}),!0}var dm=i=>Mm(i,!1),Uh=i=>Mm(i,!0);function wn(i,e,t){let n=i.lineBlockAt(e.head),r=i.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?n.to:n.from)&&(r=i.moveToLineBoundary(e,t,!1)),!t&&r.head==n.from&&n.length){let s=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(r=$.cursor(n.from+s))}return r}var Kw=i=>kt(i,e=>wn(i,e,!0)),ex=i=>kt(i,e=>wn(i,e,!1)),tx=i=>kt(i,e=>wn(i,e,!Ue(i))),nx=i=>kt(i,e=>wn(i,e,Ue(i))),ix=i=>kt(i,e=>$.cursor(i.lineBlockAt(e.head).from,1)),rx=i=>kt(i,e=>$.cursor(i.lineBlockAt(e.head).to,-1));function sx(i,e,t){let n=!1,r=Ci(i.selection,s=>{let o=Tt(i,s.head,-1)||Tt(i,s.head,1)||s.head>0&&Tt(i,s.head-1,1)||s.head<i.doc.length&&Tt(i,s.head+1,-1);if(!o||!o.end)return s;n=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return t?$.range(s.anchor,l):$.cursor(l)});return n?(e(Vt(i,r)),!0):!1}var ox=({state:i,dispatch:e})=>sx(i,e,!1);function St(i,e){let t=Ci(i.state.selection,n=>{let r=e(n);return $.range(n.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(Vt(i.state,t)),!0)}function Dm(i,e){return St(i,t=>i.moveByChar(t,e))}var Lm=i=>Dm(i,!Ue(i)),qm=i=>Dm(i,Ue(i));function Bm(i,e){return St(i,t=>i.moveByGroup(t,e))}var lx=i=>Bm(i,!Ue(i)),ax=i=>Bm(i,Ue(i));var hx=i=>St(i,e=>To(i.state,e,!Ue(i))),cx=i=>St(i,e=>To(i.state,e,Ue(i)));function Zm(i,e){return St(i,t=>i.moveVertically(t,e))}var Vm=i=>Zm(i,!1),Ym=i=>Zm(i,!0);function Nm(i,e){return St(i,t=>i.moveVertically(t,e,Rm(i).height))}var pm=i=>Nm(i,!1),mm=i=>Nm(i,!0),fx=i=>St(i,e=>wn(i,e,!0)),ux=i=>St(i,e=>wn(i,e,!1)),dx=i=>St(i,e=>wn(i,e,!Ue(i))),px=i=>St(i,e=>wn(i,e,Ue(i))),mx=i=>St(i,e=>$.cursor(i.lineBlockAt(e.head).from)),gx=i=>St(i,e=>$.cursor(i.lineBlockAt(e.head).to)),gm=({state:i,dispatch:e})=>(e(Vt(i,{anchor:0})),!0),Om=({state:i,dispatch:e})=>(e(Vt(i,{anchor:i.doc.length})),!0),ym=({state:i,dispatch:e})=>(e(Vt(i,{anchor:i.selection.main.anchor,head:0})),!0),Sm=({state:i,dispatch:e})=>(e(Vt(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),Ox=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),yx=({state:i,dispatch:e})=>{let t=Io(i).map(({from:n,to:r})=>$.range(n,Math.min(r+1,i.doc.length)));return e(i.update({selection:$.create(t),userEvent:"select"})),!0},Sx=({state:i,dispatch:e})=>{let t=Ci(i.selection,n=>{var r;let s=xe(i).resolveInner(n.head,1);for(;!(s.from<n.from&&s.to>=n.to||s.to>n.to&&s.from<=n.from||!(!((r=s.parent)===null||r===void 0)&&r.parent));)s=s.parent;return $.range(s.to,s.from)});return e(Vt(i,t)),!0},bx=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=$.create([t.main]):t.main.empty||(n=$.create([$.cursor(t.main.head)])),n?(e(Vt(i,n)),!0):!1};function ko(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,r=n.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(o);a<o?(t="delete.backward",a=Po(i,a,!1)):a>o&&(t="delete.forward",a=Po(i,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Po(i,o,!1),l=Po(i,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:$.cursor(o)}});return r.changes.empty?!1:(i.dispatch(n.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?R.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Po(i,e,t){if(i instanceof R)for(let n of i.state.facet(R.atomicRanges).map(r=>r(i)))n.between(e,e,(r,s)=>{r<e&&s>e&&(e=t?s:r)});return e}var Um=(i,e)=>ko(i,t=>{let{state:n}=i,r=n.doc.lineAt(t),s,o;if(!e&&t>r.from&&t<r.from+200&&!/[^ \t]/.test(s=r.text.slice(0,t-r.from))){if(s[s.length-1]=="	")return t-1;let l=hn(s,n.tabSize),a=l%Ir(n)||Ir(n);for(let h=0;h<a&&s[s.length-1-h]==" ";h++)t--;o=t}else o=Qe(r.text,t-r.from,e,e)+r.from,o==t&&r.number!=(e?n.doc.lines:1)&&(o+=e?1:-1);return o}),Fh=i=>Um(i,!1),Fm=i=>Um(i,!0),jm=(i,e)=>ko(i,t=>{let n=t,{state:r}=i,s=r.doc.lineAt(n),o=r.charCategorizer(n);for(let l=null;;){if(n==(e?s.to:s.from)){n==t&&s.number!=(e?r.doc.lines:1)&&(n+=e?1:-1);break}let a=Qe(s.text,n-s.from,e)+s.from,h=s.text.slice(Math.min(n,a)-s.from,Math.max(n,a)-s.from),c=o(h);if(l!=null&&c!=l)break;(h!=" "||n!=t)&&(l=c),n=a}return n}),Xm=i=>jm(i,!1),wx=i=>jm(i,!0),zm=i=>ko(i,e=>{let t=i.lineBlockAt(e).to;return e<t?t:Math.min(i.state.doc.length,e+1)}),xx=i=>ko(i,e=>{let t=i.lineBlockAt(e).from;return e>t?t:Math.max(0,e-1)});var Px=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:X.of(["",""])},range:$.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},vx=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let r=n.from,s=i.doc.lineAt(r),o=r==s.from?r-1:Qe(s.text,r-s.from,!1)+s.from,l=r==s.to?r+1:Qe(s.text,r-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:i.doc.slice(r,l).append(i.doc.slice(o,r))},range:$.cursor(l)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Io(i){let e=[],t=-1;for(let n of i.selection.ranges){let r=i.doc.lineAt(n.from),s=i.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=i.doc.lineAt(n.to-1)),t>=r.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(n)}else e.push({from:r.from,to:s.to,ranges:[n]});t=s.number+1}return e}function Hm(i,e,t){if(i.readOnly)return!1;let n=[],r=[];for(let s of Io(i)){if(t?s.to==i.doc.length:s.from==0)continue;let o=i.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){n.push({from:s.to,to:o.to},{from:s.from,insert:o.text+i.lineBreak});for(let a of s.ranges)r.push($.range(Math.min(i.doc.length,a.anchor+l),Math.min(i.doc.length,a.head+l)))}else{n.push({from:o.from,to:s.from},{from:s.to,insert:i.lineBreak+o.text});for(let a of s.ranges)r.push($.range(a.anchor-l,a.head-l))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:$.create(r,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}var _x=({state:i,dispatch:e})=>Hm(i,e,!1),$x=({state:i,dispatch:e})=>Hm(i,e,!0);function Gm(i,e,t){if(i.readOnly)return!1;let n=[];for(let r of Io(i))t?n.push({from:r.from,insert:i.doc.slice(r.from,r.to)+i.lineBreak}):n.push({from:r.to,insert:i.lineBreak+i.doc.slice(r.from,r.to)});return e(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var Tx=({state:i,dispatch:e})=>Gm(i,e,!1),kx=({state:i,dispatch:e})=>Gm(i,e,!0),Ix=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(Io(e).map(({from:r,to:s})=>(r>0?r--:s<e.doc.length&&s++,{from:r,to:s}))),n=Ci(e.selection,r=>i.moveVertically(r,!0)).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Ax(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=xe(i).resolveInner(e),n=t.childBefore(e),r=t.childAfter(e),s;return n&&r&&n.to<=e&&r.from>=e&&(s=n.type.prop(Y.closedBy))&&s.indexOf(r.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(r.from).from?{from:n.to,to:r.from}:null}var Cx=Jm(!1),Ex=Jm(!0);function Jm(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{let{from:s,to:o}=r,l=e.doc.lineAt(s),a=!i&&s==o&&Ax(e,s);i&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let h=new Xn(e,{simulateBreak:s,simulateDoubleBreak:!!a}),c=bo(h,s);for(c==null&&(c=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let u=["",Ai(e,c)];return a&&u.push(Ai(e,h.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:X.of(u)},range:$.cursor(s+1+u[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function zh(i,e){let t=-1;return i.changeByRange(n=>{let r=[];for(let o=n.from;o<=n.to;){let l=i.doc.lineAt(o);l.number>t&&(n.empty||n.to>l.from)&&(e(l,r,n),t=l.number),o=l.to+1}let s=i.changes(r);return{changes:r,range:$.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}var Wx=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new Xn(i,{overrideIndentation:s=>{let o=t[s];return o??-1}}),r=zh(i,(s,o,l)=>{let a=bo(n,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let h=/^\s*/.exec(s.text)[0],c=Ai(i,a);(h!=c||l.from<s.from+h.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+h.length,insert:c}))});return r.changes.empty||e(i.update(r,{userEvent:"indent"})),!0},Qx=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(zh(i,(t,n)=>{n.push({from:t.from,insert:i.facet(bn)})}),{userEvent:"input.indent"})),!0),Rx=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(zh(i,(t,n)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let s=hn(r,i.tabSize),o=0,l=Ai(i,Math.max(0,s-Ir(i)));for(;o<r.length&&o<l.length&&r.charCodeAt(o)==l.charCodeAt(o);)o++;n.push({from:t.from+o,to:t.from+r.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0);var Mx=[{key:"Ctrl-b",run:Im,shift:Lm,preventDefault:!0},{key:"Ctrl-f",run:Am,shift:qm},{key:"Ctrl-p",run:Wm,shift:Vm},{key:"Ctrl-n",run:Qm,shift:Ym},{key:"Ctrl-a",run:ix,shift:mx},{key:"Ctrl-e",run:rx,shift:gx},{key:"Ctrl-d",run:Fm},{key:"Ctrl-h",run:Fh},{key:"Ctrl-k",run:zm},{key:"Ctrl-Alt-h",run:Xm},{key:"Ctrl-o",run:Px},{key:"Ctrl-t",run:vx},{key:"Ctrl-v",run:Uh}],Dx=[{key:"ArrowLeft",run:Im,shift:Lm,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Xw,shift:lx,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:tx,shift:dx,preventDefault:!0},{key:"ArrowRight",run:Am,shift:qm,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:zw,shift:ax,preventDefault:!0},{mac:"Cmd-ArrowRight",run:nx,shift:px,preventDefault:!0},{key:"ArrowUp",run:Wm,shift:Vm,preventDefault:!0},{mac:"Cmd-ArrowUp",run:gm,shift:ym},{mac:"Ctrl-ArrowUp",run:dm,shift:pm},{key:"ArrowDown",run:Qm,shift:Ym,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Om,shift:Sm},{mac:"Ctrl-ArrowDown",run:Uh,shift:mm},{key:"PageUp",run:dm,shift:pm},{key:"PageDown",run:Uh,shift:mm},{key:"Home",run:ex,shift:ux,preventDefault:!0},{key:"Mod-Home",run:gm,shift:ym},{key:"End",run:Kw,shift:fx,preventDefault:!0},{key:"Mod-End",run:Om,shift:Sm},{key:"Enter",run:Cx},{key:"Mod-a",run:Ox},{key:"Backspace",run:Fh,shift:Fh},{key:"Delete",run:Fm},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Xm},{key:"Mod-Delete",mac:"Alt-Delete",run:wx},{mac:"Mod-Backspace",run:xx},{mac:"Mod-Delete",run:zm}].concat(Mx.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),Ao=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Gw,shift:hx},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Jw,shift:cx},{key:"Alt-ArrowUp",run:_x},{key:"Shift-Alt-ArrowUp",run:Tx},{key:"Alt-ArrowDown",run:$x},{key:"Shift-Alt-ArrowDown",run:kx},{key:"Escape",run:bx},{key:"Mod-Enter",run:Ex},{key:"Alt-l",mac:"Ctrl-l",run:yx},{key:"Mod-i",run:Sx,preventDefault:!0},{key:"Mod-[",run:Rx},{key:"Mod-]",run:Qx},{key:"Mod-Alt-\\",run:Wx},{key:"Shift-Mod-k",run:Ix},{key:"Shift-Mod-\\",run:ox},{key:"Mod-/",run:Aw},{key:"Alt-A",run:Ew}].concat(Dx);function ee(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];typeof r=="string"?i.setAttribute(n,r):r!=null&&(i[n]=r)}e++}for(;e<arguments.length;e++)Km(i,arguments[e]);return i}function Km(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Km(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}var eg=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i,vn=class{constructor(e,t,n=0,r=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,r),this.bufferStart=n,this.normalize=s?l=>s(eg(l)):eg,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return _e(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=or(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=He(e);let r=this.normalize(t);for(let s=0,o=n;;s++){let l=r.charCodeAt(s),a=this.match(l,o);if(a)return this.value=a,this;if(s==r.length-1)break;o==n&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t){let n=null;for(let r=0;r<this.matches.length;r+=2){let s=this.matches[r],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?n={from:this.matches[r+1],to:t+1}:(this.matches[r]++,o=!0)),o||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?n={from:t,to:t+1}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferPos)&&(n=null),n}};typeof Symbol<"u"&&(vn.prototype[Symbol.iterator]=function(){return this});var rg={from:-1,to:-1,match:/.*/.exec("")},nc="gm"+(/x/.unicode==null?"":"u"),Wo=class{constructor(e,t,n,r=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=rg,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new Qo(e,t,n,r,s);this.re=new RegExp(t,nc+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let o=e.lineAt(r);this.curLineStart=o.from,this.matchPos=Ro(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,r=n+t[0].length;if(this.matchPos=Ro(this.text,r+(n==r?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<r||n>this.value.to)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}},Hh=new WeakMap,xn=class{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let r=Hh.get(e);if(!r||r.from>=n||r.to<=t){let l=new xn(t,e.sliceString(t,n));return Hh.set(e,l),l}if(r.from==t&&r.to==n)return r;let{text:s,from:o}=r;return o>t&&(s=e.sliceString(t,o)+s,o=t),r.to<n&&(s+=e.sliceString(r.to,n)),Hh.set(e,new xn(o,s)),new xn(t,s.slice(t-o,n-o))}},Qo=class{constructor(e,t,n,r,s){this.text=e,this.to=s,this.done=!1,this.value=rg,this.matchPos=Ro(e,r),this.re=new RegExp(t,nc+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=xn.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,r=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,r,t)))return this.value={from:n,to:r,match:t},this.matchPos=Ro(this.text,r+(n==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xn.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}};typeof Symbol<"u"&&(Wo.prototype[Symbol.iterator]=Qo.prototype[Symbol.iterator]=function(){return this});function Lx(i){try{return new RegExp(i,nc),!0}catch{return!1}}function Ro(i,e){if(e>=i.length)return e;let t=i.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function Gh(i){let e=ee("input",{class:"cm-textfield",name:"line"}),t=ee("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),i.dispatch({effects:Mo.of(!1)}),i.focus()):r.keyCode==13&&(r.preventDefault(),n())},onsubmit:r=>{r.preventDefault(),n()}},ee("label",i.state.phrase("Go to line"),": ",e)," ",ee("button",{class:"cm-button",type:"submit"},i.state.phrase("go")));function n(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:s}=i,o=s.doc.lineAt(s.selection.main.head),[,l,a,h,c]=r,u=h?+h.slice(1):0,m=a?+a:o.number;if(a&&c){let y=m/100;l&&(y=y*(l=="-"?-1:1)+o.number/s.doc.lines),m=Math.round(s.doc.lines*y)}else a&&l&&(m=m*(l=="-"?-1:1)+o.number);let g=s.doc.line(Math.max(1,Math.min(s.doc.lines,m)));i.dispatch({effects:Mo.of(!1),selection:$.cursor(g.from+Math.max(0,Math.min(u,g.length))),scrollIntoView:!0}),i.focus()}return{dom:t}}var Mo=V.define(),tg=le.define({create(){return!0},update(i,e){for(let t of e.effects)t.is(Mo)&&(i=t.value);return i},provide:i=>Yn.from(i,e=>e?Gh:null)}),qx=i=>{let e=Nn(i,Gh);if(!e){let t=[Mo.of(!0)];i.state.field(tg,!1)==null&&t.push(V.appendConfig.of([tg,Bx])),i.dispatch({effects:t}),e=Nn(i,Gh)}return e&&e.dom.querySelector("input").focus(),!0},Bx=R.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Zx={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},sg=M.define({combine(i){return Ve(i,Zx,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function og(i){let e=[Fx,Ux];return i&&e.push(sg.of(i)),e}var Vx=q.mark({class:"cm-selectionMatch"}),Yx=q.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function ng(i,e,t,n){return(t==0||i(e.sliceDoc(t-1,t))!=ie.Word)&&(n==e.doc.length||i(e.sliceDoc(n,n+1))!=ie.Word)}function Nx(i,e,t,n){return i(e.sliceDoc(t,t+1))==ie.Word&&i(e.sliceDoc(n-1,n))==ie.Word}var Ux=ae.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=i.state.facet(sg),{state:t}=i,n=t.selection;if(n.ranges.length>1)return q.none;let r=n.main,s,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return q.none;let a=t.wordAt(r.head);if(!a)return q.none;o=t.charCategorizer(r.head),s=t.sliceDoc(a.from,a.to)}else{let a=r.to-r.from;if(a<e.minSelectionLength||a>200)return q.none;if(e.wholeWords){if(s=t.sliceDoc(r.from,r.to),o=t.charCategorizer(r.head),!(ng(o,t,r.from,r.to)&&Nx(o,t,r.from,r.to)))return q.none}else if(s=t.sliceDoc(r.from,r.to).trim(),!s)return q.none}let l=[];for(let a of i.visibleRanges){let h=new vn(t.doc,s,a.from,a.to);for(;!h.next().done;){let{from:c,to:u}=h.value;if((!o||ng(o,t,c,u))&&(r.empty&&c<=r.from&&u>=r.to?l.push(Yx.range(c,u)):(c>=r.to||u<=r.from)&&l.push(Vx.range(c,u)),l.length>e.maxMatches))return q.none}}return q.set(l)}},{decorations:i=>i.decorations}),Fx=R.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),jx=({state:i,dispatch:e})=>{let{selection:t}=i,n=$.create(t.ranges.map(r=>i.wordAt(r.head)||$.cursor(r.head)),t.mainIndex);return n.eq(t)?!1:(e(i.update({selection:n})),!0)};function Xx(i,e){let{main:t,ranges:n}=i.selection,r=i.wordAt(t.head),s=r&&r.from==t.from&&r.to==t.to;for(let o=!1,l=new vn(i.doc,e,n[n.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new vn(i.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(a=>a.from==l.value.from))continue;if(s){let a=i.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}var zx=({state:i,dispatch:e})=>{let{ranges:t}=i.selection;if(t.some(s=>s.from===s.to))return jx({state:i,dispatch:e});let n=i.sliceDoc(t[0].from,t[0].to);if(i.selection.ranges.some(s=>i.sliceDoc(s.from,s.to)!=n))return!1;let r=Xx(i,n);return r?(e(i.update({selection:i.selection.addRange($.range(r.from,r.to),!1),effects:R.scrollIntoView(r.to)})),!0):!1},Qi=M.define({combine(i){return Ve(i,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new tc(e),scrollToMatch:e=>R.scrollIntoView(e)})}});var Do=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Lx(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Kh(this):new Jh(this)}getCursor(e,t=0,n){let r=e.doc?e:j.create({doc:e});return n==null&&(n=r.doc.length),this.regexp?Wi(this,r,t,n):Ei(this,r,t,n)}},Lo=class{constructor(e){this.spec=e}};function Ei(i,e,t,n){return new vn(e.doc,i.unquoted,t,n,i.caseSensitive?void 0:r=>r.toLowerCase(),i.wholeWord?Hx(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Hx(i,e){return(t,n,r,s)=>((s>t||s+r.length<n)&&(s=Math.max(0,t-2),r=i.sliceString(s,Math.min(i.length,n+2))),(e(qo(r,t-s))!=ie.Word||e(Bo(r,t-s))!=ie.Word)&&(e(Bo(r,n-s))!=ie.Word||e(qo(r,n-s))!=ie.Word))}var Jh=class extends Lo{constructor(e){super(e)}nextMatch(e,t,n){let r=Ei(this.spec,e,n,e.doc.length).nextOverlapping();return r.done&&(r=Ei(this.spec,e,0,t).nextOverlapping()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=n;;){let s=Math.max(t,r-1e4-this.spec.unquoted.length),o=Ei(this.spec,e,s,r),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;r-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=Ei(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=Ei(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}};function Wi(i,e,t,n){return new Wo(e.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?Gx(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function qo(i,e){return i.slice(Qe(i,e,!1),e)}function Bo(i,e){return i.slice(e,Qe(i,e))}function Gx(i){return(e,t,n)=>!n[0].length||(i(qo(n.input,n.index))!=ie.Word||i(Bo(n.input,n.index))!=ie.Word)&&(i(Bo(n.input,n.index+n[0].length))!=ie.Word||i(qo(n.input,n.index+n[0].length))!=ie.Word)}var Kh=class extends Lo{nextMatch(e,t,n){let r=Wi(this.spec,e,n,e.doc.length).next();return r.done&&(r=Wi(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,n){for(let r=1;;r++){let s=Math.max(t,n-r*1e4),o=Wi(this.spec,e,s,n),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(t,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:t))}matchAll(e,t){let n=Wi(this.spec,e,0,e.doc.length),r=[];for(;!n.next().done;){if(r.length>=t)return null;r.push(n.value)}return r}highlight(e,t,n,r){let s=Wi(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)r(s.value.from,s.value.to)}},Wr=V.define(),ic=V.define(),Pn=le.define({create(i){return new Er(ec(i).create(),null)},update(i,e){for(let t of e.effects)t.is(Wr)?i=new Er(t.value.create(),i.panel):t.is(ic)&&(i=new Er(i.query,t.value?rc:null));return i},provide:i=>Yn.from(i,e=>e.panel)});var Er=class{constructor(e,t){this.query=e,this.panel=t}},Jx=q.mark({class:"cm-searchMatch"}),Kx=q.mark({class:"cm-searchMatch cm-searchMatch-selected"}),e1=ae.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Pn))}update(i){let e=i.state.field(Pn);(e!=i.startState.field(Pn)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return q.none;let{view:t}=this,n=new nt;for(let r=0,s=t.visibleRanges,o=s.length;r<o;r++){let{from:l,to:a}=s[r];for(;r<o-1&&a>s[r+1].from-2*250;)a=s[++r].to;i.highlight(t.state,l,a,(h,c)=>{let u=t.state.selection.ranges.some(m=>m.from==h&&m.to==c);n.add(h,c,u?Kx:Jx)})}return n.finish()}},{decorations:i=>i.decorations});function Qr(i){return e=>{let t=e.state.field(Pn,!1);return t&&t.query.spec.valid?i(e,t):lg(e)}}var Zo=Qr((i,{query:e})=>{let{to:t}=i.state.selection.main,n=e.nextMatch(i.state,t,t);if(!n)return!1;let r=$.single(n.from,n.to),s=i.state.facet(Qi);return i.dispatch({selection:r,effects:[sc(i,n),s.scrollToMatch(r.main)],userEvent:"select.search"}),!0}),Vo=Qr((i,{query:e})=>{let{state:t}=i,{from:n}=t.selection.main,r=e.prevMatch(t,n,n);if(!r)return!1;let s=$.single(r.from,r.to),o=i.state.facet(Qi);return i.dispatch({selection:s,effects:[sc(i,r),o.scrollToMatch(s.main)],userEvent:"select.search"}),!0}),t1=Qr((i,{query:e})=>{let t=e.matchAll(i.state,1e3);return!t||!t.length?!1:(i.dispatch({selection:$.create(t.map(n=>$.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),n1=({state:i,dispatch:e})=>{let t=i.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:r}=t.main,s=[],o=0;for(let l=new vn(i.doc,i.sliceDoc(n,r));!l.next().done;){if(s.length>1e3)return!1;l.value.from==n&&(o=s.length),s.push($.range(l.value.from,l.value.to))}return e(i.update({selection:$.create(s,o),userEvent:"select.search.matches"})),!0},ig=Qr((i,{query:e})=>{let{state:t}=i,{from:n,to:r}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,n,n);if(!s)return!1;let o=[],l,a,h=[];if(s.from==n&&s.to==r&&(a=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:a}),s=e.nextMatch(t,s.from,s.to),h.push(R.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-a.length;l=$.single(s.from-c,s.to-c),h.push(sc(i,s)),h.push(t.facet(Qi).scrollToMatch(l.main))}return i.dispatch({changes:o,selection:l,effects:h,userEvent:"input.replace"}),!0}),i1=Qr((i,{query:e})=>{if(i.state.readOnly)return!1;let t=e.matchAll(i.state,1e9).map(r=>{let{from:s,to:o}=r;return{from:s,to:o,insert:e.getReplacement(r)}});if(!t.length)return!1;let n=i.state.phrase("replaced $ matches",t.length)+".";return i.dispatch({changes:t,effects:R.announce.of(n),userEvent:"input.replace.all"}),!0});function rc(i){return i.state.facet(Qi).createPanel(i)}function ec(i,e){var t,n,r,s;let o=i.selection.main,l=o.empty||o.to>o.from+100?"":i.sliceDoc(o.from,o.to);if(e&&!l)return e;let a=i.facet(Qi);return new Do({search:((t=e?.literal)!==null&&t!==void 0?t:a.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:a.caseSensitive,literal:(r=e?.literal)!==null&&r!==void 0?r:a.literal,wholeWord:(s=e?.wholeWord)!==null&&s!==void 0?s:a.wholeWord})}var lg=i=>{let e=i.state.field(Pn,!1);if(e&&e.panel){let t=Nn(i,rc);if(!t)return!1;let n=t.dom.querySelector("[main-field]");if(n&&n!=i.root.activeElement){let r=ec(i.state,e.query.spec);r.valid&&i.dispatch({effects:Wr.of(r)}),n.focus(),n.select()}}else i.dispatch({effects:[ic.of(!0),e?Wr.of(ec(i.state,e.query.spec)):V.appendConfig.of(s1)]});return!0},ag=i=>{let e=i.state.field(Pn,!1);if(!e||!e.panel)return!1;let t=Nn(i,rc);return t&&t.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:ic.of(!1)}),!0},hg=[{key:"Mod-f",run:lg,scope:"editor search-panel"},{key:"F3",run:Zo,shift:Vo,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Zo,shift:Vo,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:ag,scope:"editor search-panel"},{key:"Mod-Shift-l",run:n1},{key:"Alt-g",run:qx},{key:"Mod-d",run:zx,preventDefault:!0}],tc=class{constructor(e){this.view=e;let t=this.query=e.state.field(Pn).query.spec;this.commit=this.commit.bind(this),this.searchField=ee("input",{value:t.search,placeholder:lt(e,"Find"),"aria-label":lt(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ee("input",{value:t.replace,placeholder:lt(e,"Replace"),"aria-label":lt(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ee("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=ee("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=ee("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(r,s,o){return ee("button",{class:"cm-button",name:r,onclick:s,type:"button"},o)}this.dom=ee("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,n("next",()=>Zo(e),[lt(e,"next")]),n("prev",()=>Vo(e),[lt(e,"previous")]),n("select",()=>t1(e),[lt(e,"all")]),ee("label",null,[this.caseField,lt(e,"match case")]),ee("label",null,[this.reField,lt(e,"regexp")]),ee("label",null,[this.wordField,lt(e,"by word")]),...e.state.readOnly?[]:[ee("br"),this.replaceField,n("replace",()=>ig(e),[lt(e,"replace")]),n("replaceAll",()=>i1(e),[lt(e,"replace all")])],ee("button",{name:"close",onclick:()=>ag(e),"aria-label":lt(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new Do({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Wr.of(e)}))}keydown(e){dp(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Vo:Zo)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),ig(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Wr)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Qi).top}};function lt(i,e){return i.state.phrase(e)}var Co=30,Eo=/[\s\.,:;?!]/;function sc(i,{from:e,to:t}){let n=i.state.doc.lineAt(e),r=i.state.doc.lineAt(t).to,s=Math.max(n.from,e-Co),o=Math.min(r,t+Co),l=i.state.sliceDoc(s,o);if(s!=n.from){for(let a=0;a<Co;a++)if(!Eo.test(l[a+1])&&Eo.test(l[a])){l=l.slice(a);break}}if(o!=r){for(let a=l.length-1;a>l.length-Co;a--)if(!Eo.test(l[a-1])&&Eo.test(l[a])){l=l.slice(0,a);break}}return R.announce.of(`${i.state.phrase("current match")}. ${l} ${i.state.phrase("on line")} ${n.number}.`)}var r1=R.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),s1=[Pn,_t.lowest(e1),r1];var No=class{constructor(e,t,n){this.state=e,this.pos=t,this.explicit=n,this.abortListeners=[]}tokenBefore(e){let t=xe(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.text.slice(n-t.from,this.pos-t.from),s=r.search(wg(e,!1));return s<0?null:{from:n+s,to:this.pos,text:r.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}};function cg(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function o1(i){let e=Object.create(null),t=Object.create(null);for(let{label:r}of i){e[r[0]]=!0;for(let s=1;s<r.length;s++)t[r[s]]=!0}let n=cg(e)+cg(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function uc(i){let e=i.map(r=>typeof r=="string"?{label:r}:r),[t,n]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:o1(e);return r=>{let s=r.matchBefore(n);return s||r.explicit?{from:s?s.from:r.pos,options:e,validFor:t}:null}}function bg(i,e){return t=>{for(let n=xe(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(i.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}var Uo=class{constructor(e,t,n){this.completion=e,this.source=t,this.match=n}};function $n(i){return i.selection.main.head}function wg(i,e){var t;let{source:n}=i,r=e&&n[0]!="^",s=n[n.length-1]!="$";return!r&&!s?i:new RegExp(`${r?"^":""}(?:${n})${s?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}var xg=Ke.define();function l1(i,e,t,n){return Object.assign(Object.assign({},i.changeByRange(r=>{if(r==i.selection.main)return{changes:{from:t,to:n,insert:e},range:$.cursor(t+e.length)};let s=n-t;return!r.empty||s&&i.sliceDoc(r.from-s,r.from)!=i.sliceDoc(t,n)?{range:r}:{changes:{from:r.from-s,to:r.from,insert:e},range:$.cursor(r.from-s+e.length)}})),{userEvent:"input.complete"})}function Pg(i,e){let t=e.completion.apply||e.completion.label,n=e.source;typeof t=="string"?i.dispatch(Object.assign(Object.assign({},l1(i.state,t,n.from,n.to)),{annotations:xg.of(e.completion)})):t(i,e.completion,n.from,n.to)}var fg=new WeakMap;function a1(i){if(!Array.isArray(i))return i;let e=fg.get(i);return e||fg.set(i,e=uc(i)),e}var lc=class{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let n=_e(e,t),r=He(n);this.chars.push(n);let s=e.slice(t,t+r),o=s.toUpperCase();this.folded.push(_e(o==s?s.toLowerCase():o,0)),t+=r}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:r,precise:s,byWord:o}=this;if(t.length==1){let Q=_e(e,0),D=He(Q),I=D==e.length?0:-100;if(Q!=t[0])if(Q==n[0])I+=-200;else return null;return[I,0,D]}let l=e.indexOf(this.pattern);if(l==0)return[e.length==this.pattern.length?0:-100,0,this.pattern.length];let a=t.length,h=0;if(l<0){for(let Q=0,D=Math.min(e.length,200);Q<D&&h<a;){let I=_e(e,Q);(I==t[h]||I==n[h])&&(r[h++]=Q),Q+=He(I)}if(h<a)return null}let c=0,u=0,m=!1,g=0,y=-1,P=-1,x=/[a-z]/.test(e),k=!0;for(let Q=0,D=Math.min(e.length,200),I=0;Q<D&&u<a;){let E=_e(e,Q);l<0&&(c<a&&E==t[c]&&(s[c++]=Q),g<a&&(E==t[g]||E==n[g]?(g==0&&(y=Q),P=Q+1,g++):g=0));let W,Z=E<255?E>=48&&E<=57||E>=97&&E<=122?2:E>=65&&E<=90?1:0:(W=or(E))!=W.toLowerCase()?1:W!=W.toUpperCase()?2:0;(!Q||Z==1&&x||I==0&&Z!=0)&&(t[u]==E||n[u]==E&&(m=!0)?o[u++]=Q:o.length&&(k=!1)),I=Z,Q+=He(E)}return u==a&&o[0]==0&&k?this.result(-100+(m?-200:0),o,e):g==a&&y==0?[-200-e.length+(P==e.length?0:-100),0,P]:l>-1?[-700-e.length,l,l+this.pattern.length]:g==a?[-200+-700-e.length,y,P]:u==a?this.result(-100+(m?-200:0)+-700+(k?0:-1100),o,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,n){let r=[e-n.length],s=1;for(let o of t){let l=o+(this.astral?He(_e(n,o)):1);s>1&&r[s-1]==o?r[s-1]=l:(r[s++]=o,r[s++]=l)}return r}},wt=M.define({combine(i){return Ve(i,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>ug(e(n),t(n)),optionClass:(e,t)=>n=>ug(e(n),t(n)),addToOptions:(e,t)=>e.concat(t)})}});function ug(i,e){return i?e?i+" "+e:i:e}function h1(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,r){let s=document.createElement("span");s.className="cm-completionLabel";let{label:o}=t,l=0;for(let a=1;a<r.length;){let h=r[a++],c=r[a++];h>l&&s.appendChild(document.createTextNode(o.slice(l,h)));let u=s.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(o.slice(h,c))),u.className="cm-completionMatchedText",l=c}return l<o.length&&s.appendChild(document.createTextNode(o.slice(l))),s},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function dg(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}var ac=class{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:l=>this.positionInfo(l),key:this},this.space=null,this.currentClass="";let n=e.state.field(t),{options:r,selected:s}=n.open,o=e.state.facet(wt);this.optionContent=h1(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=dg(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{for(let a=l.target,h;a&&a!=this.dom;a=a.parentNode)if(a.nodeName=="LI"&&(h=/-(\d+)$/.exec(a.id))&&+h[1]<r.length){Pg(e,r[+h[1]]),l.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(r,n.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){var t,n,r;let s=e.state.field(this.stateField),o=e.startState.field(this.stateField);this.updateTooltipClass(e.state),s!=o&&(this.updateSel(),((t=s.open)===null||t===void 0?void 0:t.disabled)!=((n=o.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((r=s.open)===null||r===void 0)&&r.disabled)))}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=dg(t.options.length,t.selected,this.view.state.facet(wt).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:n}=t.options[t.selected],{info:r}=n;if(!r)return;let s=typeof r=="string"?document.createTextNode(r):r(n);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o)}).catch(o=>Ye(this.view.state,o,"completion info")):this.addInfoPane(s)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&f1(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),s=this.space;if(!s){let y=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:y.innerWidth,bottom:y.innerHeight}}if(r.top>Math.min(s.bottom,t.bottom)-10||r.bottom<Math.max(s.top,t.top)+10)return null;let o=this.view.textDirection==ce.RTL,l=o,a=!1,h,c="",u="",m=t.left-s.left,g=s.right-t.right;if(l&&m<Math.min(n.width,g)?l=!1:!l&&g<Math.min(n.width,m)&&(l=!0),n.width<=(l?m:g))c=Math.max(s.top,Math.min(r.top,s.bottom-n.height))-t.top+"px",h=Math.min(400,l?m:g)+"px";else{a=!0,h=Math.min(400,(o?t.right:s.right-t.left)-30)+"px";let y=s.bottom-t.bottom;y>=n.height||y>t.top?c=r.bottom-t.top+"px":u=t.bottom-r.top+"px"}return{top:c,bottom:u,maxWidth:h,class:a?o?"left-narrow":"right-narrow":l?"left":"right"}}positionInfo(e){this.info&&(e?(this.info.style.top=e.top,this.info.style.bottom=e.bottom,this.info.style.maxWidth=e.maxWidth,this.info.className="cm-tooltip cm-completionInfo cm-completionInfo-"+e.class):this.info.style.top="-1e6px")}createListBox(e,t,n){let r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let s=n.from;s<n.to;s++){let{completion:o,match:l}=e[s],a=r.appendChild(document.createElement("li"));a.id=t+"-"+s,a.setAttribute("role","option");let h=this.optionClass(o);h&&(a.className=h);for(let c of this.optionContent){let u=c(o,this.view.state,l);u&&a.appendChild(u)}}return n.from&&r.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}};function c1(i){return e=>new ac(e,i)}function f1(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect();n.top<t.top?i.scrollTop-=t.top-n.top:n.bottom>t.bottom&&(i.scrollTop+=n.bottom-t.bottom)}function pg(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function u1(i,e){let t=[],n=0;for(let l of i)if(l.hasResult())if(l.result.filter===!1){let a=l.result.getMatch;for(let h of l.result.options){let c=[1e9-n++];if(a)for(let u of a(h))c.push(u);t.push(new Uo(h,l,c))}}else{let a=new lc(e.sliceDoc(l.from,l.to)),h;for(let c of l.result.options)(h=a.match(c.label))&&(c.boost!=null&&(h[0]+=c.boost),t.push(new Uo(c,l,h)))}let r=[],s=null,o=e.facet(wt).compareCompletions;for(let l of t.sort((a,h)=>h.match[0]-a.match[0]||o(a.completion,h.completion)))!s||s.label!=l.completion.label||s.detail!=l.completion.detail||s.type!=null&&l.completion.type!=null&&s.type!=l.completion.type||s.apply!=l.completion.apply?r.push(l):pg(l.completion)>pg(s)&&(r[r.length-1]=l),s=l.completion;return r}var _n=class{constructor(e,t,n,r,s,o){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=r,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new _n(this.options,mg(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,r,s){let o=u1(e,t);if(!o.length)return r&&e.some(a=>a.state==1)?new _n(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;let l=t.facet(wt).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let a=r.options[r.selected].completion;for(let h=0;h<o.length;h++)if(o[h].completion==a){l=h;break}}return new _n(o,mg(n,l),{pos:e.reduce((a,h)=>h.hasResult()?Math.min(a,h.from):a,1e8),create:c1(bt),above:s.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new _n(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}},Ri=class{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new Ri(m1,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(wt),s=(n.override||t.languageDataAt("autocomplete",$n(t)).map(a1)).map(l=>(this.active.find(h=>h.source==l)||new Fe(l,this.active.some(h=>h.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!d1(s,this.active)?o=_n.build(s,t,this.id,o,n):o&&o.disabled&&!s.some(l=>l.state==1)&&(o=null),!o&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new Fe(l.source,0):l));for(let l of e.effects)l.is(_g)&&(o=o&&o.setSelected(l.value,this.id));return s==this.active&&o==this.open?this:new Ri(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:p1}};function d1(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult;)t++;for(;n<e.length&&!e[n].hasResult;)n++;let r=t==i.length,s=n==e.length;if(r||s)return r==s;if(i[t++].result!=e[n++].result)return!1}}var p1={"aria-autocomplete":"list"};function mg(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}var m1=[];function hc(i){return i.isUserEvent("input.type")?"input":i.isUserEvent("delete.backward")?"delete":null}var Fe=class{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(e,t){let n=hc(e),r=this;n?r=r.handleUserEvent(e,n,t):e.docChanged?r=r.handleChange(e):e.selection&&r.state!=0&&(r=new Fe(r.source,0));for(let s of e.effects)if(s.is(dc))r=new Fe(r.source,1,s.value?$n(e.state):-1);else if(s.is(Fo))r=new Fe(r.source,0);else if(s.is(vg))for(let o of s.value)o.source==r.source&&(r=o);return r}handleUserEvent(e,t,n){return t=="delete"||!n.activateOnTyping?this.map(e.changes):new Fe(this.source,1)}handleChange(e){return e.changes.touchesRange($n(e.startState))?new Fe(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Fe(this.source,this.state,e.mapPos(this.explicitPos))}},Gn=class extends Fe{constructor(e,t,n,r,s){super(e,2,t),this.result=n,this.from=r,this.to=s}hasResult(){return!0}handleUserEvent(e,t,n){var r;let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=$n(e.state);if((this.explicitPos<0?l<=s:l<this.from)||l>o||t=="delete"&&$n(e.startState)==this.from)return new Fe(this.source,t=="input"&&n.activateOnTyping?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),h;return g1(this.result.validFor,e.state,s,o)?new Gn(this.source,a,this.result,s,o):this.result.update&&(h=this.result.update(this.result,s,o,new No(e.state,l,a>=0)))?new Gn(this.source,a,h,h.from,(r=h.to)!==null&&r!==void 0?r:$n(e.state)):new Fe(this.source,1,a)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new Fe(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Gn(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}};function g1(i,e,t,n){if(!i)return!1;let r=e.sliceDoc(t,n);return typeof i=="function"?i(r,t,n,e):wg(i,!0).test(r)}var dc=V.define(),Fo=V.define(),vg=V.define({map(i,e){return i.map(t=>t.map(e))}}),_g=V.define(),bt=le.define({create(){return Ri.start()},update(i,e){return i.update(e)},provide:i=>[xr.from(i,e=>e.tooltip),R.contentAttributes.from(i,e=>e.attrs)]});function Yo(i,e="option"){return t=>{let n=t.state.field(bt,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(wt).interactionDelay)return!1;let r=1,s;e=="page"&&(s=Ip(t,n.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,l=n.open.selected>-1?n.open.selected+r*(i?1:-1):i?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:_g.of(l)}),!0}}var O1=i=>{let e=i.state.field(bt,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<i.state.facet(wt).interactionDelay?!1:(e.open.disabled||Pg(i,e.open.options[e.open.selected]),!0)},y1=i=>i.state.field(bt,!1)?(i.dispatch({effects:dc.of(!0)}),!0):!1,S1=i=>{let e=i.state.field(bt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Fo.of(null)}),!0)},cc=class{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}},gg=50,b1=50,w1=1e3,x1=ae.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of i.state.field(bt).active)e.state==1&&this.startQuery(e)}update(i){let e=i.state.field(bt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(bt)==e)return;let t=i.transactions.some(n=>(n.selection||n.docChanged)&&!hc(n));for(let n=0;n<this.running.length;n++){let r=this.running[n];if(t||r.updates.length+i.transactions.length>b1&&Date.now()-r.time>w1){for(let s of r.context.abortListeners)try{s()}catch(o){Ye(this.view.state,o)}r.context.abortListeners=null,this.running.splice(n--,1)}else r.updates.push(...i.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(n=>n.state==1&&!this.running.some(r=>r.active.source==n.source))?setTimeout(()=>this.startUpdate(),gg):-1,this.composing!=0)for(let n of i.transactions)hc(n)=="input"?this.composing=2:this.composing==2&&n.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:i}=this.view,e=i.field(bt);for(let t of e.active)t.state==1&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t)}startQuery(i){let{state:e}=this.view,t=$n(e),n=new No(e,t,i.explicitPos==t),r=new cc(i,n);this.running.push(r),Promise.resolve(i.source(n)).then(s=>{r.context.aborted||(r.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Fo.of(null)}),Ye(this.view.state,s)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),gg))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(wt);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let o=new Gn(r.active.source,r.active.explicitPos,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:$n(r.updates.length?r.updates[0].startState:this.view.state));for(let l of r.updates)o=o.update(l,t);if(o.hasResult()){e.push(o);continue}}let s=this.view.state.field(bt).active.find(o=>o.source==r.active.source);if(s&&s.state==1)if(r.done==null){let o=new Fe(r.active.source,0);for(let l of r.updates)o=o.update(l,t);o.state!=1&&e.push(o)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:vg.of(e)})}},{eventHandlers:{blur(){let i=this.view.state.field(bt,!1);i&&i.tooltip&&this.view.state.facet(wt).closeOnBlur&&this.view.dispatch({effects:Fo.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:dc.of(!1)}),20),this.composing=0}}}),$g=R.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),fc=class{constructor(e,t,n,r){this.field=e,this.line=t,this.from=n,this.to=r}},Rr=class{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,ke.TrackDel),n=e.mapPos(this.to,1,ke.TrackDel);return t==null||n==null?null:new Rr(this.field,t,n)}},Mr=class{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],r=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(n.length){let h=o,c=/^\t*/.exec(a)[0].length;for(let u=0;u<c;u++)h+=e.facet(bn);r.push(t+h.length-c),a=h+a.slice(c)}n.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new Rr(a.field,r[a.line]+a.from,r[a.line]+a.to));return{text:n,ranges:l}}static parse(e){let t=[],n=[],r=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",h=-1;for(let c=0;c<t.length;c++)(l!=null?t[c].seq==l:a&&t[c].name==a)&&(h=c);if(h<0){let c=0;for(;c<t.length&&(l==null||t[c].seq!=null&&t[c].seq<l);)c++;t.splice(c,0,{seq:l,name:a}),h=c;for(let u of r)u.field>=h&&u.field++}r.push(new fc(h,n.length,s.index,s.index+a.length)),o=o.slice(0,s.index)+a+o.slice(s.index+s[0].length)}for(let l;l=/\\([{}])/.exec(o);){o=o.slice(0,l.index)+l[1]+o.slice(l.index+l[0].length);for(let a of r)a.line==n.length&&a.from>l.index&&(a.from--,a.to--)}n.push(o)}return new Mr(n,r)}},P1=q.widget({widget:new class extends et{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),v1=q.mark({class:"cm-snippetField"}),Tn=class{constructor(e,t){this.ranges=e,this.active=t,this.deco=q.set(e.map(n=>(n.from==n.to?P1:v1).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let r=n.map(e);if(!r)return null;t.push(r)}return new Tn(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}},qr=V.define({map(i,e){return i&&i.map(e)}}),_1=V.define(),Dr=le.define({create(){return null},update(i,e){for(let t of e.effects){if(t.is(qr))return t.value;if(t.is(_1)&&i)return new Tn(i.ranges,t.value)}return i&&e.docChanged&&(i=i.map(e.changes)),i&&e.selection&&!i.selectionInsideField(e.selection)&&(i=null),i},provide:i=>R.decorations.from(i,e=>e?e.deco:q.none)});function pc(i,e){return $.create(i.filter(t=>t.field==e).map(t=>$.range(t.from,t.to)))}function $1(i){let e=Mr.parse(i);return(t,n,r,s)=>{let{text:o,ranges:l}=e.instantiate(t.state,r),a={changes:{from:r,to:s,insert:X.of(o)},scrollIntoView:!0,annotations:xg.of(n)};if(l.length&&(a.selection=pc(l,0)),l.length>1){let h=new Tn(l,0),c=a.effects=[qr.of(h)];t.state.field(Dr,!1)===void 0&&c.push(V.appendConfig.of([Dr,C1,E1,$g]))}t.dispatch(t.state.update(a))}}function Tg(i){return({state:e,dispatch:t})=>{let n=e.field(Dr,!1);if(!n||i<0&&n.active==0)return!1;let r=n.active+i,s=i>0&&!n.ranges.some(o=>o.field==r+i);return t(e.update({selection:pc(n.ranges,r),effects:qr.of(s?null:new Tn(n.ranges,r))})),!0}}var T1=({state:i,dispatch:e})=>i.field(Dr,!1)?(e(i.update({effects:qr.of(null)})),!0):!1,k1=Tg(1),I1=Tg(-1),A1=[{key:"Tab",run:k1,shift:I1},{key:"Escape",run:T1}],Og=M.define({combine(i){return i.length?i[0]:A1}}),C1=_t.highest(pn.compute([Og],i=>i.facet(Og)));function Yt(i,e){return Object.assign(Object.assign({},e),{apply:$1(i)})}var E1=R.domEventHandlers({mousedown(i,e){let t=e.state.field(Dr,!1),n;if(!t||(n=e.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let r=t.ranges.find(s=>s.from<=n&&s.to>=n);return!r||r.field==t.active?!1:(e.dispatch({selection:pc(t.ranges,r.field),effects:qr.of(t.ranges.some(s=>s.field>r.field)?new Tn(t.ranges,r.field):null)}),!0)}});var Lr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Hn=V.define({map(i,e){let t=e.mapPos(i,-1,ke.TrackAfter);return t??void 0}}),mc=V.define({map(i,e){return e.mapPos(i)}}),gc=new class extends vt{};gc.startSide=1;gc.endSide=-1;var kg=le.define({create(){return H.empty},update(i,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,n=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(n,-1)&&(i=H.empty)}i=i.map(e.changes);for(let t of e.effects)t.is(Hn)?i=i.update({add:[gc.range(t.value,t.value+1)]}):t.is(mc)&&(i=i.update({filter:n=>n!=t.value}));return i}});function Ig(){return[Q1,kg]}var oc="()[]{}<>";function Ag(i){for(let e=0;e<oc.length;e+=2)if(oc.charCodeAt(e)==i)return oc.charAt(e+1);return or(i<128?i:i+1)}function Cg(i,e){return i.languageDataAt("closeBrackets",e)[0]||Lr}var W1=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Q1=R.inputHandler.of((i,e,t,n)=>{if((W1?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let r=i.state.selection.main;if(n.length>2||n.length==2&&He(_e(n,0))==1||e!=r.from||t!=r.to)return!1;let s=M1(i.state,n);return s?(i.dispatch(s),!0):!1}),R1=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let n=Cg(i,i.selection.main.head).brackets||Lr.brackets,r=null,s=i.changeByRange(o=>{if(o.empty){let l=D1(i.doc,o.head);for(let a of n)if(a==l&&jo(i.doc,o.head)==Ag(_e(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:$.cursor(o.head-a.length)}}return{range:r=o}});return r||e(i.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},Eg=[{key:"Backspace",run:R1}];function M1(i,e){let t=Cg(i,i.selection.main.head),n=t.brackets||Lr.brackets;for(let r of n){let s=Ag(_e(r,0));if(e==r)return s==r?B1(i,r,n.indexOf(r+r+r)>-1,t):L1(i,r,s,t.before||Lr.before);if(e==s&&Wg(i,i.selection.main.from))return q1(i,r,s)}return null}function Wg(i,e){let t=!1;return i.field(kg).between(0,i.doc.length,n=>{n==e&&(t=!0)}),t}function jo(i,e){let t=i.sliceString(e,e+2);return t.slice(0,He(_e(t,0)))}function D1(i,e){let t=i.sliceString(e-2,e);return He(_e(t,0))==t.length?t:t.slice(1)}function L1(i,e,t,n){let r=null,s=i.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Hn.of(o.to+e.length),range:$.range(o.anchor+e.length,o.head+e.length)};let l=jo(i.doc,o.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:Hn.of(o.head+e.length),range:$.cursor(o.head+e.length)}:{range:r=o}});return r?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function q1(i,e,t){let n=null,r=i.selection.ranges.map(s=>s.empty&&jo(i.doc,s.head)==t?$.cursor(s.head+t.length):n=s);return n?null:i.update({selection:$.create(r,i.selection.mainIndex),scrollIntoView:!0,effects:i.selection.ranges.map(({from:s})=>mc.of(s))})}function B1(i,e,t,n){let r=n.stringPrefixes||Lr.stringPrefixes,s=null,o=i.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Hn.of(l.to+e.length),range:$.range(l.anchor+e.length,l.head+e.length)};let a=l.head,h=jo(i.doc,a),c;if(h==e){if(yg(i,a))return{changes:{insert:e+e,from:a},effects:Hn.of(a+e.length),range:$.cursor(a+e.length)};if(Wg(i,a)){let u=t&&i.sliceDoc(a,a+e.length*3)==e+e+e;return{range:$.cursor(a+e.length*(u?3:1)),effects:mc.of(a)}}}else{if(t&&i.sliceDoc(a-2*e.length,a)==e+e&&(c=Sg(i,a-2*e.length,r))>-1&&yg(i,c))return{changes:{insert:e+e+e+e,from:a},effects:Hn.of(a+e.length),range:$.cursor(a+e.length)};if(i.charCategorizer(a)(h)!=ie.Word&&Sg(i,a,r)>-1&&!Z1(i,a,e,r))return{changes:{insert:e+e,from:a},effects:Hn.of(a+e.length),range:$.cursor(a+e.length)}}return{range:s=l}});return s?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function yg(i,e){let t=xe(i).resolveInner(e+1);return t.parent&&t.from==e}function Z1(i,e,t,n){let r=xe(i).resolveInner(e,-1),s=n.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=i.sliceDoc(r.from,Math.min(r.to,r.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&n.indexOf(l.slice(0,a))>-1){let c=r.firstChild;for(;c&&c.from==r.from&&c.to-c.from>t.length+a;){if(i.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let h=r.to==e&&r.parent;if(!h)break;r=h}return!1}function Sg(i,e,t){let n=i.charCategorizer(e);if(n(i.sliceDoc(e-1,e))!=ie.Word)return e;for(let r of t){let s=e-r.length;if(i.sliceDoc(s,e)==r&&n(i.sliceDoc(s-1,s))!=ie.Word)return s}return-1}function Qg(i={}){return[bt,wt.of(i),x1,V1,$g]}var Oc=[{key:"Ctrl-Space",run:y1},{key:"Escape",run:S1},{key:"ArrowDown",run:Yo(!0)},{key:"ArrowUp",run:Yo(!1)},{key:"PageDown",run:Yo(!0,"page")},{key:"PageUp",run:Yo(!1,"page")},{key:"Enter",run:O1}],V1=_t.highest(pn.computeN([wt],i=>i.facet(wt).defaultKeymap?[Oc]:[]));var Sc=class{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}},Kt=class{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let r=e,s=n.facet(Mi).markerFilter;s&&(r=s(r));let o=q.set(r.map(l=>l.from==l.to||l.from==l.to-1&&n.doc.lineAt(l.from).to==l.from?q.widget({widget:new bc(l),diagnostic:l}).range(l.from):q.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity},diagnostic:l}).range(l.from,l.to)),!0);return new Kt(o,t,Di(o))}};function Di(i,e=null,t=0){let n=null;return i.between(t,1e9,(r,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return n=new Sc(r,s,o.diagnostic),!1}),n}function Y1(i,e){return!!(i.effects.some(t=>t.is(wc))||i.changes.touchesRange(e.pos))}function Mg(i,e){return i.field(at,!1)?e:e.concat(V.appendConfig.of([at,R.decorations.compute([at],t=>{let{selected:n,panel:r}=t.field(at);return!n||!r||n.from==n.to?q.none:q.set([U1.range(n.from,n.to)])}),kp(F1,{hideOn:Y1}),J1]))}function N1(i,e){return{effects:Mg(i,[wc.of(e)])}}var wc=V.define(),xc=V.define(),Dg=V.define(),at=le.define({create(){return new Kt(q.none,null,null)},update(i,e){if(e.docChanged){let t=i.diagnostics.map(e.changes),n=null;if(i.selected){let r=e.changes.mapPos(i.selected.from,1);n=Di(t,i.selected.diagnostic,r)||Di(t,null,r)}i=new Kt(t,i.panel,n)}for(let t of e.effects)t.is(wc)?i=Kt.init(t.value,i.panel,e.state):t.is(xc)?i=new Kt(i.diagnostics,t.value?Li.open:null,i.selected):t.is(Dg)&&(i=new Kt(i.diagnostics,i.panel,t.value));return i},provide:i=>[Yn.from(i,e=>e.panel),R.decorations.from(i,e=>e.diagnostics)]});var U1=q.mark({class:"cm-lintRange cm-lintRange-active"});function F1(i,e,t){let{diagnostics:n}=i.state.field(at),r=[],s=2e8,o=0;n.between(e-(t<0?1:0),e+(t>0?1:0),(a,h,{spec:c})=>{e>=a&&e<=h&&(a==h||(e>a||t>0)&&(e<h||t<0))&&(r.push(c.diagnostic),s=Math.min(a,s),o=Math.max(h,o))});let l=i.state.facet(Mi).tooltipFilter;return l&&(r=l(r)),r.length?{pos:s,end:o,above:i.state.doc.lineAt(s).to<o,create(){return{dom:j1(i,r)}}}:null}function j1(i,e){return ee("ul",{class:"cm-tooltip-lint"},e.map(t=>Bg(i,t,!1)))}var X1=i=>{let e=i.state.field(at,!1);(!e||!e.panel)&&i.dispatch({effects:Mg(i.state,[xc.of(!0)])});let t=Nn(i,Li.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Rg=i=>{let e=i.state.field(at,!1);return!e||!e.panel?!1:(i.dispatch({effects:xc.of(!1)}),!0)},z1=i=>{let e=i.state.field(at,!1);if(!e)return!1;let t=i.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(i.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},Lg=[{key:"Mod-Shift-m",run:X1,preventDefault:!0},{key:"F8",run:z1}],H1=ae.fromClass(class{constructor(i){this.view=i,this.timeout=-1,this.set=!0;let{delay:e}=i.state.facet(Mi);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let i=Date.now();if(i<this.lintTime-10)setTimeout(this.run,this.lintTime-i);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(Mi);Promise.all(t.map(n=>Promise.resolve(n(this.view)))).then(n=>{let r=n.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(N1(this.view.state,r))},n=>{Ye(this.view.state,n)})}}update(i){let e=i.state.facet(Mi);(i.docChanged||e!=i.startState.facet(Mi)||e.needsRefresh&&e.needsRefresh(i))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Mi=M.define({combine(i){return Object.assign({sources:i.map(e=>e.source)},Ve(i.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))},enables:H1});function qg(i){let e=[];if(i)e:for(let{name:t}of i){for(let n=0;n<t.length;n++){let r=t[n];if(/[a-zA-Z]/.test(r)&&!e.some(s=>s.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function Bg(i,e,t){var n;let r=t?qg(e.actions):[];return ee("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},ee("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,o)=>{let l=!1,a=m=>{if(m.preventDefault(),l)return;l=!0;let g=Di(i.state.field(at).diagnostics,e);g&&s.apply(i,g.from,g.to)},{name:h}=s,c=r[o]?h.indexOf(r[o]):-1,u=c<0?h:[h.slice(0,c),ee("u",h.slice(c,c+1)),h.slice(c+1)];return ee("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${h}${c<0?"":` (access key "${r[o]})"`}.`},u)}),e.source&&ee("div",{class:"cm-diagnosticSource"},e.source))}var bc=class extends et{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return ee("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}},Xo=class{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Bg(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}},Li=class{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)Rg(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=qg(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==r.keyCode){let a=Di(this.view.state.field(at).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;r.preventDefault()},n=r=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(r.target)&&this.moveSelection(s)};this.list=ee("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=ee("div",{class:"cm-panel-lint"},this.list,ee("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Rg(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(at).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(at),n=0,r=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,l,{spec:a})=>{let h=-1,c;for(let u=n;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){h=u;break}h<0?(c=new Xo(this.view,a.diagnostic),this.items.splice(n,0,c),r=!0):(c=this.items[h],h>n&&(this.items.splice(n,h-n),r=!0)),t&&c.diagnostic==t.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new Xo(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{o.top<l.top?this.list.scrollTop-=l.top-o.top:o.bottom>l.bottom&&(this.list.scrollTop+=o.bottom-l.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(at),n=Di(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Dg.of(n)})}static open(e){return new Li(e)}};function G1(i,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(i)}</svg>')`}function yc(i){return G1(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var J1=R.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:yc("#d11")},".cm-lintRange-warning":{backgroundImage:yc("orange")},".cm-lintRange-info":{backgroundImage:yc("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});var Zg=(()=>[Wp(),Qp(),Pp(),Pm(),om(),yp(),xp(),j.allowMultipleSelections.of(!0),Gp(),Zh(am,{fallback:!0}),um(),Ig(),Qg(),_p(),$p(),vp(),og(),pn.of([...Eg,...Ao,...hg,...Tm,...im,...Oc,...Lg])])();var Bi=class{constructor(e,t,n,r,s,o,l,a,h,c=0,u){this.p=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=s,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=h,this.lookAhead=c,this.parent=u}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let r=e.parser.context;return new Bi(e,[],t,n,n,0,[],0,r?new zo(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,r=e&65535,{parser:s}=this.p,o=s.dynamicPrecedence(r);if(o&&(this.score+=o),n==0){this.pushState(s.getGoto(this.state,r,!0),this.reducePos),r<s.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),a=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-a;h>=2e3&&!(!((t=this.p.parser.nodeSet.types[r])===null||t===void 0)&&t.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=h));let c=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-c;if(r<s.minRepeatTerm||e&131072){let m=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,a,m,u+4,!0)}if(e&262144)this.state=this.stack[l];else{let m=this.stack[l-3];this.state=s.getGoto(m,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,a)}storeNode(e,t,n,r=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(t==n)return;if(o.buffer[l-2]>=t){o.buffer[l-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,t,n,r);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,r>4&&(r-=4);this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=n,this.buffer[o+3]=r}}shift(e,t,n){let r=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=n,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,n,4);else{let s=e,{parser:o}=this.p;(n>this.pos||t<=o.maxNode)&&(this.pos=n,o.stateFlag(s,1)||(this.reducePos=n)),this.pushState(s,r),this.shiftContext(t,r),t<=o.maxNode&&this.buffer.push(t,r,n,4)}}apply(e,t,n){e&65536?this.reduce(e):this.shift(e,t,n)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new Bi(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new _c(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if(!(n&65536))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>4<<1||this.stack.length>=120){let r=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&r.push(t[s],o);if(this.stack.length<120)for(let s=0;r.length<4<<1&&s<t.length;s+=2){let o=t[s+1];r.some((l,a)=>a&1&&l==o)||r.push(t[s],o)}t=r}let n=[];for(let r=0;r<t.length&&n.length<4;r+=2){let s=t[r+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[r],this.pos),o.score-=200,n.push(o)}return n}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(!(e&65536))return!1;let{parser:t}=this.p;if(!t.validAction(this.state,e)){let n=e>>19,r=e&65535,s=this.stack.length-n*3;if(s<0||t.getGoto(this.stack[s],r,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new zo(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},zo=class{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}},Vg;(function(i){i[i.Insert=200]="Insert",i[i.Delete=190]="Delete",i[i.Reduce=100]="Reduce",i[i.MaxNext=4]="MaxNext",i[i.MaxInsertStackDepth=300]="MaxInsertStackDepth",i[i.DampenInsertStackDepth=120]="DampenInsertStackDepth",i[i.MinBigReduction=2e3]="MinBigReduction"})(Vg||(Vg={}));var _c=class{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}},Zi=class{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Zi(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Zi(this.stack,this.pos,this.index)}};function Br(i,e=Uint16Array){if(typeof i!="string")return i;let t=null;for(let n=0,r=0;n<i.length;){let s=0;for(;;){let o=i.charCodeAt(n++),l=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),s+=a,l)break;s*=46}t?t[r++]=s:t=new e(s)}return t}var qi=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},Yg=new qi,$c=class{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Yg,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,r=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!r)return null;let o=this.ranges[--r];s-=n.from-o.to,n=o}for(;t<0?s>n.to:s>=n.to;){if(r==this.ranges.length-1)return null;let o=this.ranges[++r];s+=o.from-n.to,n=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,r;if(t>=0&&t<this.chunk.length)n=this.pos+e,r=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=n;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-n)),r=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),r}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=Yg,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(n+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return n}},kn=class{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;Hg(this.data,e,t,this.id,n.data,n.tokenPrecTable)}};kn.prototype.contextual=kn.prototype.fallback=kn.prototype.extend=!1;var Tc=class{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?Br(e):e}token(e,t){let n=e.pos,r;for(;r=e.pos,Hg(this.data,e,t,0,this.data,this.precTable),!(e.token.value>-1);){if(this.elseToken==null)return;if(e.next<0)break;e.advance(),e.reset(r+1,e.token)}r>n&&(e.reset(n,e.token),e.acceptToken(this.elseToken,r-n))}};Tc.prototype.contextual=kn.prototype.fallback=kn.prototype.extend=!1;var Vi=class{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}};function Hg(i,e,t,n,r,s){let o=0,l=1<<n,{dialect:a}=t.p.parser;e:for(;l&i[o];){let h=i[o+1];for(let g=o+3;g<h;g+=2)if((i[g+1]&l)>0){let y=i[g];if(a.allows(y)&&(e.token.value==-1||e.token.value==y||eP(y,e.token.value,r,s))){e.acceptToken(y);break}}let c=e.next,u=0,m=i[o+2];if(e.next<0&&m>u&&i[h+m*3-3]==65535&&i[h+m*3-3]==65535){o=i[h+m*3-1];continue e}for(;u<m;){let g=u+m>>1,y=h+g+(g<<1),P=i[y],x=i[y+1]||65536;if(c<P)m=g;else if(c>=x)u=g+1;else{o=i[y+2],e.advance();continue e}}break}}function Ng(i,e,t){for(let n=e,r;(r=i[n])!=65535;n++)if(r==t)return n-e;return-1}function eP(i,e,t,n){let r=Ng(t,n,e);return r<0||Ng(t,n,i)<r}var It=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG),Pc=null,Ug;(function(i){i[i.Margin=25]="Margin"})(Ug||(Ug={}));function Fg(i,e,t){let n=i.cursor(we.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(i.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:i.length}}var kc=class{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Fg(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Fg(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],r=this.index[t];if(r==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[r],o=this.start[t]+n.positions[r];if(o>e)return this.nextStart=o,null;if(s instanceof fe){if(o==e){if(o<this.safeFrom)return null;let l=o+s.length;if(l<=this.safeTo){let a=s.prop(Y.lookAhead);if(!a||l+a<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}},Ic=class{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new qi)}getActions(e){let t=0,n=null,{parser:r}=e.p,{tokenizers:s}=r,o=r.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,a=0;for(let h=0;h<s.length;h++){if(!(1<<h&o))continue;let c=s[h],u=this.tokens[h];if(!(n&&!c.fallback)&&((c.contextual||u.start!=e.pos||u.mask!=o||u.context!=l)&&(this.updateCachedToken(u,c,e),u.mask=o,u.context=l),u.lookAhead>u.end+25&&(a=Math.max(u.lookAhead,a)),u.value!=0)){let m=t;if(u.extended>-1&&(t=this.addActions(e,u.extended,u.end,t)),t=this.addActions(e,u.value,u.end,t),!c.extend&&(n=u,t>m))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!n&&e.pos==this.stream.end&&(n=new qi,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new qi,{pos:n,p:r}=e;return t.start=n,t.end=Math.min(n+1,r.stream.end),t.value=n==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,n){let r=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(r,e),n),e.value>-1){let{parser:s}=n.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let l=s.specializers[o](this.stream.read(e.start,e.end),n);if(l>=0&&n.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,n,r){for(let s=0;s<r;s+=3)if(this.actions[s]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r}addActions(e,t,n,r){let{state:s}=e,{parser:o}=e.p,{data:l}=o;for(let a=0;a<2;a++)for(let h=o.stateSlot(s,a?2:1);;h+=3){if(l[h]==65535)if(l[h+1]==1)h=en(l,h+2);else{r==0&&l[h+1]==2&&(r=this.putAction(en(l,h+2),t,n,r));break}l[h]==t&&(r=this.putAction(en(l,h+1),t,n,r))}return r}},jg;(function(i){i[i.Distance=5]="Distance",i[i.MaxRemainingPerStep=3]="MaxRemainingPerStep",i[i.MinBufferLengthPrune=500]="MinBufferLengthPrune",i[i.ForceReduceLimit=10]="ForceReduceLimit",i[i.CutDepth=15e3]="CutDepth",i[i.CutTo=9e3]="CutTo",i[i.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",i[i.MaxStackCount=12]="MaxStackCount"})(jg||(jg={}));var Ac=class{constructor(e,t,n,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new $c(t,r),this.tokens=new Ic(e,this.stream),this.topTerm=e.top[1];let{from:s}=r[0];this.stacks=[Bi.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new kc(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],r,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let l=e[o];for(;;){if(this.tokens.mainToken=null,l.pos>t)n.push(l);else{if(this.advanceStack(l,n,e))continue;{r||(r=[],s=[]),r.push(l);let a=this.tokens.getMainToken(l);s.push(a.value,a.end)}}break}}if(!n.length){let o=r&&tP(r);if(o)return this.stackToTree(o);if(this.parser.strict)throw It&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let o=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,s,n);if(o)return this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((l,a)=>a.score-l.score);n.length>o;)n.pop();n.some(l=>l.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let o=0;o<n.length-1;o++){let l=n[o];for(let a=o+1;a<n.length;a++){let h=n[a];if(l.sameState(h)||l.buffer.length>500&&h.buffer.length>500)if((l.score-h.score||l.buffer.length-h.buffer.length)>0)n.splice(a--,1);else{n.splice(o--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let r=e.pos,{parser:s}=this,o=It?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let h=e.curContext&&e.curContext.tracker.strict,c=h?e.curContext.hash:0;for(let u=this.fragments.nodeAt(r);u;){let m=this.parser.nodeSet.types[u.type.id]==u.type?s.getGoto(e.state,u.type.id):-1;if(m>-1&&u.length&&(!h||(u.prop(Y.contextHash)||0)==c))return e.useNode(u,m),It&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(u.type.id)})`),!0;if(!(u instanceof fe)||u.children.length==0||u.positions[0]>0)break;let g=u.children[0];if(g instanceof fe&&u.positions[0]==0)u=g;else break}}let l=s.stateSlot(e.state,4);if(l>0)return e.reduce(l),It&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(l&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let h=0;h<a.length;){let c=a[h++],u=a[h++],m=a[h++],g=h==a.length||!n,y=g?e:e.split();if(y.apply(c,u,m),It&&console.log(o+this.stackID(y)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(u)} @ ${r}${y==e?"":", split"})`),g)return!0;y.pos>r?t.push(y):n.push(y)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return Xg(e,t),!0}}runRecovery(e,t,n){let r=null,s=!1;for(let o=0;o<e.length;o++){let l=e[o],a=t[o<<1],h=t[(o<<1)+1],c=It?this.stackID(l)+" -> ":"";if(l.deadEnd&&(s||(s=!0,l.restart(),It&&console.log(c+this.stackID(l)+" (restarted)"),this.advanceFully(l,n))))continue;let u=l.split(),m=c;for(let g=0;u.forceReduce()&&g<10&&(It&&console.log(m+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,n));g++)It&&(m=this.stackID(u)+" -> ");for(let g of l.recoverByInsert(a))It&&console.log(c+this.stackID(g)+" (via recover-insert)"),this.advanceFully(g,n);this.stream.end>l.pos?(h==l.pos&&(h++,a=0),l.recoverByDelete(a,h),It&&console.log(c+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),Xg(l,n)):(!r||r.score<l.score)&&(r=l)}return r}stackToTree(e){return e.close(),fe.build({buffer:Zi.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Pc||(Pc=new WeakMap)).get(e);return t||Pc.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}};function Xg(i,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==i.pos&&n.sameState(i)){e[t].score<i.score&&(e[t]=i);return}}e.push(i)}var Cc=class{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}},vc=i=>i,Ho=class{constructor(e){this.start=e.start,this.shift=e.shift||vc,this.reduce=e.reduce||vc,this.reuse=e.reuse||vc,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}},Jn=class extends _i{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let l=0;l<e.repeatNodeCount;l++)t.push("");let n=Object.keys(e.topRules).map(l=>e.topRules[l][1]),r=[];for(let l=0;l<t.length;l++)r.push([]);function s(l,a,h){r[l].push([a,a.deserialize(String(h))])}if(e.nodeProps)for(let l of e.nodeProps){let a=l[0];typeof a=="string"&&(a=Y[a]);for(let h=1;h<l.length;){let c=l[h++];if(c>=0)s(c,a,l[h++]);else{let u=l[h+-c];for(let m=-c;m>0;m--)s(l[h++],a,u);h++}}}this.nodeSet=new Un(t.map((l,a)=>Re.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:r[a],top:n.indexOf(a)>-1,error:a==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(a)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=1024;let o=Br(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(zg),this.states=Br(e.states,Uint32Array),this.data=Br(e.stateData),this.goto=Br(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new kn(o,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let r=new Ac(this,e,t,n);for(let s of this.wrappers)r=s(r,e,t,n);return r}getGoto(e,t,n=!1){let r=this.goto;if(t>=r[0])return-1;for(let s=r[t+1];;){let o=r[s++],l=o&1,a=r[s++];if(l&&n)return a;for(let h=s+(o>>1);s<h;s++)if(r[s]==e)return a;if(l)return-1}}hasAction(e,t){let n=this.data;for(let r=0;r<2;r++)for(let s=this.stateSlot(e,r?2:1),o;;s+=3){if((o=n[s])==65535)if(n[s+1]==1)o=n[s=en(n,s+2)];else{if(n[s+1]==2)return en(n,s+2);break}if(o==t||o==0)return en(n,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){if(t==this.stateSlot(e,4))return!0;for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=en(this.data,n+2);else return!1;if(t==en(this.data,n+1))return!0}}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=en(this.data,n+2);else break;if(!(this.data[n+2]&1)){let r=this.data[n+1];t.some((s,o)=>o&1&&s==r)||t.push(this.data[n],r)}}return t}configure(e){let t=Object.assign(Object.create(Jn.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let r=e.tokenizers.find(s=>s.from==n);return r?r.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,r)=>{let s=e.specializers.find(l=>l.from==n.external);if(!s)return n;let o=Object.assign(Object.assign({},n),{external:s.to});return t.specializers[r]=zg(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(n[o]=!0)}let r=null;for(let s=0;s<t.length;s++)if(!n[s])for(let o=this.dialects[t[s]],l;(l=this.data[o++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[l]=1;return new Cc(e,n,r)}static deserialize(e){return new Jn(e)}};function en(i,e){return i[e]|i[e+1]<<16}function tP(i){let e=null;for(let t of i){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function zg(i){if(i.external){let e=i.extend?1:0;return(t,n)=>i.external(t,n)<<1|e}return i.get}var nP=1,Gg=189,Jg=190,iP=191,rP=192,sP=193,oP=194,lP=22,aP=23,hP=47,cP=48,fP=53,uP=54,dP=55,pP=57,mP=58,gP=59,OP=60,yP=61,SP=63,bP=230,wP=71,xP=255,PP=121,vP=142,_P=143,$P=146,Zr=10,Vr=13,Wc=32,Go=9,Qc=35,TP=40,kP=46,IP=new Set([aP,hP,cP,xP,SP,PP,uP,dP,bP,OP,yP,mP,gP,wP,vP,_P,$P]),AP=new Vi((i,e)=>{if(i.next<0)i.acceptToken(oP);else if(!(i.next!=Zr&&i.next!=Vr))if(e.context.depth<0)i.acceptToken(rP,1);else{i.advance();let t=0;for(;i.next==Wc||i.next==Go;)i.advance(),t++;let n=i.next==Zr||i.next==Vr||i.next==Qc;i.acceptToken(n?sP:iP,-t)}},{contextual:!0,fallback:!0}),CP=new Vi((i,e)=>{let t=e.context.depth;if(t<0)return;let n=i.peek(-1);if((n==Zr||n==Vr)&&e.context.depth>=0){let r=0,s=0;for(;;){if(i.next==Wc)r++;else if(i.next==Go)r+=8-r%8;else break;i.advance(),s++}r!=t&&i.next!=Zr&&i.next!=Vr&&i.next!=Qc&&(r<t?i.acceptToken(Jg,-s):i.acceptToken(Gg))}});function Ec(i,e){this.parent=i,this.depth=e,this.hash=(i?i.hash+i.hash<<8:0)+e+(e<<4)}var EP=new Ec(null,0);function WP(i){let e=0;for(let t=0;t<i.length;t++)e+=i.charCodeAt(t)==Go?8-e%8:1;return e}var QP=new Ho({start:EP,reduce(i,e){return i.depth<0&&IP.has(e)?i.parent:i},shift(i,e,t,n){return e==Gg?new Ec(i,WP(n.read(n.pos,t.pos))):e==Jg?i.parent:e==lP||e==fP||e==pP?new Ec(i,-1):i},hash(i){return i.hash}}),RP=new Vi(i=>{for(let e=0;e<5;e++){if(i.next!="print".charCodeAt(e))return;i.advance()}if(!/\w/.test(String.fromCharCode(i.next)))for(let e=0;;e++){let t=i.peek(e);if(!(t==Wc||t==Go)){t!=TP&&t!=kP&&t!=Zr&&t!=Vr&&t!=Qc&&i.acceptToken(nP);return}}}),MP=go({'async "*" "**" FormatConversion FormatSpec':w.modifier,"for while if elif else try except finally return raise break continue with pass assert await yield match case":w.controlKeyword,"in not and or is del":w.operatorKeyword,"from def class global nonlocal lambda":w.definitionKeyword,import:w.moduleKeyword,"with as print":w.keyword,Boolean:w.bool,None:w.null,VariableName:w.variableName,"CallExpression/VariableName":w.function(w.variableName),"FunctionDefinition/VariableName":w.function(w.definition(w.variableName)),"ClassDefinition/VariableName":w.definition(w.className),PropertyName:w.propertyName,"CallExpression/MemberExpression/PropertyName":w.function(w.propertyName),Comment:w.lineComment,Number:w.number,String:w.string,FormatString:w.special(w.string),UpdateOp:w.updateOperator,"ArithOp!":w.arithmeticOperator,BitOp:w.bitwiseOperator,CompareOp:w.compareOperator,AssignOp:w.definitionOperator,Ellipsis:w.punctuation,At:w.meta,"( )":w.paren,"[ ]":w.squareBracket,"{ }":w.brace,".":w.derefOperator,", ;":w.separator}),DP={__proto__:null,await:40,or:50,and:52,in:56,not:58,is:60,if:66,else:68,lambda:72,yield:90,from:92,async:98,for:100,None:152,True:154,False:154,del:168,pass:172,break:176,continue:180,return:184,raise:192,import:196,as:198,global:202,nonlocal:204,assert:208,elif:218,while:222,try:228,except:230,finally:232,with:236,def:240,class:250,match:261,case:267},Kg=Jn.deserialize({version:14,states:"!LfO`Q$IXOOO%fQ$I[O'#G|OOQ$IS'#Cm'#CmOOQ$IS'#Cn'#CnO'UQ$IWO'#ClO(wQ$I[O'#G{OOQ$IS'#G|'#G|OOQ$IS'#DS'#DSOOQ$IS'#G{'#G{O)eQ$IWO'#D]O)xQ$IWO'#DdO*YQ$IWO'#DhOOQ$IS'#Ds'#DsO*mO`O'#DsO*uOpO'#DsO*}O!bO'#DtO+YO#tO'#DtO+eO&jO'#DtO+pO,UO'#DtO-rQ$I[O'#GmOOQ$IS'#Gm'#GmO'UQ$IWO'#GlO/UQ$I[O'#GlOOQ$IS'#E]'#E]O/mQ$IWO'#E^OOQ$IS'#Gk'#GkO/wQ$IWO'#GjOOQ$IV'#Gj'#GjO0SQ$IWO'#FPOOQ$IS'#GX'#GXO0XQ$IWO'#FOOOQ$IV'#Hx'#HxOOQ$IV'#Gi'#GiOOQ$IT'#Fh'#FhQ`Q$IXOOO'UQ$IWO'#CoO0gQ$IWO'#C{O0nQ$IWO'#DPO0|Q$IWO'#HQO1^Q$I[O'#EQO'UQ$IWO'#EROOQ$IS'#ET'#ETOOQ$IS'#EV'#EVOOQ$IS'#EX'#EXO1rQ$IWO'#EZO2YQ$IWO'#E_O0SQ$IWO'#EaO2mQ$I[O'#EaO0SQ$IWO'#EdO/mQ$IWO'#EgO/mQ$IWO'#EkO/mQ$IWO'#EnO2xQ$IWO'#EpO3PQ$IWO'#EuO3[Q$IWO'#EqO/mQ$IWO'#EuO0SQ$IWO'#EwO0SQ$IWO'#E|O3aQ$IWO'#FROOQ$IS'#Cc'#CcOOQ$IS'#Cd'#CdOOQ$IS'#Ce'#CeOOQ$IS'#Cf'#CfOOQ$IS'#Cg'#CgOOQ$IS'#Ch'#ChOOQ$IS'#Cj'#CjO'UQ$IWO,58|O'UQ$IWO,58|O'UQ$IWO,58|O'UQ$IWO,58|O'UQ$IWO,58|O'UQ$IWO,58|O3hQ$IWO'#DmOOQ$IS,5:W,5:WO3{Q$IWO'#H[OOQ$IS,5:Z,5:ZO4YQ%1`O,5:ZO4_Q$I[O,59WO0gQ$IWO,59`O0gQ$IWO,59`O0gQ$IWO,59`O6}Q$IWO,59`O7SQ$IWO,59`O7ZQ$IWO,59hO7bQ$IWO'#G{O8hQ$IWO'#GzOOQ$IS'#Gz'#GzOOQ$IS'#DY'#DYO9PQ$IWO,59_O'UQ$IWO,59_O9_Q$IWO,59_OOQ$IS,59w,59wO9dQ$IWO,5:PO'UQ$IWO,5:POOQ$IS,5:O,5:OO9rQ$IWO,5:OO9wQ$IWO,5:VO'UQ$IWO,5:VO'UQ$IWO,5:TOOQ$IS,5:S,5:SO:YQ$IWO,5:SO:_Q$IWO,5:UOOOO'#Fp'#FpO:dO`O,5:_OOQ$IS,5:_,5:_OOOO'#Fq'#FqO:lOpO,5:_O:tQ$IWO'#DuOOOO'#Fr'#FrO;UO!bO,5:`OOQ$IS,5:`,5:`OOOO'#Fu'#FuO;aO#tO,5:`OOOO'#Fv'#FvO;lO&jO,5:`OOOO'#Fw'#FwO;wO,UO,5:`OOQ$IS'#Fx'#FxO<SQ$I[O,5:dO>tQ$I[O,5=WO?_Q%GlO,5=WO@OQ$I[O,5=WOOQ$IS,5:x,5:xO@gQ$IXO'#GQOAvQ$IWO,5;TOOQ$IV,5=U,5=UOBRQ$I[O'#HtOBjQ$IWO,5;kOOQ$IS-E:V-E:VOOQ$IV,5;j,5;jO3VQ$IWO'#EwOOQ$IT-E9f-E9fOBrQ$I[O,59ZODyQ$I[O,59gOEdQ$IWO'#G}OEoQ$IWO'#G}O0SQ$IWO'#G}OEzQ$IWO'#DROFSQ$IWO,59kOFXQ$IWO'#HRO'UQ$IWO'#HRO/mQ$IWO,5=lOOQ$IS,5=l,5=lO/mQ$IWO'#D|OOQ$IS'#D}'#D}OFvQ$IWO'#FzOGWQ$IWO,58zOGWQ$IWO,58zO)kQ$IWO,5:jOGfQ$I[O'#HTOOQ$IS,5:m,5:mOOQ$IS,5:u,5:uOGyQ$IWO,5:yOH[Q$IWO,5:{OOQ$IS'#F}'#F}OHjQ$I[O,5:{OHxQ$IWO,5:{OH}Q$IWO'#HwOOQ$IS,5;O,5;OOI]Q$IWO'#HsOOQ$IS,5;R,5;RO3[Q$IWO,5;VO3[Q$IWO,5;YOInQ$I[O'#HyO'UQ$IWO'#HyOIxQ$IWO,5;[O2xQ$IWO,5;[O/mQ$IWO,5;aO0SQ$IWO,5;cOI}Q$IXO'#ElOKWQ$IZO,5;]ONlQ$IWO'#HzO3[Q$IWO,5;aONwQ$IWO,5;cON|Q$IWO,5;hO! UQ$I[O,5;mO'UQ$IWO,5;mO!#xQ$I[O1G.hO!$PQ$I[O1G.hO!&pQ$I[O1G.hO!&zQ$I[O1G.hO!)eQ$I[O1G.hO!)xQ$I[O1G.hO!*]Q$IWO'#HZO!*kQ$I[O'#GmO/mQ$IWO'#HZO!*uQ$IWO'#HYOOQ$IS,5:X,5:XO!*}Q$IWO,5:XO!+SQ$IWO'#H]O!+_Q$IWO'#H]O!+rQ$IWO,5=vOOQ$IS'#Dq'#DqOOQ$IS1G/u1G/uOOQ$IS1G.z1G.zO!,rQ$I[O1G.zO!,yQ$I[O1G.zO0gQ$IWO1G.zO!-fQ$IWO1G/SOOQ$IS'#DX'#DXO/mQ$IWO,59rOOQ$IS1G.y1G.yO!-mQ$IWO1G/cO!-}Q$IWO1G/cO!.VQ$IWO1G/dO'UQ$IWO'#HSO!.[Q$IWO'#HSO!.aQ$I[O1G.yO!.qQ$IWO,59gO!/wQ$IWO,5=rO!0XQ$IWO,5=rO!0aQ$IWO1G/kO!0fQ$I[O1G/kOOQ$IS1G/j1G/jO!0vQ$IWO,5=mO!1mQ$IWO,5=mO/mQ$IWO1G/oO!2[Q$IWO1G/qO!2aQ$I[O1G/qO!2qQ$I[O1G/oOOQ$IS1G/n1G/nOOQ$IS1G/p1G/pOOOO-E9n-E9nOOQ$IS1G/y1G/yOOOO-E9o-E9oO!3RQ$IWO'#HhO/mQ$IWO'#HhO!3aQ$IWO,5:aOOOO-E9p-E9pOOQ$IS1G/z1G/zOOOO-E9s-E9sOOOO-E9t-E9tOOOO-E9u-E9uOOQ$IS-E9v-E9vO!3lQ%GlO1G2rO!4]Q$I[O1G2rO'UQ$IWO,5<eOOQ$IS,5<e,5<eOOQ$IS-E9w-E9wOOQ$IS,5<l,5<lOOQ$IS-E:O-E:OOOQ$IV1G0o1G0oO0SQ$IWO'#F|O!4tQ$I[O,5>`OOQ$IS1G1V1G1VO!5]Q$IWO1G1VOOQ$IS'#DT'#DTO/mQ$IWO,5=iOOQ$IS,5=i,5=iO!5bQ$IWO'#FiO!5mQ$IWO,59mO!5uQ$IWO1G/VO!6PQ$I[O,5=mOOQ$IS1G3W1G3WOOQ$IS,5:h,5:hO!6pQ$IWO'#GlOOQ$IS,5<f,5<fOOQ$IS-E9x-E9xO!7RQ$IWO1G.fOOQ$IS1G0U1G0UO!7aQ$IWO,5=oO!7qQ$IWO,5=oO/mQ$IWO1G0eO/mQ$IWO1G0eO0SQ$IWO1G0gOOQ$IS-E9{-E9{O!8SQ$IWO1G0gO!8_Q$IWO1G0gO!8dQ$IWO,5>cO!8rQ$IWO,5>cO!9QQ$IWO,5>_O!9hQ$IWO,5>_O!9yQ$IZO1G0qO!=[Q$IZO1G0tO!@jQ$IWO,5>eO!@tQ$IWO,5>eO!@|Q$I[O,5>eO/mQ$IWO1G0vO!AWQ$IWO1G0vO3[Q$IWO1G0{ONwQ$IWO1G0}OOQ$IV,5;W,5;WO!A]Q$IYO,5;WO!AbQ$IZO1G0wO!DvQ$IWO'#GUO3[Q$IWO1G0wO3[Q$IWO1G0wO!ETQ$IWO,5>fO!EbQ$IWO,5>fO0SQ$IWO,5>fOOQ$IV1G0{1G0{O!EjQ$IWO'#EyO!E{Q%1`O1G0}OOQ$IV1G1S1G1SO3[Q$IWO1G1SO!FTQ$IWO'#FTOOQ$IV1G1X1G1XO! UQ$I[O1G1XOOQ$IS,5=u,5=uOOQ$IS'#Dn'#DnO/mQ$IWO,5=uO!FYQ$IWO,5=tO!FmQ$IWO,5=tOOQ$IS1G/s1G/sO!FuQ$IWO,5=wO!GVQ$IWO,5=wO!G_Q$IWO,5=wO!GrQ$IWO,5=wO!HSQ$IWO,5=wOOQ$IS1G3b1G3bOOQ$IS7+$f7+$fO!5uQ$IWO7+$nO!IuQ$IWO1G.zO!I|Q$IWO1G.zOOQ$IS1G/^1G/^OOQ$IS,5<V,5<VO'UQ$IWO,5<VOOQ$IS7+$}7+$}O!JTQ$IWO7+$}OOQ$IS-E9i-E9iOOQ$IS7+%O7+%OO!JeQ$IWO,5=nO'UQ$IWO,5=nOOQ$IS7+$e7+$eO!JjQ$IWO7+$}O!JrQ$IWO7+%OO!JwQ$IWO1G3^OOQ$IS7+%V7+%VO!KXQ$IWO1G3^O!KaQ$IWO7+%VOOQ$IS,5<U,5<UO'UQ$IWO,5<UO!KfQ$IWO1G3XOOQ$IS-E9h-E9hO!L]Q$IWO7+%ZOOQ$IS7+%]7+%]O!LkQ$IWO1G3XO!MYQ$IWO7+%]O!M_Q$IWO1G3_O!MoQ$IWO1G3_O!MwQ$IWO7+%ZO!M|Q$IWO,5>SO!NdQ$IWO,5>SO!NdQ$IWO,5>SO!NrO!LQO'#DwO!N}OSO'#HiOOOO1G/{1G/{O# SQ$IWO1G/{O# [Q%GlO7+(^O# {Q$I[O1G2PP#!fQ$IWO'#FyOOQ$IS,5<h,5<hOOQ$IS-E9z-E9zOOQ$IS7+&q7+&qOOQ$IS1G3T1G3TOOQ$IS,5<T,5<TOOQ$IS-E9g-E9gOOQ$IS7+$q7+$qO#!sQ$IWO,5=WO##^Q$IWO,5=WO##oQ$I[O,5<WO#$SQ$IWO1G3ZOOQ$IS-E9j-E9jOOQ$IS7+&P7+&PO#$dQ$IWO7+&POOQ$IS7+&R7+&RO#$rQ$IWO'#HvO0SQ$IWO'#HuO#%WQ$IWO7+&ROOQ$IS,5<k,5<kO#%cQ$IWO1G3}OOQ$IS-E9}-E9}OOQ$IS,5<g,5<gO#%qQ$IWO1G3yOOQ$IS-E9y-E9yO#&XQ$IZO7+&]O!DvQ$IWO'#GSO3[Q$IWO7+&]O3[Q$IWO7+&`O#)jQ$I[O,5<oO'UQ$IWO,5<oO#)tQ$IWO1G4POOQ$IS-E:R-E:RO#*OQ$IWO1G4PO3[Q$IWO7+&bO/mQ$IWO7+&bOOQ$IV7+&g7+&gO!E{Q%1`O7+&iO#*WQ$IXO1G0rOOQ$IV-E:S-E:SO3[Q$IWO7+&cO3[Q$IWO7+&cOOQ$IV,5<p,5<pO#+|Q$IWO,5<pOOQ$IV7+&c7+&cO#,XQ$IZO7+&cO#/gQ$IWO,5<qO#/rQ$IWO1G4QOOQ$IS-E:T-E:TO#0PQ$IWO1G4QO#0XQ$IWO'#H|O#0gQ$IWO'#H|O0SQ$IWO'#H|OOQ$IS'#H|'#H|O#0rQ$IWO'#H{OOQ$IS,5;e,5;eO#0zQ$IWO,5;eO/mQ$IWO'#E{OOQ$IV7+&i7+&iO3[Q$IWO7+&iOOQ$IV7+&n7+&nO#1PQ$IYO,5;oOOQ$IV7+&s7+&sOOQ$IS1G3a1G3aOOQ$IS,5<Y,5<YO#1UQ$IWO1G3`OOQ$IS-E9l-E9lO#1iQ$IWO,5<ZO#1tQ$IWO,5<ZO#2XQ$IWO1G3cOOQ$IS-E9m-E9mO#2iQ$IWO1G3cO#2qQ$IWO1G3cO#3RQ$IWO1G3cO#2iQ$IWO1G3cOOQ$IS<<HY<<HYO#3^Q$I[O1G1qOOQ$IS<<Hi<<HiP#3kQ$IWO'#FkO7ZQ$IWO1G3YO#3xQ$IWO1G3YO#3}Q$IWO<<HiOOQ$IS<<Hj<<HjO#4_Q$IWO7+(xOOQ$IS<<Hq<<HqO#4oQ$I[O1G1pP#5`Q$IWO'#FjO#5mQ$IWO7+(yO#5}Q$IWO7+(yO#6VQ$IWO<<HuO#6[Q$IWO7+(sOOQ$IS<<Hw<<HwO#7RQ$IWO,5<XO'UQ$IWO,5<XOOQ$IS-E9k-E9kOOQ$IS<<Hu<<HuOOQ$IS,5<_,5<_O/mQ$IWO,5<_O#7WQ$IWO1G3nOOQ$IS-E9q-E9qO#7nQ$IWO1G3nOOOO'#Ft'#FtO#7|O!LQO,5:cOOOO,5>T,5>TOOOO7+%g7+%gO#8XQ$IWO1G2rO#8rQ$IWO1G2rP'UQ$IWO'#FlO/mQ$IWO<<IkO#9TQ$IWO,5>bO#9fQ$IWO,5>bO0SQ$IWO,5>bO#9wQ$IWO,5>aOOQ$IS<<Im<<ImP0SQ$IWO'#GPP/mQ$IWO'#F{OOQ$IV-E:Q-E:QO3[Q$IWO<<IwOOQ$IV,5<n,5<nO3[Q$IWO,5<nOOQ$IV<<Iw<<IwOOQ$IV<<Iz<<IzO#9|Q$I[O1G2ZP#:WQ$IWO'#GTO#:_Q$IWO7+)kO#:iQ$IZO<<I|O3[Q$IWO<<I|OOQ$IV<<JT<<JTO3[Q$IWO<<JTOOQ$IV'#GR'#GRO#=wQ$IZO7+&^OOQ$IV<<I}<<I}O#?sQ$IZO<<I}OOQ$IV1G2[1G2[O0SQ$IWO1G2[O3[Q$IWO<<I}O0SQ$IWO1G2]P/mQ$IWO'#GVO#CRQ$IWO7+)lO#C`Q$IWO7+)lOOQ$IS'#Ez'#EzO/mQ$IWO,5>hO#ChQ$IWO,5>hOOQ$IS,5>h,5>hO#CsQ$IWO,5>gO#DUQ$IWO,5>gOOQ$IS1G1P1G1POOQ$IS,5;g,5;gO#D^Q$IWO1G1ZP#DcQ$IWO'#FnO#DsQ$IWO1G1uO#EWQ$IWO1G1uO#EhQ$IWO1G1uP#EsQ$IWO'#FoO#FQQ$IWO7+(}O#FbQ$IWO7+(}O#FbQ$IWO7+(}O#FjQ$IWO7+(}O#FzQ$IWO7+(tO7ZQ$IWO7+(tOOQ$ISAN>TAN>TO#GeQ$IWO<<LeOOQ$ISAN>aAN>aO/mQ$IWO1G1sO#GuQ$I[O1G1sP#HPQ$IWO'#FmOOQ$IS1G1y1G1yP#H^Q$IWO'#FsO#HkQ$IWO7+)YOOOO-E9r-E9rO#IRQ$IWO7+(^OOQ$ISAN?VAN?VO#IlQ$IWO,5<jO#JQQ$IWO1G3|OOQ$IS-E9|-E9|O#JcQ$IWO1G3|OOQ$IS1G3{1G3{OOQ$IVAN?cAN?cOOQ$IV1G2Y1G2YO3[Q$IWOAN?hO#JtQ$IZOAN?hOOQ$IVAN?oAN?oOOQ$IV-E:P-E:POOQ$IV<<Ix<<IxO3[Q$IWOAN?iO3[Q$IWO7+'vOOQ$IVAN?iAN?iOOQ$IS7+'w7+'wO#NSQ$IWO<<MWOOQ$IS1G4S1G4SO/mQ$IWO1G4SOOQ$IS,5<r,5<rO#NaQ$IWO1G4ROOQ$IS-E:U-E:UOOQ$IU'#GY'#GYO#NrQ$IYO7+&uO#N}Q$IWO'#FUO$ uQ$IWO7+'aO$!VQ$IWO7+'aOOQ$IS7+'a7+'aO$!bQ$IWO<<LiO$!rQ$IWO<<LiO$!rQ$IWO<<LiO$!zQ$IWO'#HUOOQ$IS<<L`<<L`O$#UQ$IWO<<L`OOQ$IS7+'_7+'_O0SQ$IWO1G2UP0SQ$IWO'#GOO$#oQ$IWO7+)hO$$QQ$IWO7+)hOOQ$IVG25SG25SO3[Q$IWOG25SOOQ$IVG25TG25TOOQ$IV<<Kb<<KbOOQ$IS7+)n7+)nP$$cQ$IWO'#GWOOQ$IU-E:W-E:WOOQ$IV<<Ja<<JaO$%VQ$I[O'#FWOOQ$IS'#FY'#FYO$%gQ$IWO'#FXO$&XQ$IWO'#FXOOQ$IS'#FX'#FXO$&^Q$IWO'#IOO#N}Q$IWO'#F`O#N}Q$IWO'#F`O$&uQ$IWO'#FaO#N}Q$IWO'#FbO$&|Q$IWO'#IPOOQ$IS'#IP'#IPO$'kQ$IWO,5;pOOQ$IS<<J{<<J{O$'sQ$IWO<<J{O$(TQ$IWOANBTO$(eQ$IWOANBTO$(mQ$IWO'#HVOOQ$IS'#HV'#HVO0nQ$IWO'#DaO$)WQ$IWO,5=pOOQ$ISANAzANAzOOQ$IS7+'p7+'pO$)oQ$IWO<<MSOOQ$IVLD*nLD*nO4YQ%1`O'#G[O$*QQ$I[O,5;yO#N}Q$IWO'#FdOOQ$IS,5;},5;}OOQ$IS'#FZ'#FZO$*rQ$IWO,5;sO$*wQ$IWO,5;sOOQ$IS'#F^'#F^O#N}Q$IWO'#GZO$+iQ$IWO,5;wO$,TQ$IWO,5>jO$,eQ$IWO,5>jO0SQ$IWO,5;vO$,vQ$IWO,5;zO$,{Q$IWO,5;zO#N}Q$IWO'#IQO$-QQ$IWO'#IQO$-VQ$IWO,5;{OOQ$IS,5;|,5;|O'UQ$IWO'#FgOOQ$IU1G1[1G1[O3[Q$IWO1G1[OOQ$ISAN@gAN@gO$-[Q$IWOG27oO$-lQ$IWO,59{OOQ$IS1G3[1G3[OOQ$IS,5<v,5<vOOQ$IS-E:Y-E:YO$-qQ$I[O'#FWO$-xQ$IWO'#IRO$.WQ$IWO'#IRO$.`Q$IWO,5<OOOQ$IS1G1_1G1_O$.eQ$IWO1G1_O$.jQ$IWO,5<uOOQ$IS-E:X-E:XO$/UQ$IWO,5<yO$/mQ$IWO1G4UOOQ$IS-E:]-E:]OOQ$IS1G1b1G1bOOQ$IS1G1f1G1fO$/}Q$IWO,5>lO#N}Q$IWO,5>lOOQ$IS1G1g1G1gO$0]Q$I[O,5<ROOQ$IU7+&v7+&vO$!zQ$IWO1G/gO#N}Q$IWO,5<PO$0dQ$IWO,5>mO$0kQ$IWO,5>mOOQ$IS1G1j1G1jOOQ$IS7+&y7+&yP#N}Q$IWO'#G_O$0sQ$IWO1G4WO$0}Q$IWO1G4WO$1VQ$IWO1G4WOOQ$IS7+%R7+%RO$1eQ$IWO1G1kO$1sQ$I[O'#FWO$1zQ$IWO,5<xOOQ$IS,5<x,5<xO$2YQ$IWO1G4XOOQ$IS-E:[-E:[O#N}Q$IWO,5<wO$2aQ$IWO,5<wO$2fQ$IWO7+)rOOQ$IS-E:Z-E:ZO$2pQ$IWO7+)rO#N}Q$IWO,5<QP#N}Q$IWO'#G^O$2xQ$IWO1G2cO#N}Q$IWO1G2cP$3WQ$IWO'#G]O$3_Q$IWO<<M^O$3iQ$IWO1G1lO$3wQ$IWO7+'}O7ZQ$IWO'#C{O7ZQ$IWO,59`O7ZQ$IWO,59`O7ZQ$IWO,59`O$4VQ$I[O,5=WO7ZQ$IWO1G.zO/mQ$IWO1G/VO/mQ$IWO7+$nP$4jQ$IWO'#FyO'UQ$IWO'#GlO$4wQ$IWO,59`O$4|Q$IWO,59`O$5TQ$IWO,59kO$5YQ$IWO1G/SO0nQ$IWO'#DPO7ZQ$IWO,59h",stateData:"$5p~O%[OS%XOS%WOSQOS~OPhOTeOdsOfXOmtOq!SOtuO}vO!O!PO!R!VO!S!UO!VYO!ZZO!fdO!mdO!ndO!odO!vxO!xyO!zzO!|{O#O|O#S}O#U!OO#X!QO#Y!QO#[!RO#c!TO#f!WO#j!XO#l!YO#q!ZO#tlO#v![O%VqO%gQO%hQO%lRO%mVO&R[O&S]O&V^O&Y_O&``O&caO&ebO~OT!bO]!bO_!cOf!jO!V!lO!d!nO%b!]O%c!^O%d!_O%e!`O%f!`O%g!aO%h!aO%i!bO%j!bO%k!bO~Oi%pXj%pXk%pXl%pXm%pXn%pXq%pXx%pXy%pX!s%pX#^%pX%V%pX%Y%pX%r%pXe%pX!R%pX!S%pX%s%pX!U%pX!Y%pX!O%pX#V%pXr%pX!j%pX~P$bOdsOfXO!VYO!ZZO!fdO!mdO!ndO!odO%gQO%hQO%lRO%mVO&R[O&S]O&V^O&Y_O&``O&caO&ebO~Ox%oXy%oX#^%oX%V%oX%Y%oX%r%oX~Oi!qOj!rOk!pOl!pOm!sOn!tOq!uO!s%oX~P(cOT!{Oe!}Om/jOt/xO}vO~P'UOT#POm/jOt/xO!U#QO~P'UOT#TO_#UOm/jOt/xO!Y#VO~P'UO&T#YO&U#[O~O&W#]O&X#[O~O!Z#_O&Z#`O&_#bO~O!Z#_O&a#cO&b#bO~O!Z#_O&U#bO&d#eO~O!Z#_O&X#bO&f#gO~OT%aX]%aX_%aXf%aXi%aXj%aXk%aXl%aXm%aXn%aXq%aXx%aX!V%aX!d%aX%b%aX%c%aX%d%aX%e%aX%f%aX%g%aX%h%aX%i%aX%j%aX%k%aXe%aX!R%aX!S%aX~O&R[O&S]O&V^O&Y_O&``O&caO&ebOy%aX!s%aX#^%aX%V%aX%Y%aX%r%aX%s%aX!U%aX!Y%aX!O%aX#V%aXr%aX!j%aX~P+{Ox#lOy%`X!s%`X#^%`X%V%`X%Y%`X%r%`X~Om/jOt/xO~P'UO#^#oO%V#qO%Y#qO~O%mVO~O!R#vO#l!YO#q!ZO#tlO~OmtO~P'UOT#{O_#|O%mVOyuP~OT$QOm/jOt/xO!O$RO~P'UOy$TO!s$YO%r$UO#^!tX%V!tX%Y!tX~OT$QOm/jOt/xO#^!}X%V!}X%Y!}X~P'UOm/jOt/xO#^#RX%V#RX%Y#RX~P'UO!d$`O!m$`O%mVO~OT$jO~P'UO!S$lO#j$mO#l$nO~Oy$oO~OT$vO~P'UOT%PO_%POe%ROm/jOt/xO~P'UOm/jOt/xOy%UO~P'UO&Q%WO~O_!cOf!jO!V!lO!d!nOT`a]`ai`aj`ak`al`am`an`aq`ax`ay`a!s`a#^`a%V`a%Y`a%b`a%c`a%d`a%e`a%f`a%g`a%h`a%i`a%j`a%k`a%r`ae`a!R`a!S`a%s`a!U`a!Y`a!O`a#V`ar`a!j`a~Ol%]O~Om%]O~P'UOm/jO~P'UOi/lOj/mOk/kOl/kOm/tOn/uOq/yOe%oX!R%oX!S%oX%s%oX!U%oX!Y%oX!O%oX#V%oX!j%oX~P(cO%s%_Oe%nXx%nX!R%nX!S%nX!U%nXy%nX~Oe%aOx%bO!R%fO!S%eO~Oe%aO~Ox%iO!R%fO!S%eO!U%zX~O!U%mO~Ox%nOy%pO!R%fO!S%eO!Y%uX~O!Y%tO~O!Y%uO~O&T#YO&U%wO~O&W#]O&X%wO~OT%zOm/jOt/xO}vO~P'UO!Z#_O&Z#`O&_%}O~O!Z#_O&a#cO&b%}O~O!Z#_O&U%}O&d#eO~O!Z#_O&X%}O&f#gO~OT!la]!la_!laf!lai!laj!lak!lal!lam!lan!laq!lax!lay!la!V!la!d!la!s!la#^!la%V!la%Y!la%b!la%c!la%d!la%e!la%f!la%g!la%h!la%i!la%j!la%k!la%r!lae!la!R!la!S!la%s!la!U!la!Y!la!O!la#V!lar!la!j!la~P#yOx&SOy%`a!s%`a#^%`a%V%`a%Y%`a%r%`a~P$bOT&UOmtOtuOy%`a!s%`a#^%`a%V%`a%Y%`a%r%`a~P'UOx&SOy%`a!s%`a#^%`a%V%`a%Y%`a%r%`a~OPhOTeOmtOtuO}vO!O!PO!vxO!xyO!zzO!|{O#O|O#S}O#U!OO#X!QO#Y!QO#[!RO#^$tX%V$tX%Y$tX~P'UO#^#oO%V&ZO%Y&ZO~O!d&[Of&hX%V&hX#V&hX#^&hX%Y&hX#U&hX~Of!jO%V&^O~Oicajcakcalcamcancaqcaxcayca!sca#^ca%Vca%Yca%rcaeca!Rca!Sca%sca!Uca!Yca!Oca#Vcarca!jca~P$bOqoaxoayoa#^oa%Voa%Yoa%roa~Oi!qOj!rOk!pOl!pOm!sOn!tO!soa~PDbO%r&`Ox%qXy%qX~O%mVOx%qXy%qX~Ox&cOyuX~Oy&eO~Ox%nO#^%uX%V%uX%Y%uXe%uXy%uX!Y%uX!j%uX%r%uX~OT/sOm/jOt/xO}vO~P'UO%r$UO#^Sa%VSa%YSa~Ox&nO#^%wX%V%wX%Y%wXl%wX~P$bOx&qO!O&pO#^#Ra%V#Ra%Y#Ra~O#V&rO#^#Ta%V#Ta%Y#Ta~O!d$`O!m$`O#U&tO%mVO~O#U&tO~Ox&vO#^&kX%V&kX%Y&kX~Ox&xO#^&gX%V&gX%Y&gXy&gX~Ox&|Ol&mX~P$bOl'PO~OPhOTeOmtOtuO}vO!O!PO!vxO!xyO!zzO!|{O#O|O#S}O#U!OO#X!QO#Y!QO#[!RO%V'UO~P'UOr'YO#g'WO#h'XOP#eaT#ead#eaf#eam#eaq#eat#ea}#ea!O#ea!R#ea!S#ea!V#ea!Z#ea!f#ea!m#ea!n#ea!o#ea!v#ea!x#ea!z#ea!|#ea#O#ea#S#ea#U#ea#X#ea#Y#ea#[#ea#c#ea#f#ea#j#ea#l#ea#q#ea#t#ea#v#ea%S#ea%V#ea%g#ea%h#ea%l#ea%m#ea&R#ea&S#ea&V#ea&Y#ea&`#ea&c#ea&e#ea%U#ea%Y#ea~Ox'ZO#V']Oy&nX~Of'_O~Of!jOy$oO~Oy'cO~P$bOT!bO]!bO_!cOf!jO!V!lO!d!nO%d!_O%e!`O%f!`O%g!aO%h!aO%i!bO%j!bO%k!bOiUijUikUilUimUinUiqUixUiyUi!sUi#^Ui%VUi%YUi%bUi%rUieUi!RUi!SUi%sUi!UUi!YUi!OUi#VUirUi!jUi~O%c!^O~P! ]O%cUi~P! ]OT!bO]!bO_!cOf!jO!V!lO!d!nO%g!aO%h!aO%i!bO%j!bO%k!bOiUijUikUilUimUinUiqUixUiyUi!sUi#^Ui%VUi%YUi%bUi%cUi%dUi%rUieUi!RUi!SUi%sUi!UUi!YUi!OUi#VUirUi!jUi~O%e!`O%f!`O~P!$WO%eUi%fUi~P!$WO_!cOf!jO!V!lO!d!nOiUijUikUilUimUinUiqUixUiyUi!sUi#^Ui%VUi%YUi%bUi%cUi%dUi%eUi%fUi%gUi%hUi%rUieUi!RUi!SUi%sUi!UUi!YUi!OUi#VUirUi!jUi~OT!bO]!bO%i!bO%j!bO%k!bO~P!'UOTUi]Ui%iUi%jUi%kUi~P!'UO!R%fO!S%eOe%}Xx%}X~O%r'gO%s'gO~P+{Ox'iOe%|X~Oe'kO~Ox'lOy'nO!U&PX~Om/jOt/xOx'lOy'oO!U&PX~P'UO!U'qO~Ok!pOl!pOm!sOn!tOihiqhixhiyhi!shi#^hi%Vhi%Yhi%rhi~Oj!rO~P!+wOjhi~P!+wOi/lOj/mOk/kOl/kOm/tOn/uO~Or'sO~P!-QOT'xOe'yOm/jOt/xO~P'UOe'yOx'zO~Oe'|O~O!S(OO~Oe(POx'zO!R%fO!S%eO~P$bOi/lOj/mOk/kOl/kOm/tOn/uOeoa!Roa!Soa%soa!Uoa!Yoa!Ooa#Voaroa!joa~PDbOT'xOm/jOt/xO!U%za~P'UOx(SO!U%za~O!U(TO~Ox(SO!R%fO!S%eO!U%za~P$bOT(XOm/jOt/xO!Y%ua#^%ua%V%ua%Y%uae%uay%ua!j%ua%r%ua~P'UOx(YO!Y%ua#^%ua%V%ua%Y%uae%uay%ua!j%ua%r%ua~O!Y(]O~Ox(YO!R%fO!S%eO!Y%ua~P$bOx(`O!R%fO!S%eO!Y%{a~P$bOx(cOy&[X!Y&[X!j&[X~Oy(fO!Y(hO!j(iO~OT&UOmtOtuOy%`i!s%`i#^%`i%V%`i%Y%`i%r%`i~P'UOx(jOy%`i!s%`i#^%`i%V%`i%Y%`i%r%`i~O!d&[Of&ha%V&ha#V&ha#^&ha%Y&ha#U&ha~O%V(oO~OT#{O_#|O%mVO~Ox&cOyua~OmtOtuO~P'UOx(YO#^%ua%V%ua%Y%uae%uay%ua!Y%ua!j%ua%r%ua~P$bOx(tO#^%`X%V%`X%Y%`X%r%`X~O%r$UO#^Si%VSi%YSi~O#^%wa%V%wa%Y%wal%wa~P'UOx(wO#^%wa%V%wa%Y%wal%wa~OT({Of(}O%mVO~O#U)OO~O%mVO#^&ka%V&ka%Y&ka~Ox)QO#^&ka%V&ka%Y&ka~Om/jOt/xO#^&ga%V&ga%Y&gay&ga~P'UOx)TO#^&ga%V&ga%Y&gay&ga~Or)XO#a)WOP#_iT#_id#_if#_im#_iq#_it#_i}#_i!O#_i!R#_i!S#_i!V#_i!Z#_i!f#_i!m#_i!n#_i!o#_i!v#_i!x#_i!z#_i!|#_i#O#_i#S#_i#U#_i#X#_i#Y#_i#[#_i#c#_i#f#_i#j#_i#l#_i#q#_i#t#_i#v#_i%S#_i%V#_i%g#_i%h#_i%l#_i%m#_i&R#_i&S#_i&V#_i&Y#_i&`#_i&c#_i&e#_i%U#_i%Y#_i~Or)YOP#biT#bid#bif#bim#biq#bit#bi}#bi!O#bi!R#bi!S#bi!V#bi!Z#bi!f#bi!m#bi!n#bi!o#bi!v#bi!x#bi!z#bi!|#bi#O#bi#S#bi#U#bi#X#bi#Y#bi#[#bi#c#bi#f#bi#j#bi#l#bi#q#bi#t#bi#v#bi%S#bi%V#bi%g#bi%h#bi%l#bi%m#bi&R#bi&S#bi&V#bi&Y#bi&`#bi&c#bi&e#bi%U#bi%Y#bi~OT)[Ol&ma~P'UOx)]Ol&ma~Ox)]Ol&ma~P$bOl)aO~O%T)dO~Or)gO#g'WO#h)fOP#eiT#eid#eif#eim#eiq#eit#ei}#ei!O#ei!R#ei!S#ei!V#ei!Z#ei!f#ei!m#ei!n#ei!o#ei!v#ei!x#ei!z#ei!|#ei#O#ei#S#ei#U#ei#X#ei#Y#ei#[#ei#c#ei#f#ei#j#ei#l#ei#q#ei#t#ei#v#ei%S#ei%V#ei%g#ei%h#ei%l#ei%m#ei&R#ei&S#ei&V#ei&Y#ei&`#ei&c#ei&e#ei%U#ei%Y#ei~Om/jOt/xOy$oO~P'UOm/jOt/xOy&na~P'UOx)mOy&na~OT)qO_)rOe)uO%i)sO%mVO~Oy$oO&q)wO~O%V){O~OT%PO_%POm/jOt/xOe%|a~P'UOx*POe%|a~Om/jOt/xOy*SO!U&Pa~P'UOx*TO!U&Pa~Om/jOt/xOx*TOy*WO!U&Pa~P'UOm/jOt/xOx*TO!U&Pa~P'UOx*TOy*WO!U&Pa~Ok/kOl/kOm/tOn/uOehiihiqhixhi!Rhi!Shi%shi!Uhiyhi!Yhi#^hi%Vhi%Yhi!Ohi#Vhirhi!jhi%rhi~Oj/mO~P!H_Ojhi~P!H_OT'xOe*]Om/jOt/xO~P'UOl*_O~Oe*]Ox*aO~Oe*bO~OT'xOm/jOt/xO!U%zi~P'UOx*cO!U%zi~O!U*dO~OT(XOm/jOt/xO!Y%ui#^%ui%V%ui%Y%uie%uiy%ui!j%ui%r%ui~P'UOx*gO!R%fO!S%eO!Y%{i~Ox*jO!Y%ui#^%ui%V%ui%Y%uie%uiy%ui!j%ui%r%ui~O!Y*kO~O_*mOm/jOt/xO!Y%{i~P'UOx*gO!Y%{i~O!Y*oO~OT*qOm/jOt/xOy&[a!Y&[a!j&[a~P'UOx*rOy&[a!Y&[a!j&[a~O!Z#_O&^*uO!Y!kX~O!Y*wO~Oy(fO!Y*xO~OT&UOmtOtuOy%`q!s%`q#^%`q%V%`q%Y%`q%r%`q~P'UOx$miy$mi!s$mi#^$mi%V$mi%Y$mi%r$mi~P$bOT&UOmtOtuO~P'UOT&UOm/jOt/xO#^%`a%V%`a%Y%`a%r%`a~P'UOx*yO#^%`a%V%`a%Y%`a%r%`a~Ox$`a#^$`a%V$`a%Y$`al$`a~P$bO#^%wi%V%wi%Y%wil%wi~P'UOx*|O#^#Rq%V#Rq%Y#Rq~Ox*}O#V+PO#^&jX%V&jX%Y&jXe&jX~OT+ROf(}O%mVO~O%mVO#^&ki%V&ki%Y&ki~Om/jOt/xO#^&gi%V&gi%Y&giy&gi~P'UOr+VO#a)WOP#_qT#_qd#_qf#_qm#_qq#_qt#_q}#_q!O#_q!R#_q!S#_q!V#_q!Z#_q!f#_q!m#_q!n#_q!o#_q!v#_q!x#_q!z#_q!|#_q#O#_q#S#_q#U#_q#X#_q#Y#_q#[#_q#c#_q#f#_q#j#_q#l#_q#q#_q#t#_q#v#_q%S#_q%V#_q%g#_q%h#_q%l#_q%m#_q&R#_q&S#_q&V#_q&Y#_q&`#_q&c#_q&e#_q%U#_q%Y#_q~Ol$wax$wa~P$bOT)[Ol&mi~P'UOx+^Ol&mi~OPhOTeOmtOq!SOtuO}vO!O!PO!R!VO!S!UO!vxO!xyO!zzO!|{O#O|O#S}O#U!OO#X!QO#Y!QO#[!RO#c!TO#f!WO#j!XO#l!YO#q!ZO#tlO#v![O~P'UOx+hOy$oO#V+hO~O#h+iOP#eqT#eqd#eqf#eqm#eqq#eqt#eq}#eq!O#eq!R#eq!S#eq!V#eq!Z#eq!f#eq!m#eq!n#eq!o#eq!v#eq!x#eq!z#eq!|#eq#O#eq#S#eq#U#eq#X#eq#Y#eq#[#eq#c#eq#f#eq#j#eq#l#eq#q#eq#t#eq#v#eq%S#eq%V#eq%g#eq%h#eq%l#eq%m#eq&R#eq&S#eq&V#eq&Y#eq&`#eq&c#eq&e#eq%U#eq%Y#eq~O#V+jOx$yay$ya~Om/jOt/xOy&ni~P'UOx+lOy&ni~Oy$TO%r+nOe&pXx&pX~O%mVOe&pXx&pX~Ox+rOe&oX~Oe+tO~O%T+vO~OT%PO_%POm/jOt/xOe%|i~P'UOy+xOx$ca!U$ca~Om/jOt/xOy+yOx$ca!U$ca~P'UOm/jOt/xOy*SO!U&Pi~P'UOx+|O!U&Pi~Om/jOt/xOx+|O!U&Pi~P'UOx+|Oy,PO!U&Pi~Oe$_ix$_i!U$_i~P$bOT'xOm/jOt/xO~P'UOl,RO~OT'xOe,SOm/jOt/xO~P'UOT'xOm/jOt/xO!U%zq~P'UOx$^i!Y$^i#^$^i%V$^i%Y$^ie$^iy$^i!j$^i%r$^i~P$bOT(XOm/jOt/xO~P'UO_*mOm/jOt/xO!Y%{q~P'UOx,TO!Y%{q~O!Y,UO~OT(XOm/jOt/xO!Y%uq#^%uq%V%uq%Y%uqe%uqy%uq!j%uq%r%uq~P'UOy,VO~OT*qOm/jOt/xOy&[i!Y&[i!j&[i~P'UOx,[Oy&[i!Y&[i!j&[i~O!Z#_O&^*uO!Y!ka~OT&UOm/jOt/xO#^%`i%V%`i%Y%`i%r%`i~P'UOx,^O#^%`i%V%`i%Y%`i%r%`i~O%mVO#^&ja%V&ja%Y&jae&ja~Ox,aO#^&ja%V&ja%Y&jae&ja~Oe,dO~Ol$wix$wi~P$bOT)[O~P'UOT)[Ol&mq~P'UOr,gOP#dyT#dyd#dyf#dym#dyq#dyt#dy}#dy!O#dy!R#dy!S#dy!V#dy!Z#dy!f#dy!m#dy!n#dy!o#dy!v#dy!x#dy!z#dy!|#dy#O#dy#S#dy#U#dy#X#dy#Y#dy#[#dy#c#dy#f#dy#j#dy#l#dy#q#dy#t#dy#v#dy%S#dy%V#dy%g#dy%h#dy%l#dy%m#dy&R#dy&S#dy&V#dy&Y#dy&`#dy&c#dy&e#dy%U#dy%Y#dy~OPhOTeOmtOq!SOtuO}vO!O!PO!R!VO!S!UO!vxO!xyO!zzO!|{O#O|O#S}O#U!OO#X!QO#Y!QO#[!RO#c!TO#f!WO#j!XO#l!YO#q!ZO#tlO#v![O%U,kO%Y,kO~P'UO#h,lOP#eyT#eyd#eyf#eym#eyq#eyt#ey}#ey!O#ey!R#ey!S#ey!V#ey!Z#ey!f#ey!m#ey!n#ey!o#ey!v#ey!x#ey!z#ey!|#ey#O#ey#S#ey#U#ey#X#ey#Y#ey#[#ey#c#ey#f#ey#j#ey#l#ey#q#ey#t#ey#v#ey%S#ey%V#ey%g#ey%h#ey%l#ey%m#ey&R#ey&S#ey&V#ey&Y#ey&`#ey&c#ey&e#ey%U#ey%Y#ey~Om/jOt/xOy&nq~P'UOx,pOy&nq~O%r+nOe&pax&pa~OT)qO_)rO%i)sO%mVOe&oa~Ox,tOe&oa~O#y,xO~OT%PO_%POm/jOt/xO~P'UOm/jOt/xOy,yOx$ci!U$ci~P'UOm/jOt/xOx$ci!U$ci~P'UOy,yOx$ci!U$ci~Om/jOt/xOy*SO~P'UOm/jOt/xOy*SO!U&Pq~P'UOx,|O!U&Pq~Om/jOt/xOx,|O!U&Pq~P'UOq-PO!R%fO!S%eOe%vq!U%vq!Y%vqx%vq~P!-QO_*mOm/jOt/xO!Y%{y~P'UOx$ai!Y$ai~P$bO_*mOm/jOt/xO~P'UOT*qOm/jOt/xO~P'UOT*qOm/jOt/xOy&[q!Y&[q!j&[q~P'UOT&UOm/jOt/xO#^%`q%V%`q%Y%`q%r%`q~P'UO#V-TOx$ra#^$ra%V$ra%Y$rae$ra~O%mVO#^&ji%V&ji%Y&jie&ji~Ox-VO#^&ji%V&ji%Y&jie&ji~Or-YOP#d!RT#d!Rd#d!Rf#d!Rm#d!Rq#d!Rt#d!R}#d!R!O#d!R!R#d!R!S#d!R!V#d!R!Z#d!R!f#d!R!m#d!R!n#d!R!o#d!R!v#d!R!x#d!R!z#d!R!|#d!R#O#d!R#S#d!R#U#d!R#X#d!R#Y#d!R#[#d!R#c#d!R#f#d!R#j#d!R#l#d!R#q#d!R#t#d!R#v#d!R%S#d!R%V#d!R%g#d!R%h#d!R%l#d!R%m#d!R&R#d!R&S#d!R&V#d!R&Y#d!R&`#d!R&c#d!R&e#d!R%U#d!R%Y#d!R~Om/jOt/xOy&ny~P'UOT)qO_)rO%i)sO%mVOe&oi~O#y,xO%U-`O%Y-`O~OT-jOf-hO!V-gO!Z-iO!f-cO!n-eO!o-eO%h-bO%mVO&R[O&S]O&V^O~Om/jOt/xOx$cq!U$cq~P'UOy-oOx$cq!U$cq~Om/jOt/xOy*SO!U&Py~P'UOx-pO!U&Py~Om/jOt-tO~P'UOq-PO!R%fO!S%eOe%vy!U%vy!Y%vyx%vy~P!-QO%mVO#^&jq%V&jq%Y&jqe&jq~Ox-xO#^&jq%V&jq%Y&jqe&jq~OT)qO_)rO%i)sO%mVO~Of-|O!d-zOx#zX#V#zX%b#zXe#zX~Oq#zXy#zX!U#zX!Y#zX~P$$qO%g.OO%h.OOq#{Xx#{Xy#{X#V#{X%b#{X!U#{Xe#{X!Y#{X~O!f.QO~Ox.UO#V.WO%b.ROq&rXy&rX!U&rXe&rX~O_.ZO~P$ ZOf-|Oq&sXx&sXy&sX#V&sX%b&sX!U&sXe&sX!Y&sX~Oq._Oy$oO~Om/jOt/xOx$cy!U$cy~P'UOm/jOt/xOy*SO!U&P!R~P'UOx.cO!U&P!R~Oe%yXq%yX!R%yX!S%yX!U%yX!Y%yXx%yX~P!-QOq-PO!R%fO!S%eOe%xa!U%xa!Y%xax%xa~O%mVO#^&jy%V&jy%Y&jye&jy~O!d-zOf$Raq$Rax$Ray$Ra#V$Ra%b$Ra!U$Rae$Ra!Y$Ra~O!f.lO~O%g.OO%h.OOq#{ax#{ay#{a#V#{a%b#{a!U#{ae#{a!Y#{a~O%b.ROq$Pax$Pay$Pa#V$Pa!U$Pae$Pa!Y$Pa~Oq&ray&ra!U&rae&ra~P#N}Ox.qOq&ray&ra!U&rae&ra~O!U.tO~Oe.tO~Oy.vO~O!Y.wO~Om/jOt/xOy*SO!U&P!Z~P'UOy.zO~O%r.{O~P$$qOx.|O#V.WO%b.ROe&uX~Ox.|Oe&uX~Oe/OO~O!f/PO~O#V.WOq$}ax$}ay$}a%b$}a!U$}ae$}a!Y$}a~O#V.WO%b.ROq%Rax%Ray%Ra!U%Rae%Ra~Oq&riy&ri!U&rie&ri~P#N}Ox/RO#V.WO%b.RO!Y&ta~Oy$Za~P$bOe&ua~P#N}Ox/ZOe&ua~O_/]O!Y&ti~P$ ZOx/_O!Y&ti~Ox/_O#V.WO%b.RO!Y&ti~O#V.WO%b.ROe$Xix$Xi~O%r/bO~P$$qO#V.WO%b.ROe%Qax%Qa~Oe&ui~P#N}Oy/eO~O_/]O!Y&tq~P$ ZOx/gO!Y&tq~O#V.WO%b.ROx%Pi!Y%Pi~O_/]O~P$ ZO_/]O!Y&ty~P$ ZO#V.WO%b.ROe$Yix$Yi~O#V.WO%b.ROx%Pq!Y%Pq~Ox*yO#^%`a%V%`a%Y%`a%r%`a~P$bOT&UOm/jOt/xO~P'UOl/oO~Om/oO~P'UOy/pO~Or/qO~P!-QO&S&V&c&e&R!Z&Z&a&d&f&Y&`&Y%m~",goto:"!:f&vPPPP&wP'P*e*}+h,S,o-]P-zP'P.k.k'PPPP'P2PPPPPPP2P4oPP4oP6{7U=QPP=T=u=xPP'P'PPP>UPP'P'PPP'P'P'P'P'P>Y?P'PP?SP?YC]FuPGZ'PPPPG_Ge&wP&w&wP&wP&wP&wP&wP&w&w&wP&wPP&wPP&wPGkPGrGxPGrPGrGrPPPGrPIwPJQJWJ^IwPGrJdPGrPJkJqPJuKZKxLcJuJuLiLvJuJuJuJuM[MbMeMjMmMsMyNVNiNoNy! P! m! s! y!!P!!Z!!a!!g!!m!!s!!y!#]!#g!#m!#s!#y!$T!$Z!$a!$g!$m!$w!$}!%X!%_!%h!%n!%}!&V!&a!&hPPPPPPPPP!&n!&v!'P!'Z!'fPPPPPPPPPPPP!,U!-j!1`!4lPP!4t!5S!5]!6R!5x!6[!6b!6e!6h!6k!6s!7dPPPPPPPPPP!7g!7jPPPPPPPPP!7p!7|!8Y!8`!8i!8l!8r!8x!9O!9RP!9Z!9d!:`!:c]iOr#o$o)d+d'udOSXYZehrstvx|}!R!S!T!U!X![!d!e!f!g!h!i!j!l!p!q!r!t!u!{#P#T#U#_#l#o$Q$R$T$V$Y$j$l$m$o$v%P%U%]%`%b%e%i%n%p%z&S&U&a&e&n&p&q&x&|'P'W'Z'h'i'l'n'o's'x'z(O(S(X(Y(`(c(j(l(t(w)T)W)[)])a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*m*q*r*y*{*|+T+]+^+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p._.c.z/j/k/l/m/o/p/q/r/s/u/y}!dP#k#x$Z$i$u%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!P!eP#k#x$Z$i$u$w%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!R!fP#k#x$Z$i$u$w$x%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!T!gP#k#x$Z$i$u$w$x$y%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!V!hP#k#x$Z$i$u$w$x$y$z%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!X!iP#k#x$Z$i$u$w$x$y$z${%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n!]!iP!o#k#x$Z$i$u$w$x$y$z${$|%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/n'uSOSXYZehrstvx|}!R!S!T!U!X![!d!e!f!g!h!i!j!l!p!q!r!t!u!{#P#T#U#_#l#o$Q$R$T$V$Y$j$l$m$o$v%P%U%]%`%b%e%i%n%p%z&S&U&a&e&n&p&q&x&|'P'W'Z'h'i'l'n'o's'x'z(O(S(X(Y(`(c(j(l(t(w)T)W)[)])a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*m*q*r*y*{*|+T+]+^+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p._.c.z/j/k/l/m/o/p/q/r/s/u/y&ZUOXYZhrtv|}!R!S!T!X!j!l!p!q!r!t!u#_#l#o$R$T$V$Y$m$o%P%U%]%`%b%i%n%p%z&S&a&e&p&q&x'P'W'Z'h'i'l'n'o's'z(S(Y(`(c(j(l(t)T)W)a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*q*r*y*|+T+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p.c.z/j/k/l/m/o/p/q/r/u/y%eWOXYZhrv|}!R!S!T!X!j!l#_#l#o$R$T$V$Y$m$o%P%U%`%b%i%n%p%z&S&a&e&p&q&x'P'W'Z'h'i'l'n'o's'z(S(Y(`(c(j(l(t)T)W)a)d)m)w*P*S*T*W*^*a*c*f*g*j*q*r*y*|+T+d+k+l+o+w+x+y+{+|,P,T,V,X,Z,[,^,p,r,y,|-o-p.c/p/q/rQ$OuQ.d-tR/v/x'ldOSXYZehrstvx|}!R!S!T!U!X![!d!e!f!g!h!i!l!p!q!r!t!u!{#P#T#U#_#l#o$Q$R$T$V$Y$j$l$m$o$v%P%U%]%`%b%e%i%n%p%z&S&U&a&e&n&p&q&x&|'P'W'Z'h'l'n'o's'x'z(O(S(X(Y(`(c(j(l(t(w)T)W)[)])a)d)m)w*S*T*W*^*_*a*c*f*g*j*m*q*r*y*{*|+T+]+^+d+k+l+o+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p._.c.z/j/k/l/m/o/p/q/r/s/u/yW#rl!O!P$aW#zu&c-t/xQ$c!QQ$s!YQ$t!ZW%O!j'i*P+wS&b#{#|Q'S$nQ(m&[Q({&rU(|&t(})OU)P&v)Q+SQ)o']W)p'_+r,t-^S+q)q)rY,`*},a-U-V-xQ,c+PQ,m+hQ,o+jl-a,x-g-h-j.S.U.Z.q.v.{/Q/]/b/eQ-w-TQ.[-iQ.h-|Q.s.WU/W.|/Z/cX/^/R/_/f/gR&a#z!_!xXY!S!T!l%U%b%i'l'n'o'z(S)W*S*T*W*^*a*c+x+y+{+|,P,y,|-o-p.cR%`!wQ!|XQ%{#_Q&j$VR&m$YT-s-P.z![!kP!o#k#x$Z$i$u$w$x$y$z${$|%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/nQ&_#sR'b$tR'h%OQ%X!nR.f-z'tcOSXYZehrstvx|}!R!S!T!U!X![!d!e!f!g!h!i!j!l!p!q!r!t!u!{#P#T#U#_#l#o$Q$R$T$V$Y$j$l$m$o$v%P%U%]%`%b%e%i%n%p%z&S&U&a&e&n&p&q&x&|'P'W'Z'h'i'l'n'o's'x'z(O(S(X(Y(`(c(j(l(t(w)T)W)[)])a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*m*q*r*y*{*|+T+]+^+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p._.c.z/j/k/l/m/o/p/q/r/s/u/yS#ic#j!P-e,x-g-h-i-j-|.S.U.Z.q.v.{.|/Q/R/Z/]/_/b/c/e/f/g'tcOSXYZehrstvx|}!R!S!T!U!X![!d!e!f!g!h!i!j!l!p!q!r!t!u!{#P#T#U#_#l#o$Q$R$T$V$Y$j$l$m$o$v%P%U%]%`%b%e%i%n%p%z&S&U&a&e&n&p&q&x&|'P'W'Z'h'i'l'n'o's'x'z(O(S(X(Y(`(c(j(l(t(w)T)W)[)])a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*m*q*r*y*{*|+T+]+^+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p._.c.z/j/k/l/m/o/p/q/r/s/u/yT#ic#jS#`_#aS#c`#dS#ea#fS#gb#hT*u(f*vT(g%{(iQ$XwR+p)pX$Vw$W$X&lZkOr$o)d+dXoOr)d+dQ$p!WQ&z$gQ&{$hQ'^$rQ'a$tQ)b'RQ)h'WQ)j'XQ)k'YQ)x'`Q)z'bQ+W)WQ+Y)XQ+Z)YQ+_)`S+a)c)yQ+e)fQ+f)gQ+g)iQ,e+VQ,f+XQ,h+`Q,i+bQ,n+iQ-X,gQ-Z,lQ-[,mQ-y-YQ.`-mR.y.aWoOr)d+dR#unQ'`$sR)c'SQ+o)pR,r+pQ)y'`R+b)cZmOnr)d+dQ'd$uR)|'eT,v+v,wu-l,x-g-h-j-|.S.U.Z.q.v.{.|/Q/Z/]/b/c/et-l,x-g-h-j-|.S.U.Z.q.v.{.|/Q/Z/]/b/c/eQ.[-iX/^/R/_/f/g!P-d,x-g-h-i-j-|.S.U.Z.q.v.{.|/Q/R/Z/]/_/b/c/e/f/gQ.P-cR.m.Qg.S-f.T.i.p.u/T/V/X/d/h/iu-k,x-g-h-j-|.S.U.Z.q.v.{.|/Q/Z/]/b/c/eX-}-a-k.h/WR.j-|V/Y.|/Z/cR.a-mQrOR#wrQ&d#}R(r&dS%o#S$PS(Z%o(^T(^%r&fQ%c!zQ%j#OW'{%c%j(Q(UQ(Q%gR(U%lQ&o$ZR(x&oQ(a%sQ*h([T*n(a*hQ'j%QR*Q'jS'm%T%UY*U'm*V+},}-qU*V'n'o'pU+}*W*X*YS,},O,PR-q-OQ#Z]R%v#ZQ#^^R%x#^Q#a_R%|#aQ(d%yS*s(d*tR*t(eQ*v(fR,]*vQ#d`R&O#dQ#faR&P#fQ#hbR&Q#hQ#jcR&R#jQ#mfQ&T#kW&W#m&T(u*zQ(u&iR*z/nQ$WwS&k$W&lR&l$XQ&y$eR)U&yQ&]#rR(n&]Q$a!PR&s$aQ+O(|S,b+O-WR-W,cQ&w$cR)R&wQ#pjR&Y#pQ+d)dR,j+dQ)V&zR+U)VQ&}$iS)^&})_R)_'OQ'V$pR)e'VQ'[$qS)n'[+mR+m)oQ+s)tR,u+sWnOr)d+dR#tnQ,w+vR-_,wd.T-f.i.p.u/T/V/X/d/h/iR.o.TU-{-a.h/WR.g-{Q/S.uS/`/S/aR/a/TS.}.i.jR/[.}Q.V-fR.r.VSqOrT+c)d+dWpOr)d+dR'T$oYjOr$o)d+dR&X#o[wOr#o$o)d+dR&j$V&YPOXYZhrtv|}!R!S!T!X!j!l!p!q!r!t!u#_#l#o$R$T$V$Y$m$o%P%U%]%`%b%i%n%p%z&S&a&e&p&q&x'P'W'Z'h'i'l'n'o's'z(S(Y(`(c(j(l(t)T)W)a)d)m)w*P*S*T*W*^*_*a*c*f*g*j*q*r*y*|+T+d+k+l+o+w+x+y+{+|,P,R,T,V,X,Z,[,^,p,r,y,|-P-o-p.c.z/j/k/l/m/o/p/q/r/u/yQ!oSQ#keQ#xsU$Zx%e(OS$i!U$lQ$u![Q$w!dQ$x!eQ$y!fQ$z!gQ${!hQ$|!iQ%g!{Q%l#PQ%r#TQ%s#UQ&f$QQ'O$jQ'e$vQ(k&UU(v&n(w*{W)Z&|)]+]+^Q*['xQ*e(XQ+[)[Q,W*mQ.x._R/n/sQ!zXQ#OYQ$g!SQ$h!TQ%T!lQ'p%U^'w%b%i'z(S*^*a*c^*R'l*T+{+|,|-p.cQ*X'nQ*Y'oQ+X)WQ+z*SQ,O*WQ,z+xQ,{+yQ-O,PQ-n,yR.b-o[fOr#o$o)d+d!^!wXY!S!T!l%U%b%i'l'n'o'z(S)W*S*T*W*^*a*c+x+y+{+|,P,y,|-o-p.cQ#SZQ#nhS$Pv|Q$^}W$e!R$Y'P)aS$q!X$mW$}!j'i*P+wQ%y#_`&V#l&S(j(l(t*y,^/rQ&g$RQ&h$TQ&i$VQ'f%PQ'v%`W(W%n(Y*f*jQ([%pQ(e%zQ(p&aS(s&e/pQ(y&pQ(z&qU)S&x)T+TQ)i'WY)l'Z)m+k+l,pQ)}'hS*Z's/qW*l(`*g,T,XW*p(c*r,Z,[Q+u)wQ,Y*qQ,_*|Q,q+oQ-S,VR-],rhTOr#l#o$o&S&e's(j(l)d+d$z!vXYZhv|}!R!S!T!X!j!l#_$R$T$V$Y$m%P%U%`%b%i%n%p%z&a&p&q&x'P'W'Z'h'i'l'n'o'z(S(Y(`(c(t)T)W)a)m)w*P*S*T*W*^*a*c*f*g*j*q*r*y*|+T+k+l+o+w+x+y+{+|,P,T,V,X,Z,[,^,p,r,y,|-o-p.c/p/q/rQ#ytW%Y!p!t/k/uQ%Z!qQ%[!rQ%^!uQ%h/jS'r%]/oQ't/lQ'u/mQ,Q*_Q-R,RS-r-P.zR/w/yU#}u-t/xR(q&c[gOr#o$o)d+dX!yX#_$V$YQ#XZQ$SvR$]|Q%d!zQ%k#OQ%q#SQ'f$}Q(R%gQ(V%lQ(_%rQ(b%sQ*i([Q-Q,QQ-v-RR.e-uQ$[xQ'}%eR*`(OQ-u-PR/U.zR#RYR#WZR%S!jQ%Q!jV*O'i*P+w!]!mP!o#k#x$Z$i$u$w$x$y$z${$|%g%l%r%s&f'O'e(k(v)Z*[*e+[,W.x/nR%V!lR%{#_Q(h%{R*x(iQ$f!RQ&m$YQ)`'PR+`)aQ#slQ$_!OQ$b!PR&u$aQ({&tR+R)OQ({&tQ+Q(}R+R)OR$d!QXpOr)d+dQ$k!UR'Q$lQ$r!XR'R$mR)v'_Q)t'_V,s+r,t-^Q-m,xQ.X-gR.Y-hU-f,x-g-hQ.^-jQ.i-|Q.n.SU.p.U.q/QQ.u.ZQ/T.vQ/V.{U/X.|/Z/cQ/d/]Q/h/bR/i/eR.]-iR.k-|",nodeNames:"\u26A0 print Comment Script AssignStatement * BinaryExpression BitOp BitOp BitOp BitOp ArithOp ArithOp @ ArithOp ** UnaryExpression ArithOp BitOp AwaitExpression await ) ( ParenthesizedExpression BinaryExpression or and CompareOp in not is UnaryExpression ConditionalExpression if else LambdaExpression lambda ParamList VariableName AssignOp , : NamedExpression AssignOp YieldExpression yield from TupleExpression ComprehensionExpression async for LambdaExpression ] [ ArrayExpression ArrayComprehensionExpression } { DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression CallExpression ArgList AssignOp MemberExpression . PropertyName Number String FormatString FormatReplacement FormatConversion FormatSpec ContinuedString Ellipsis None Boolean TypeDef AssignOp UpdateStatement UpdateOp ExpressionStatement DeleteStatement del PassStatement pass BreakStatement break ContinueStatement continue ReturnStatement return YieldStatement PrintStatement RaiseStatement raise ImportStatement import as ScopeStatement global nonlocal AssertStatement assert StatementGroup ; IfStatement Body elif WhileStatement while ForStatement TryStatement try except finally WithStatement with FunctionDefinition def ParamList AssignOp TypeDef ClassDefinition class DecoratedStatement Decorator At MatchStatement match MatchBody MatchClause case CapturePattern LiteralPattern ArithOp ArithOp AsPattern OrPattern LogicOp AttributePattern SequencePattern MappingPattern StarPattern ClassPattern PatternArgList KeywordPattern KeywordPattern Guard",maxTerm:267,context:QP,nodeProps:[["group",-14,4,80,82,83,85,87,89,91,93,94,95,97,100,103,"Statement Statement",-22,6,16,19,23,38,47,48,54,55,58,59,60,61,62,65,68,69,70,74,75,76,77,"Expression",-10,105,107,110,112,113,117,119,124,126,129,"Statement",-9,134,135,138,139,141,142,143,144,145,"Pattern"],["openedBy",21,"(",52,"[",56,"{"],["closedBy",22,")",53,"]",57,"}"]],propSources:[MP],skippedNodes:[0,2],repeatNodeCount:38,tokenData:")'WMgR!`OX%TXY!EQY[%T[]!EQ]p%Tpq!EQqr!Gkrs!Ktst#J]tu%Tuv&'{vw&*kwx&+}xy'*fyz'+rz{'-O{|'/z|}'1^}!O'2j!O!P'5]!P!Q'Ae!Q!R'Da!R!['Ho![!](&g!]!^()V!^!_(*c!_!`(-_!`!a(.q!a!b%T!b!c(1j!c!d(3O!d!e(4|!e!h(3O!h!i(?z!i!t(3O!t!u(J[!u!w(3O!w!x(>S!x!}(3O!}#O(Ll#O#P!Fp#P#Q(Mx#Q#R) U#R#S(3O#S#T%T#T#U(3O#U#V(4|#V#Y(3O#Y#Z(?z#Z#f(3O#f#g(J[#g#i(3O#i#j(>S#j#o(3O#o#p)!h#p#q)#d#q#r)$v#r#s)%z#s$g%T$g;'S(3O;'S;=`(4v<%lO(3O<r%f]&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<Q&j]&^7[&TS&Z`&d!bOr'crs!,gsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'c<Q'r]&^7[&TS&WW&Z`&d!b&f#tOr'crs&_sw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'c;p(t]&^7[&WW&f#tOr)mrs*ssw)mwxKmx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)m;p)z]&^7[&TS&WW&d!b&f#tOr)mrs*ssw)mwx(kx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)m;p*|]&^7[&TS&d!bOr)mrs+usw)mwx(kx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)m;p,O]&^7[&TS&d!bOr)mrs,wsw)mwx(kx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)m8r-QZ&^7[&TS&d!bOw,wwx-sx#O,w#O#P/}#P#o,w#o#p3n#p#q,w#q#r0l#r;'S,w;'S;=`7w<%lO,w8r-xZ&^7[Ow,wwx.kx#O,w#O#P/}#P#o,w#o#p3n#p#q,w#q#r0l#r;'S,w;'S;=`7w<%lO,w8r.pZ&^7[Ow,wwx/cx#O,w#O#P/}#P#o,w#o#p3n#p#q,w#q#r0l#r;'S,w;'S;=`7w<%lO,w7[/hT&^7[O#o/c#p#q/c#r;'S/c;'S;=`/w<%lO/c7[/zP;=`<%l/c8r0SW&^7[O#o,w#o#p0l#p#q,w#q#r0l#r;'S,w;'S;=`7Q;=`<%l0l<%lO,w!f0sX&TS&d!bOw0lwx1`x#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z<%lO0l!f1cXOw0lwx2Ox#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z<%lO0l!f2RWOw0lx#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z<%lO0l!f2nRO;'S0l;'S;=`2w;=`O0l!f3OY&TS&d!bOw0lwx1`x#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z;=`<%l0l<%lO0l!f3sX&TSOw4`wx4zx#O4`#O#P5y#P#o4`#o#p0l#p;'S4`;'S;=`6t<%lO4`S4eV&TSOw4`wx4zx#O4`#O#P5y#P;'S4`;'S;=`6t<%lO4`S4}VOw4`wx5dx#O4`#O#P5y#P;'S4`;'S;=`6t<%lO4`S5gUOw4`x#O4`#O#P5y#P;'S4`;'S;=`6t<%lO4`S5|RO;'S4`;'S;=`6V;=`O4`S6[W&TSOw4`wx4zx#O4`#O#P5y#P;'S4`;'S;=`6t;=`<%l4`<%lO4`S6wP;=`<%l4`!f6}P;=`<%l0l8r7XY&TS&d!bOw0lwx1`x#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z;=`<%l,w<%lO0l8r7zP;=`<%l,w;p8SW&^7[O#o)m#o#p8l#p#q)m#q#r8l#r;'S)m;'S;=`Jf;=`<%l8l<%lO)m%d8wZ&TS&WW&d!b&f#tOr8lrs9jsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l%d9qZ&TS&d!bOr8lrs:dsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l%d:kZ&TS&d!bOr8lrs0lsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l%d;eZ&WW&f#tOr8lrs9jsw8lwx<Wx#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l%d<_Z&WW&f#tOr8lrs9jsw8lwx=Qx#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l#|=XX&WW&f#tOr=Qrs=ts#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`<%lO=Q#|=wXOr=Qrs>ds#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`<%lO=Q#|>gWOr=Qs#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`<%lO=Q#|?SRO;'S=Q;'S;=`?];=`O=Q#|?dY&WW&f#tOr=Qrs=ts#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`;=`<%l=Q<%lO=Q#|@XX&WWOr@trsA`s#O@t#O#PB_#P#o@t#o#p=Q#p;'S@t;'S;=`CY<%lO@tW@yV&WWOr@trsA`s#O@t#O#PB_#P;'S@t;'S;=`CY<%lO@tWAcVOr@trsAxs#O@t#O#PB_#P;'S@t;'S;=`CY<%lO@tWA{UOr@ts#O@t#O#PB_#P;'S@t;'S;=`CY<%lO@tWBbRO;'S@t;'S;=`Bk;=`O@tWBpW&WWOr@trsA`s#O@t#O#PB_#P;'S@t;'S;=`CY;=`<%l@t<%lO@tWC]P;=`<%l@t#|CcP;=`<%l=Q%dCiRO;'S8l;'S;=`Cr;=`O8l%dC}[&TS&WW&d!b&f#tOr8lrs9jsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`;=`<%l8l<%lO8l%dDzZ&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P#oEm#o#p8l#p;'SEm;'S;=`JY<%lOEm[EtX&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm[FfX&TSOrEmrsGRswEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm[GWX&TSOrEmrs4`swEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm[GxX&WWOrEmrsFaswEmwxHex#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm[HjX&WWOrEmrsFaswEmwx@tx#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm[IYRO;'SEm;'S;=`Ic;=`OEm[IjY&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY;=`<%lEm<%lOEm[J]P;=`<%lEm%dJcP;=`<%l8l;pJq[&TS&WW&d!b&f#tOr8lrs9jsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`;=`<%l)m<%lO8l;pKjP;=`<%l)m;pKv]&^7[&WW&f#tOr)mrs*ssw)mwxLox#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)m:YLxZ&^7[&WW&f#tOrLorsMks#OLo#O#P! Z#P#oLo#o#p@S#p#qLo#q#r=Q#r;'SLo;'S;=`!!o<%lOLo:YMpZ&^7[OrLorsNcs#OLo#O#P! Z#P#oLo#o#p@S#p#qLo#q#r=Q#r;'SLo;'S;=`!!o<%lOLo:YNhZ&^7[OrLors/cs#OLo#O#P! Z#P#oLo#o#p@S#p#qLo#q#r=Q#r;'SLo;'S;=`!!o<%lOLo:Y! `W&^7[O#oLo#o#p=Q#p#qLo#q#r=Q#r;'SLo;'S;=`! x;=`<%l=Q<%lOLo:Y!!PY&WW&f#tOr=Qrs=ts#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`;=`<%lLo<%lO=Q:Y!!rP;=`<%lLo<Q!!zW&^7[O#o'c#o#p!#d#p#q'c#q#r!#d#r;'S'c;'S;=`!+^;=`<%l!#d<%lO'c%t!#qZ&TS&WW&Z`&d!b&f#tOr!#drs!$dsw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W<%lO!#d%t!$mZ&TS&Z`&d!bOr!#drs!%`sw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W<%lO!#d%t!%iZ&TS&Z`&d!bOr!#drs!&[sw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W<%lO!#d!v!&eX&TS&Z`&d!bOw!&[wx1`x#O!&[#O#P!'Q#P#o!&[#o#p!(V#p;'S!&[;'S;=`!(w<%lO!&[!v!'TRO;'S!&[;'S;=`!'^;=`O!&[!v!'gY&TS&Z`&d!bOw!&[wx1`x#O!&[#O#P!'Q#P#o!&[#o#p!(V#p;'S!&[;'S;=`!(w;=`<%l!&[<%lO!&[!v!([X&TSOw4`wx4zx#O4`#O#P5y#P#o4`#o#p!&[#p;'S4`;'S;=`6t<%lO4`!v!(zP;=`<%l!&[%t!)QRO;'S!#d;'S;=`!)Z;=`O!#d%t!)h[&TS&WW&Z`&d!b&f#tOr!#drs!$dsw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W;=`<%l!#d<%lO!#d%t!*eZ&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P#oEm#o#p!#d#p;'SEm;'S;=`JY<%lOEm%t!+ZP;=`<%l!#d<Q!+k[&TS&WW&Z`&d!b&f#tOr!#drs!$dsw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W;=`<%l'c<%lO!#d<Q!,dP;=`<%l'c<Q!,r]&^7[&TS&Z`&d!bOr'crs!-ksw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'c9S!-vZ&^7[&TS&Z`&d!bOw!-kwx-sx#O!-k#O#P!.i#P#o!-k#o#p!(V#p#q!-k#q#r!&[#r;'S!-k;'S;=`!0P<%lO!-k9S!.nW&^7[O#o!-k#o#p!&[#p#q!-k#q#r!&[#r;'S!-k;'S;=`!/W;=`<%l!&[<%lO!-k9S!/aY&TS&Z`&d!bOw!&[wx1`x#O!&[#O#P!'Q#P#o!&[#o#p!(V#p;'S!&[;'S;=`!(w;=`<%l!-k<%lO!&[9S!0SP;=`<%l!-k<b!0b]&^7[&WW&ap&f#tOr!1Zrs*ssw!1Zwx!<Tx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1Z<b!1j]&^7[&TS&WW&ap&d!b&f#tOr!1Zrs*ssw!1Zwx!0Vx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1Z<b!2hW&^7[O#o!1Z#o#p!3Q#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!:z;=`<%l!3Q<%lO!1Z&U!3_Z&TS&WW&ap&d!b&f#tOr!3Qrs9jsw!3Qwx!4Qx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t<%lO!3Q&U!4ZZ&WW&ap&f#tOr!3Qrs9jsw!3Qwx!4|x#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t<%lO!3Q&U!5VZ&WW&ap&f#tOr!3Qrs9jsw!3Qwx!5xx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t<%lO!3Q$n!6RX&WW&ap&f#tOr!5xrs=ts#O!5x#O#P!6n#P#o!5x#o#p!7s#p;'S!5x;'S;=`!8e<%lO!5x$n!6qRO;'S!5x;'S;=`!6z;=`O!5x$n!7TY&WW&ap&f#tOr!5xrs=ts#O!5x#O#P!6n#P#o!5x#o#p!7s#p;'S!5x;'S;=`!8e;=`<%l!5x<%lO!5x$n!7xX&WWOr@trsA`s#O@t#O#PB_#P#o@t#o#p!5x#p;'S@t;'S;=`CY<%lO@t$n!8hP;=`<%l!5x&U!8nRO;'S!3Q;'S;=`!8w;=`O!3Q&U!9U[&TS&WW&ap&d!b&f#tOr!3Qrs9jsw!3Qwx!4Qx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t;=`<%l!3Q<%lO!3Q&U!:RZ&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P#oEm#o#p!3Q#p;'SEm;'S;=`JY<%lOEm&U!:wP;=`<%l!3Q<b!;X[&TS&WW&ap&d!b&f#tOr!3Qrs9jsw!3Qwx!4Qx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t;=`<%l!1Z<%lO!3Q<b!<QP;=`<%l!1Z<b!<`]&^7[&WW&ap&f#tOr!1Zrs*ssw!1Zwx!=Xx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1Z:z!=dZ&^7[&WW&ap&f#tOr!=XrsMks#O!=X#O#P!>V#P#o!=X#o#p!7s#p#q!=X#q#r!5x#r;'S!=X;'S;=`!?m<%lO!=X:z!>[W&^7[O#o!=X#o#p!5x#p#q!=X#q#r!5x#r;'S!=X;'S;=`!>t;=`<%l!5x<%lO!=X:z!>}Y&WW&ap&f#tOr!5xrs=ts#O!5x#O#P!6n#P#o!5x#o#p!7s#p;'S!5x;'S;=`!8e;=`<%l!=X<%lO!5x:z!?pP;=`<%l!=X<r!?xW&^7[O#o%T#o#p!@b#p#q%T#q#r!@b#r;'S%T;'S;=`!Cu;=`<%l!@b<%lO%T&f!@qZ&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co<%lO!@b&f!AgRO;'S!@b;'S;=`!Ap;=`O!@b&f!BP[&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co;=`<%l!@b<%lO!@b&f!B|Z&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P#oEm#o#p!@b#p;'SEm;'S;=`JY<%lOEm&f!CrP;=`<%l!@b<r!DU[&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co;=`<%l%T<%lO!@b<r!D}P;=`<%l%TMg!Eec&^7[&TS&WW%[1s&Z`&ap&d!b&f#tOX%TXY!EQY[%T[]!EQ]p%Tpq!EQqr%Trs&_sw%Twx!0Vx#O%T#O#P!Fp#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TMg!Fu[&^7[OY%TYZ!EQZ]%T]^!EQ^#o%T#o#p!@b#p#q%T#q#r!@b#r;'S%T;'S;=`!Cu;=`<%l!@b<%lO%T<u!G|d&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`!I[!`#O%T#O#P!?s#P#T%T#T#U!Jh#U#f%T#f#g!Jh#g#h!Jh#h#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u!Io]kR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u!J{]!jR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{!LTa&bp&^7[&TS&R,X&Z`&d!bOY!MYYZ'cZ]!MY]^'c^r!MYrs#HTsw!MYwx# vx#O!MY#O#P#@t#P#o!MY#o#p#E^#p#q!MY#q#r#Ac#r;'S!MY;'S;=`#G}<%lO!MYGZ!Mka&^7[&TS&WW&R,X&Z`&d!b&f#tOY!MYYZ'cZ]!MY]^'c^r!MYrs!Npsw!MYwx# vx#O!MY#O#P#@t#P#o!MY#o#p#E^#p#q!MY#q#r#Ac#r;'S!MY;'S;=`#G}<%lO!MYGZ!N}]&^7[&TS&R,X&Z`&d!bOr'crs!,gsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'cFy#!Ra&^7[&WW&R,X&f#tOY##WYZ)mZ]##W]^)m^r##Wrs#$lsw##Wwx#;fx#O##W#O#P#%p#P#o##W#o#p#3d#p#q##W#q#r#&_#r;'S##W;'S;=`#;`<%lO##WFy##ga&^7[&TS&WW&R,X&d!b&f#tOY##WYZ)mZ]##W]^)m^r##Wrs#$lsw##Wwx# vx#O##W#O#P#%p#P#o##W#o#p#3d#p#q##W#q#r#&_#r;'S##W;'S;=`#;`<%lO##WFy#$w]&^7[&TS&R,X&d!bOr)mrs+usw)mwx(kx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)mFy#%uW&^7[O#o##W#o#p#&_#p#q##W#q#r#&_#r;'S##W;'S;=`#:P;=`<%l#&_<%lO##W0m#&l_&TS&WW&R,X&d!b&f#tOY#&_YZ8lZ]#&_]^8l^r#&_rs#'ksw#&_wx#(gx#O#&_#O#P#1w#P#o#&_#o#p#3d#p;'S#&_;'S;=`#9y<%lO#&_0m#'tZ&TS&R,X&d!bOr8lrs:dsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l0m#(p_&WW&R,X&f#tOY#&_YZ8lZ]#&_]^8l^r#&_rs#'ksw#&_wx#)ox#O#&_#O#P#1w#P#o#&_#o#p#3d#p;'S#&_;'S;=`#9y<%lO#&_0m#)x_&WW&R,X&f#tOY#&_YZ8lZ]#&_]^8l^r#&_rs#'ksw#&_wx#*wx#O#&_#O#P#1w#P#o#&_#o#p#3d#p;'S#&_;'S;=`#9y<%lO#&_/V#+Q]&WW&R,X&f#tOY#*wYZ=QZ]#*w]^=Q^r#*wrs#+ys#O#*w#O#P#,k#P#o#*w#o#p#-|#p;'S#*w;'S;=`#1q<%lO#*w/V#,OX&R,XOr=Qrs>ds#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`<%lO=Q/V#,nRO;'S#*w;'S;=`#,w;=`O#*w/V#-Q^&WW&R,X&f#tOY#*wYZ=QZ]#*w]^=Q^r#*wrs#+ys#O#*w#O#P#,k#P#o#*w#o#p#-|#p;'S#*w;'S;=`#1q;=`<%l#*w<%lO#*w/V#.T]&WW&R,XOY#.|YZ@tZ]#.|]^@t^r#.|rs#/vs#O#.|#O#P#0b#P#o#.|#o#p#*w#p;'S#.|;'S;=`#1k<%lO#.|,a#/TZ&WW&R,XOY#.|YZ@tZ]#.|]^@t^r#.|rs#/vs#O#.|#O#P#0b#P;'S#.|;'S;=`#1k<%lO#.|,a#/{V&R,XOr@trsAxs#O@t#O#PB_#P;'S@t;'S;=`CY<%lO@t,a#0eRO;'S#.|;'S;=`#0n;=`O#.|,a#0u[&WW&R,XOY#.|YZ@tZ]#.|]^@t^r#.|rs#/vs#O#.|#O#P#0b#P;'S#.|;'S;=`#1k;=`<%l#.|<%lO#.|,a#1nP;=`<%l#.|/V#1tP;=`<%l#*w0m#1zRO;'S#&_;'S;=`#2T;=`O#&_0m#2b`&TS&WW&R,X&d!b&f#tOY#&_YZ8lZ]#&_]^8l^r#&_rs#'ksw#&_wx#(gx#O#&_#O#P#1w#P#o#&_#o#p#3d#p;'S#&_;'S;=`#9y;=`<%l#&_<%lO#&_0m#3m_&TS&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#6bx#O#4l#O#P#8b#P#o#4l#o#p#&_#p;'S#4l;'S;=`#9s<%lO#4l,e#4u]&TS&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#6bx#O#4l#O#P#8b#P;'S#4l;'S;=`#9s<%lO#4l,e#5uX&TS&R,XOrEmrsGRswEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm,e#6i]&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#7bx#O#4l#O#P#8b#P;'S#4l;'S;=`#9s<%lO#4l,e#7i]&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#.|x#O#4l#O#P#8b#P;'S#4l;'S;=`#9s<%lO#4l,e#8eRO;'S#4l;'S;=`#8n;=`O#4l,e#8w^&TS&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#6bx#O#4l#O#P#8b#P;'S#4l;'S;=`#9s;=`<%l#4l<%lO#4l,e#9vP;=`<%l#4l0m#9|P;=`<%l#&_Fy#:^`&TS&WW&R,X&d!b&f#tOY#&_YZ8lZ]#&_]^8l^r#&_rs#'ksw#&_wx#(gx#O#&_#O#P#1w#P#o#&_#o#p#3d#p;'S#&_;'S;=`#9y;=`<%l##W<%lO#&_Fy#;cP;=`<%l##WFy#;qa&^7[&WW&R,X&f#tOY##WYZ)mZ]##W]^)m^r##Wrs#$lsw##Wwx#<vx#O##W#O#P#%p#P#o##W#o#p#3d#p#q##W#q#r#&_#r;'S##W;'S;=`#;`<%lO##WEc#=R_&^7[&WW&R,X&f#tOY#<vYZLoZ]#<v]^Lo^r#<vrs#>Qs#O#<v#O#P#>z#P#o#<v#o#p#-|#p#q#<v#q#r#*w#r;'S#<v;'S;=`#@n<%lO#<vEc#>XZ&^7[&R,XOrLorsNcs#OLo#O#P! Z#P#oLo#o#p@S#p#qLo#q#r=Q#r;'SLo;'S;=`!!o<%lOLoEc#?PW&^7[O#o#<v#o#p#*w#p#q#<v#q#r#*w#r;'S#<v;'S;=`#?i;=`<%l#*w<%lO#<vEc#?r^&WW&R,X&f#tOY#*wYZ=QZ]#*w]^=Q^r#*wrs#+ys#O#*w#O#P#,k#P#o#*w#o#p#-|#p;'S#*w;'S;=`#1q;=`<%l#<v<%lO#*wEc#@qP;=`<%l#<vGZ#@yW&^7[O#o!MY#o#p#Ac#p#q!MY#q#r#Ac#r;'S!MY;'S;=`#Fl;=`<%l#Ac<%lO!MY0}#Ar_&TS&WW&R,X&Z`&d!b&f#tOY#AcYZ!#dZ]#Ac]^!#d^r#Acrs#Bqsw#Acwx#(gx#O#Ac#O#P#Co#P#o#Ac#o#p#E^#p;'S#Ac;'S;=`#Ff<%lO#Ac0}#B|Z&TS&R,X&Z`&d!bOr!#drs!%`sw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W<%lO!#d0}#CrRO;'S#Ac;'S;=`#C{;=`O#Ac0}#D[`&TS&WW&R,X&Z`&d!b&f#tOY#AcYZ!#dZ]#Ac]^!#d^r#Acrs#Bqsw#Acwx#(gx#O#Ac#O#P#Co#P#o#Ac#o#p#E^#p;'S#Ac;'S;=`#Ff;=`<%l#Ac<%lO#Ac0}#Eg_&TS&WW&R,XOY#4lYZEmZ]#4l]^Em^r#4lrs#5nsw#4lwx#6bx#O#4l#O#P#8b#P#o#4l#o#p#Ac#p;'S#4l;'S;=`#9s<%lO#4l0}#FiP;=`<%l#AcGZ#F{`&TS&WW&R,X&Z`&d!b&f#tOY#AcYZ!#dZ]#Ac]^!#d^r#Acrs#Bqsw#Acwx#(gx#O#Ac#O#P#Co#P#o#Ac#o#p#E^#p;'S#Ac;'S;=`#Ff;=`<%l!MY<%lO#AcGZ#HQP;=`<%l!MYGZ#Hb]&^7[&TS&R,X&Z`&d!bOr'crs#IZsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'cGZ#IjZ&X#|&^7[&TS&V,X&Z`&d!bOw!-kwx-sx#O!-k#O#P!.i#P#o!-k#o#p!(V#p#q!-k#q#r!&[#r;'S!-k;'S;=`!0P<%lO!-kMg#JpaQ1s&^7[&TS&WW&Z`&ap&d!b&f#tOY#J]YZ%TZ]#J]]^%T^r#J]rs#Kusw#J]wx%;ax#O#J]#O#P& a#P#o#J]#o#p&%b#p#q#J]#q#r&!^#r;'S#J];'S;=`&'u<%lO#J]Lu#LSaQ1s&^7[&TS&Z`&d!bOY#MXYZ'cZ]#MX]^'c^r#MXrs%6usw#MXwx#Nox#O#MX#O#P%*Z#P#o#MX#o#p%4^#p#q#MX#q#r%+W#r;'S#MX;'S;=`%6o<%lO#MXLu#MjaQ1s&^7[&TS&WW&Z`&d!b&f#tOY#MXYZ'cZ]#MX]^'c^r#MXrs#Kusw#MXwx#Nox#O#MX#O#P%*Z#P#o#MX#o#p%4^#p#q#MX#q#r%+W#r;'S#MX;'S;=`%6o<%lO#MXLe#NzaQ1s&^7[&WW&f#tOY$!PYZ)mZ]$!P]^)m^r$!Prs$#esw$!Pwx%#ix#O$!P#O#P$6g#P#o$!P#o#p$Hf#p#q$!P#q#r$7d#r;'S$!P;'S;=`%#c<%lO$!PLe$!`aQ1s&^7[&TS&WW&d!b&f#tOY$!PYZ)mZ]$!P]^)m^r$!Prs$#esw$!Pwx#Nox#O$!P#O#P$6g#P#o$!P#o#p$Hf#p#q$!P#q#r$7d#r;'S$!P;'S;=`%#c<%lO$!PLe$#paQ1s&^7[&TS&d!bOY$!PYZ)mZ]$!P]^)m^r$!Prs$$usw$!Pwx#Nox#O$!P#O#P$6g#P#o$!P#o#p$Hf#p#q$!P#q#r$7d#r;'S$!P;'S;=`%#c<%lO$!PLe$%QaQ1s&^7[&TS&d!bOY$!PYZ)mZ]$!P]^)m^r$!Prs$&Vsw$!Pwx#Nox#O$!P#O#P$6g#P#o$!P#o#p$Hf#p#q$!P#q#r$7d#r;'S$!P;'S;=`%#c<%lO$!PIg$&b_Q1s&^7[&TS&d!bOY$&VYZ,wZ]$&V]^,w^w$&Vwx$'ax#O$&V#O#P$+X#P#o$&V#o#p$0h#p#q$&V#q#r$,U#r;'S$&V;'S;=`$6a<%lO$&VIg$'h_Q1s&^7[OY$&VYZ,wZ]$&V]^,w^w$&Vwx$(gx#O$&V#O#P$+X#P#o$&V#o#p$0h#p#q$&V#q#r$,U#r;'S$&V;'S;=`$6a<%lO$&VIg$(n_Q1s&^7[OY$&VYZ,wZ]$&V]^,w^w$&Vwx$)mx#O$&V#O#P$+X#P#o$&V#o#p$0h#p#q$&V#q#r$,U#r;'S$&V;'S;=`$6a<%lO$&VHP$)tZQ1s&^7[OY$)mYZ/cZ]$)m]^/c^#o$)m#o#p$*g#p#q$)m#q#r$*g#r;'S$)m;'S;=`$+R<%lO$)m1s$*lTQ1sOY$*gZ]$*g^;'S$*g;'S;=`$*{<%lO$*g1s$+OP;=`<%l$*gHP$+UP;=`<%l$)mIg$+`[Q1s&^7[OY$&VYZ,wZ]$&V]^,w^#o$&V#o#p$,U#p#q$&V#q#r$,U#r;'S$&V;'S;=`$5j;=`<%l0l<%lO$&V3Z$,_]Q1s&TS&d!bOY$,UYZ0lZ]$,U]^0l^w$,Uwx$-Wx#O$,U#O#P$/S#P#o$,U#o#p$0h#p;'S$,U;'S;=`$5d<%lO$,U3Z$-]]Q1sOY$,UYZ0lZ]$,U]^0l^w$,Uwx$.Ux#O$,U#O#P$/S#P#o$,U#o#p$0h#p;'S$,U;'S;=`$5d<%lO$,U3Z$.Z]Q1sOY$,UYZ0lZ]$,U]^0l^w$,Uwx$*gx#O$,U#O#P$/S#P#o$,U#o#p$0h#p;'S$,U;'S;=`$5d<%lO$,U3Z$/XWQ1sOY$,UYZ0lZ]$,U]^0l^;'S$,U;'S;=`$/q;=`<%l0l<%lO$,U3Z$/xY&TS&d!bOw0lwx1`x#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z;=`<%l$,U<%lO0l3Z$0o]Q1s&TSOY$1hYZ4`Z]$1h]^4`^w$1hwx$2bx#O$1h#O#P$4Q#P#o$1h#o#p$,U#p;'S$1h;'S;=`$5^<%lO$1h1w$1oZQ1s&TSOY$1hYZ4`Z]$1h]^4`^w$1hwx$2bx#O$1h#O#P$4Q#P;'S$1h;'S;=`$5^<%lO$1h1w$2gZQ1sOY$1hYZ4`Z]$1h]^4`^w$1hwx$3Yx#O$1h#O#P$4Q#P;'S$1h;'S;=`$5^<%lO$1h1w$3_ZQ1sOY$1hYZ4`Z]$1h]^4`^w$1hwx$*gx#O$1h#O#P$4Q#P;'S$1h;'S;=`$5^<%lO$1h1w$4VWQ1sOY$1hYZ4`Z]$1h]^4`^;'S$1h;'S;=`$4o;=`<%l4`<%lO$1h1w$4tW&TSOw4`wx4zx#O4`#O#P5y#P;'S4`;'S;=`6t;=`<%l$1h<%lO4`1w$5aP;=`<%l$1h3Z$5gP;=`<%l$,UIg$5qY&TS&d!bOw0lwx1`x#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z;=`<%l$&V<%lO0lIg$6dP;=`<%l$&VLe$6n[Q1s&^7[OY$!PYZ)mZ]$!P]^)m^#o$!P#o#p$7d#p#q$!P#q#r$7d#r;'S$!P;'S;=`%!b;=`<%l8l<%lO$!P6X$7q_Q1s&TS&WW&d!b&f#tOY$7dYZ8lZ]$7d]^8l^r$7drs$8psw$7dwx$;Qx#O$7d#O#P$Fv#P#o$7d#o#p$Hf#p;'S$7d;'S;=`%![<%lO$7d6X$8y_Q1s&TS&d!bOY$7dYZ8lZ]$7d]^8l^r$7drs$9xsw$7dwx$;Qx#O$7d#O#P$Fv#P#o$7d#o#p$Hf#p;'S$7d;'S;=`%![<%lO$7d6X$:R_Q1s&TS&d!bOY$7dYZ8lZ]$7d]^8l^r$7drs$,Usw$7dwx$;Qx#O$7d#O#P$Fv#P#o$7d#o#p$Hf#p;'S$7d;'S;=`%![<%lO$7d6X$;Z_Q1s&WW&f#tOY$7dYZ8lZ]$7d]^8l^r$7drs$8psw$7dwx$<Yx#O$7d#O#P$Fv#P#o$7d#o#p$Hf#p;'S$7d;'S;=`%![<%lO$7d6X$<c_Q1s&WW&f#tOY$7dYZ8lZ]$7d]^8l^r$7drs$8psw$7dwx$=bx#O$7d#O#P$Fv#P#o$7d#o#p$Hf#p;'S$7d;'S;=`%![<%lO$7d4q$=k]Q1s&WW&f#tOY$=bYZ=QZ]$=b]^=Q^r$=brs$>ds#O$=b#O#P$@`#P#o$=b#o#p$At#p;'S$=b;'S;=`$Fp<%lO$=b4q$>i]Q1sOY$=bYZ=QZ]$=b]^=Q^r$=brs$?bs#O$=b#O#P$@`#P#o$=b#o#p$At#p;'S$=b;'S;=`$Fp<%lO$=b4q$?g]Q1sOY$=bYZ=QZ]$=b]^=Q^r$=brs$*gs#O$=b#O#P$@`#P#o$=b#o#p$At#p;'S$=b;'S;=`$Fp<%lO$=b4q$@eWQ1sOY$=bYZ=QZ]$=b]^=Q^;'S$=b;'S;=`$@};=`<%l=Q<%lO$=b4q$AUY&WW&f#tOr=Qrs=ts#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`;=`<%l$=b<%lO=Q4q$A{]Q1s&WWOY$BtYZ@tZ]$Bt]^@t^r$Btrs$Cns#O$Bt#O#P$E^#P#o$Bt#o#p$=b#p;'S$Bt;'S;=`$Fj<%lO$Bt1{$B{ZQ1s&WWOY$BtYZ@tZ]$Bt]^@t^r$Btrs$Cns#O$Bt#O#P$E^#P;'S$Bt;'S;=`$Fj<%lO$Bt1{$CsZQ1sOY$BtYZ@tZ]$Bt]^@t^r$Btrs$Dfs#O$Bt#O#P$E^#P;'S$Bt;'S;=`$Fj<%lO$Bt1{$DkZQ1sOY$BtYZ@tZ]$Bt]^@t^r$Btrs$*gs#O$Bt#O#P$E^#P;'S$Bt;'S;=`$Fj<%lO$Bt1{$EcWQ1sOY$BtYZ@tZ]$Bt]^@t^;'S$Bt;'S;=`$E{;=`<%l@t<%lO$Bt1{$FQW&WWOr@trsA`s#O@t#O#PB_#P;'S@t;'S;=`CY;=`<%l$Bt<%lO@t1{$FmP;=`<%l$Bt4q$FsP;=`<%l$=b6X$F{WQ1sOY$7dYZ8lZ]$7d]^8l^;'S$7d;'S;=`$Ge;=`<%l8l<%lO$7d6X$Gp[&TS&WW&d!b&f#tOr8lrs9jsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`;=`<%l$7d<%lO8l6X$Ho_Q1s&TS&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Lpx#O$In#O#P$Np#P#o$In#o#p$7d#p;'S$In;'S;=`%!U<%lO$In2P$Iw]Q1s&TS&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Lpx#O$In#O#P$Np#P;'S$In;'S;=`%!U<%lO$In2P$Jw]Q1s&TSOY$InYZEmZ]$In]^Em^r$Inrs$Kpsw$Inwx$Lpx#O$In#O#P$Np#P;'S$In;'S;=`%!U<%lO$In2P$Kw]Q1s&TSOY$InYZEmZ]$In]^Em^r$Inrs$1hsw$Inwx$Lpx#O$In#O#P$Np#P;'S$In;'S;=`%!U<%lO$In2P$Lw]Q1s&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Mpx#O$In#O#P$Np#P;'S$In;'S;=`%!U<%lO$In2P$Mw]Q1s&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Btx#O$In#O#P$Np#P;'S$In;'S;=`%!U<%lO$In2P$NuWQ1sOY$InYZEmZ]$In]^Em^;'S$In;'S;=`% _;=`<%lEm<%lO$In2P% fY&TS&WWOrEmrsFaswEmwxGsx#OEm#O#PIV#P;'SEm;'S;=`JY;=`<%l$In<%lOEm2P%!XP;=`<%l$In6X%!_P;=`<%l$7dLe%!m[&TS&WW&d!b&f#tOr8lrs9jsw8lwx;^x#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`;=`<%l$!P<%lO8lLe%#fP;=`<%l$!PLe%#taQ1s&^7[&WW&f#tOY$!PYZ)mZ]$!P]^)m^r$!Prs$#esw$!Pwx%$yx#O$!P#O#P$6g#P#o$!P#o#p$Hf#p#q$!P#q#r$7d#r;'S$!P;'S;=`%#c<%lO$!PJ}%%U_Q1s&^7[&WW&f#tOY%$yYZLoZ]%$y]^Lo^r%$yrs%&Ts#O%$y#O#P%(a#P#o%$y#o#p$At#p#q%$y#q#r$=b#r;'S%$y;'S;=`%*T<%lO%$yJ}%&[_Q1s&^7[OY%$yYZLoZ]%$y]^Lo^r%$yrs%'Zs#O%$y#O#P%(a#P#o%$y#o#p$At#p#q%$y#q#r$=b#r;'S%$y;'S;=`%*T<%lO%$yJ}%'b_Q1s&^7[OY%$yYZLoZ]%$y]^Lo^r%$yrs$)ms#O%$y#O#P%(a#P#o%$y#o#p$At#p#q%$y#q#r$=b#r;'S%$y;'S;=`%*T<%lO%$yJ}%(h[Q1s&^7[OY%$yYZLoZ]%$y]^Lo^#o%$y#o#p$=b#p#q%$y#q#r$=b#r;'S%$y;'S;=`%)^;=`<%l=Q<%lO%$yJ}%)eY&WW&f#tOr=Qrs=ts#O=Q#O#P?P#P#o=Q#o#p@S#p;'S=Q;'S;=`C`;=`<%l%$y<%lO=QJ}%*WP;=`<%l%$yLu%*b[Q1s&^7[OY#MXYZ'cZ]#MX]^'c^#o#MX#o#p%+W#p#q#MX#q#r%+W#r;'S#MX;'S;=`%5l;=`<%l!#d<%lO#MX6i%+g_Q1s&TS&WW&Z`&d!b&f#tOY%+WYZ!#dZ]%+W]^!#d^r%+Wrs%,fsw%+Wwx$;Qx#O%+W#O#P%2l#P#o%+W#o#p%4^#p;'S%+W;'S;=`%5f<%lO%+W6i%,q_Q1s&TS&Z`&d!bOY%+WYZ!#dZ]%+W]^!#d^r%+Wrs%-psw%+Wwx$;Qx#O%+W#O#P%2l#P#o%+W#o#p%4^#p;'S%+W;'S;=`%5f<%lO%+W6i%-{_Q1s&TS&Z`&d!bOY%+WYZ!#dZ]%+W]^!#d^r%+Wrs%.zsw%+Wwx$;Qx#O%+W#O#P%2l#P#o%+W#o#p%4^#p;'S%+W;'S;=`%5f<%lO%+W3k%/V]Q1s&TS&Z`&d!bOY%.zYZ!&[Z]%.z]^!&[^w%.zwx$-Wx#O%.z#O#P%0O#P#o%.z#o#p%1f#p;'S%.z;'S;=`%2f<%lO%.z3k%0TWQ1sOY%.zYZ!&[Z]%.z]^!&[^;'S%.z;'S;=`%0m;=`<%l!&[<%lO%.z3k%0vY&TS&Z`&d!bOw!&[wx1`x#O!&[#O#P!'Q#P#o!&[#o#p!(V#p;'S!&[;'S;=`!(w;=`<%l%.z<%lO!&[3k%1m]Q1s&TSOY$1hYZ4`Z]$1h]^4`^w$1hwx$2bx#O$1h#O#P$4Q#P#o$1h#o#p%.z#p;'S$1h;'S;=`$5^<%lO$1h3k%2iP;=`<%l%.z6i%2qWQ1sOY%+WYZ!#dZ]%+W]^!#d^;'S%+W;'S;=`%3Z;=`<%l!#d<%lO%+W6i%3h[&TS&WW&Z`&d!b&f#tOr!#drs!$dsw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W;=`<%l%+W<%lO!#d6i%4g_Q1s&TS&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Lpx#O$In#O#P$Np#P#o$In#o#p%+W#p;'S$In;'S;=`%!U<%lO$In6i%5iP;=`<%l%+WLu%5y[&TS&WW&Z`&d!b&f#tOr!#drs!$dsw!#dwx;^x#O!#d#O#P!(}#P#o!#d#o#p!*^#p;'S!#d;'S;=`!+W;=`<%l#MX<%lO!#dLu%6rP;=`<%l#MXLu%7SaQ1s&^7[&TS&Z`&d!bOY#MXYZ'cZ]#MX]^'c^r#MXrs%8Xsw#MXwx#Nox#O#MX#O#P%*Z#P#o#MX#o#p%4^#p#q#MX#q#r%+W#r;'S#MX;'S;=`%6o<%lO#MXIw%8f_Q1s&^7[&TS&Z`&d!bOY%8XYZ!-kZ]%8X]^!-k^w%8Xwx$'ax#O%8X#O#P%9e#P#o%8X#o#p%1f#p#q%8X#q#r%.z#r;'S%8X;'S;=`%;Z<%lO%8XIw%9l[Q1s&^7[OY%8XYZ!-kZ]%8X]^!-k^#o%8X#o#p%.z#p#q%8X#q#r%.z#r;'S%8X;'S;=`%:b;=`<%l!&[<%lO%8XIw%:kY&TS&Z`&d!bOw!&[wx1`x#O!&[#O#P!'Q#P#o!&[#o#p!(V#p;'S!&[;'S;=`!(w;=`<%l%8X<%lO!&[Iw%;^P;=`<%l%8XMV%;naQ1s&^7[&WW&ap&f#tOY%<sYZ!1ZZ]%<s]^!1Z^r%<srs$#esw%<swx%Jux#O%<s#O#P%>Z#P#o%<s#o#p%H^#p#q%<s#q#r%?W#r;'S%<s;'S;=`%Jo<%lO%<sMV%=UaQ1s&^7[&TS&WW&ap&d!b&f#tOY%<sYZ!1ZZ]%<s]^!1Z^r%<srs$#esw%<swx%;ax#O%<s#O#P%>Z#P#o%<s#o#p%H^#p#q%<s#q#r%?W#r;'S%<s;'S;=`%Jo<%lO%<sMV%>b[Q1s&^7[OY%<sYZ!1ZZ]%<s]^!1Z^#o%<s#o#p%?W#p#q%<s#q#r%?W#r;'S%<s;'S;=`%Il;=`<%l!3Q<%lO%<s6y%?g_Q1s&TS&WW&ap&d!b&f#tOY%?WYZ!3QZ]%?W]^!3Q^r%?Wrs$8psw%?Wwx%@fx#O%?W#O#P%Fl#P#o%?W#o#p%H^#p;'S%?W;'S;=`%If<%lO%?W6y%@q_Q1s&WW&ap&f#tOY%?WYZ!3QZ]%?W]^!3Q^r%?Wrs$8psw%?Wwx%Apx#O%?W#O#P%Fl#P#o%?W#o#p%H^#p;'S%?W;'S;=`%If<%lO%?W6y%A{_Q1s&WW&ap&f#tOY%?WYZ!3QZ]%?W]^!3Q^r%?Wrs$8psw%?Wwx%Bzx#O%?W#O#P%Fl#P#o%?W#o#p%H^#p;'S%?W;'S;=`%If<%lO%?W5c%CV]Q1s&WW&ap&f#tOY%BzYZ!5xZ]%Bz]^!5x^r%Bzrs$>ds#O%Bz#O#P%DO#P#o%Bz#o#p%Ef#p;'S%Bz;'S;=`%Ff<%lO%Bz5c%DTWQ1sOY%BzYZ!5xZ]%Bz]^!5x^;'S%Bz;'S;=`%Dm;=`<%l!5x<%lO%Bz5c%DvY&WW&ap&f#tOr!5xrs=ts#O!5x#O#P!6n#P#o!5x#o#p!7s#p;'S!5x;'S;=`!8e;=`<%l%Bz<%lO!5x5c%Em]Q1s&WWOY$BtYZ@tZ]$Bt]^@t^r$Btrs$Cns#O$Bt#O#P$E^#P#o$Bt#o#p%Bz#p;'S$Bt;'S;=`$Fj<%lO$Bt5c%FiP;=`<%l%Bz6y%FqWQ1sOY%?WYZ!3QZ]%?W]^!3Q^;'S%?W;'S;=`%GZ;=`<%l!3Q<%lO%?W6y%Gh[&TS&WW&ap&d!b&f#tOr!3Qrs9jsw!3Qwx!4Qx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t;=`<%l%?W<%lO!3Q6y%Hg_Q1s&TS&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Lpx#O$In#O#P$Np#P#o$In#o#p%?W#p;'S$In;'S;=`%!U<%lO$In6y%IiP;=`<%l%?WMV%Iy[&TS&WW&ap&d!b&f#tOr!3Qrs9jsw!3Qwx!4Qx#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t;=`<%l%<s<%lO!3QMV%JrP;=`<%l%<sMV%KSaQ1s&^7[&WW&ap&f#tOY%<sYZ!1ZZ]%<s]^!1Z^r%<srs$#esw%<swx%LXx#O%<s#O#P%>Z#P#o%<s#o#p%H^#p#q%<s#q#r%?W#r;'S%<s;'S;=`%Jo<%lO%<sKo%Lf_Q1s&^7[&WW&ap&f#tOY%LXYZ!=XZ]%LX]^!=X^r%LXrs%&Ts#O%LX#O#P%Me#P#o%LX#o#p%Ef#p#q%LX#q#r%Bz#r;'S%LX;'S;=`& Z<%lO%LXKo%Ml[Q1s&^7[OY%LXYZ!=XZ]%LX]^!=X^#o%LX#o#p%Bz#p#q%LX#q#r%Bz#r;'S%LX;'S;=`%Nb;=`<%l!5x<%lO%LXKo%NkY&WW&ap&f#tOr!5xrs=ts#O!5x#O#P!6n#P#o!5x#o#p!7s#p;'S!5x;'S;=`!8e;=`<%l%LX<%lO!5xKo& ^P;=`<%l%LXMg& h[Q1s&^7[OY#J]YZ%TZ]#J]]^%T^#o#J]#o#p&!^#p#q#J]#q#r&!^#r;'S#J];'S;=`&&p;=`<%l!@b<%lO#J]7Z&!o_Q1s&TS&WW&Z`&ap&d!b&f#tOY&!^YZ!@bZ]&!^]^!@b^r&!^rs%,fsw&!^wx%@fx#O&!^#O#P&#n#P#o&!^#o#p&%b#p;'S&!^;'S;=`&&j<%lO&!^7Z&#sWQ1sOY&!^YZ!@bZ]&!^]^!@b^;'S&!^;'S;=`&$];=`<%l!@b<%lO&!^7Z&$l[&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co;=`<%l&!^<%lO!@b7Z&%k_Q1s&TS&WWOY$InYZEmZ]$In]^Em^r$Inrs$Jpsw$Inwx$Lpx#O$In#O#P$Np#P#o$In#o#p&!^#p;'S$In;'S;=`%!U<%lO$In7Z&&mP;=`<%l&!^Mg&'P[&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co;=`<%l#J]<%lO!@bMg&'xP;=`<%l#J]Gz&(`_%jQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz&)r]!s,W&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz&+O_%dQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{&,^a&_`&^7[&WW&R,X&ap&f#tOY&-cYZ!1ZZ]&-c]^!1Z^r&-crs&.ysw&-cwx'(^x#O&-c#O#P&N}#P#o&-c#o#p'%g#p#q&-c#q#r' l#r;'S&-c;'S;=`'(W<%lO&-cGk&-ta&^7[&TS&WW&R,X&ap&d!b&f#tOY&-cYZ!1ZZ]&-c]^!1Z^r&-crs&.ysw&-cwx&Mwx#O&-c#O#P&N}#P#o&-c#o#p'%g#p#q&-c#q#r' l#r;'S&-c;'S;=`'(W<%lO&-cFy&/Ua&^7[&TS&R,X&d!bOY&0ZYZ)mZ]&0Z]^)m^r&0Zrs&Hisw&0Zwx&1ox#O&0Z#O#P&2s#P#o&0Z#o#p&@g#p#q&0Z#q#r&3b#r;'S&0Z;'S;=`&Hc<%lO&0ZFy&0ja&^7[&TS&WW&R,X&d!b&f#tOY&0ZYZ)mZ]&0Z]^)m^r&0Zrs&.ysw&0Zwx&1ox#O&0Z#O#P&2s#P#o&0Z#o#p&@g#p#q&0Z#q#r&3b#r;'S&0Z;'S;=`&Hc<%lO&0ZFy&1z]&^7[&WW&R,X&f#tOr)mrs*ssw)mwxKmx#O)m#O#P7}#P#o)m#o#pDs#p#q)m#q#r8l#r;'S)m;'S;=`Kg<%lO)mFy&2xW&^7[O#o&0Z#o#p&3b#p#q&0Z#q#r&3b#r;'S&0Z;'S;=`&GS;=`<%l&3b<%lO&0Z0m&3o_&TS&WW&R,X&d!b&f#tOY&3bYZ8lZ]&3b]^8l^r&3brs&4nsw&3bwx&>Ox#O&3b#O#P&>z#P#o&3b#o#p&@g#p;'S&3b;'S;=`&F|<%lO&3b0m&4w_&TS&R,X&d!bOY&3bYZ8lZ]&3b]^8l^r&3brs&5vsw&3bwx&>Ox#O&3b#O#P&>z#P#o&3b#o#p&@g#p;'S&3b;'S;=`&F|<%lO&3b0m&6P_&TS&R,X&d!bOY&3bYZ8lZ]&3b]^8l^r&3brs&7Osw&3bwx&>Ox#O&3b#O#P&>z#P#o&3b#o#p&@g#p;'S&3b;'S;=`&F|<%lO&3b-o&7X]&TS&R,X&d!bOY&7OYZ0lZ]&7O]^0l^w&7Owx&8Qx#O&7O#O#P&8r#P#o&7O#o#p&:T#p;'S&7O;'S;=`&=x<%lO&7O-o&8VX&R,XOw0lwx2Ox#O0l#O#P2k#P#o0l#o#p3n#p;'S0l;'S;=`6z<%lO0l-o&8uRO;'S&7O;'S;=`&9O;=`O&7O-o&9X^&TS&R,X&d!bOY&7OYZ0lZ]&7O]^0l^w&7Owx&8Qx#O&7O#O#P&8r#P#o&7O#o#p&:T#p;'S&7O;'S;=`&=x;=`<%l&7O<%lO&7O-o&:[]&TS&R,XOY&;TYZ4`Z]&;T]^4`^w&;Twx&;}x#O&;T#O#P&<i#P#o&;T#o#p&7O#p;'S&;T;'S;=`&=r<%lO&;T,]&;[Z&TS&R,XOY&;TYZ4`Z]&;T]^4`^w&;Twx&;}x#O&;T#O#P&<i#P;'S&;T;'S;=`&=r<%lO&;T,]&<SV&R,XOw4`wx5dx#O4`#O#P5y#P;'S4`;'S;=`6t<%lO4`,]&<lRO;'S&;T;'S;=`&<u;=`O&;T,]&<|[&TS&R,XOY&;TYZ4`Z]&;T]^4`^w&;Twx&;}x#O&;T#O#P&<i#P;'S&;T;'S;=`&=r;=`<%l&;T<%lO&;T,]&=uP;=`<%l&;T-o&={P;=`<%l&7O0m&>XZ&WW&R,X&f#tOr8lrs9jsw8lwx<Wx#O8l#O#PCf#P#o8l#o#pDs#p;'S8l;'S;=`J`<%lO8l0m&>}RO;'S&3b;'S;=`&?W;=`O&3b0m&?e`&TS&WW&R,X&d!b&f#tOY&3bYZ8lZ]&3b]^8l^r&3brs&4nsw&3bwx&>Ox#O&3b#O#P&>z#P#o&3b#o#p&@g#p;'S&3b;'S;=`&F|;=`<%l&3b<%lO&3b0m&@p_&TS&WW&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&Bqsw&Aowx&Dqx#O&Ao#O#P&Ee#P#o&Ao#o#p&3b#p;'S&Ao;'S;=`&Fv<%lO&Ao,e&Ax]&TS&WW&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&Bqsw&Aowx&Dqx#O&Ao#O#P&Ee#P;'S&Ao;'S;=`&Fv<%lO&Ao,e&Bx]&TS&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&Cqsw&Aowx&Dqx#O&Ao#O#P&Ee#P;'S&Ao;'S;=`&Fv<%lO&Ao,e&Cx]&TS&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&;Tsw&Aowx&Dqx#O&Ao#O#P&Ee#P;'S&Ao;'S;=`&Fv<%lO&Ao,e&DxX&WW&R,XOrEmrsFaswEmwxHex#OEm#O#PIV#P;'SEm;'S;=`JY<%lOEm,e&EhRO;'S&Ao;'S;=`&Eq;=`O&Ao,e&Ez^&TS&WW&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&Bqsw&Aowx&Dqx#O&Ao#O#P&Ee#P;'S&Ao;'S;=`&Fv;=`<%l&Ao<%lO&Ao,e&FyP;=`<%l&Ao0m&GPP;=`<%l&3bFy&Ga`&TS&WW&R,X&d!b&f#tOY&3bYZ8lZ]&3b]^8l^r&3brs&4nsw&3bwx&>Ox#O&3b#O#P&>z#P#o&3b#o#p&@g#p;'S&3b;'S;=`&F|;=`<%l&0Z<%lO&3bFy&HfP;=`<%l&0ZFy&Hta&^7[&TS&R,X&d!bOY&0ZYZ)mZ]&0Z]^)m^r&0Zrs&Iysw&0Zwx&1ox#O&0Z#O#P&2s#P#o&0Z#o#p&@g#p#q&0Z#q#r&3b#r;'S&0Z;'S;=`&Hc<%lO&0ZC{&JU_&^7[&TS&R,X&d!bOY&IyYZ,wZ]&Iy]^,w^w&Iywx&KTx#O&Iy#O#P&K}#P#o&Iy#o#p&:T#p#q&Iy#q#r&7O#r;'S&Iy;'S;=`&Mq<%lO&IyC{&K[Z&^7[&R,XOw,wwx.kx#O,w#O#P/}#P#o,w#o#p3n#p#q,w#q#r0l#r;'S,w;'S;=`7w<%lO,wC{&LSW&^7[O#o&Iy#o#p&7O#p#q&Iy#q#r&7O#r;'S&Iy;'S;=`&Ll;=`<%l&7O<%lO&IyC{&Lu^&TS&R,X&d!bOY&7OYZ0lZ]&7O]^0l^w&7Owx&8Qx#O&7O#O#P&8r#P#o&7O#o#p&:T#p;'S&7O;'S;=`&=x;=`<%l&Iy<%lO&7OC{&MtP;=`<%l&IyGk&NU]&^7[&WW&R,X&ap&f#tOr!1Zrs*ssw!1Zwx!<Tx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1ZGk' SW&^7[O#o&-c#o#p' l#p#q&-c#q#r' l#r;'S&-c;'S;=`'&u;=`<%l' l<%lO&-c1_' {_&TS&WW&R,X&ap&d!b&f#tOY' lYZ!3QZ]' l]^!3Q^r' lrs&4nsw' lwx'!zx#O' l#O#P'#x#P#o' l#o#p'%g#p;'S' l;'S;=`'&o<%lO' l1_'#VZ&WW&R,X&ap&f#tOr!3Qrs9jsw!3Qwx!4|x#O!3Q#O#P!8k#P#o!3Q#o#p!9z#p;'S!3Q;'S;=`!:t<%lO!3Q1_'#{RO;'S' l;'S;=`'$U;=`O' l1_'$e`&TS&WW&R,X&ap&d!b&f#tOY' lYZ!3QZ]' l]^!3Q^r' lrs&4nsw' lwx'!zx#O' l#O#P'#x#P#o' l#o#p'%g#p;'S' l;'S;=`'&o;=`<%l' l<%lO' l1_'%p_&TS&WW&R,XOY&AoYZEmZ]&Ao]^Em^r&Aors&Bqsw&Aowx&Dqx#O&Ao#O#P&Ee#P#o&Ao#o#p' l#p;'S&Ao;'S;=`&Fv<%lO&Ao1_'&rP;=`<%l' lGk''U`&TS&WW&R,X&ap&d!b&f#tOY' lYZ!3QZ]' l]^!3Q^r' lrs&4nsw' lwx'!zx#O' l#O#P'#x#P#o' l#o#p'%g#p;'S' l;'S;=`'&o;=`<%l&-c<%lO' lGk'(ZP;=`<%l&-cGk'(k]&^7[&WW&R,X&ap&f#tOr!1Zrs*ssw!1Zwx')dx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1ZGk')sZ&U!f&^7[&WW&S,X&ap&f#tOr!=XrsMks#O!=X#O#P!>V#P#o!=X#o#p!7s#p#q!=X#q#r!5x#r;'S!=X;'S;=`!?m<%lO!=XG{'*y]f,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u',V]eR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'-caT,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vxz%Tz{'.h{!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'.{__R&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'0__%g,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u'1q]xR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TMg'2}`%h,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`!a'4P!a#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TB^'4d]&q&j&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'5pa!dQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!O%T!O!P'6u!P!Q%T!Q!['9c![#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'7W_&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!O%T!O!P'8V!P#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'8j]!m,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'9vi!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!['9c![!g%T!g!h';e!h!l%T!l!m'@X!m#O%T#O#P!?s#P#R%T#R#S'9c#S#X%T#X#Y';e#Y#^%T#^#_'@X#_#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy';vc&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx{%T{|'=R|}%T}!O'=R!O!Q%T!Q!['>c![#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'=d_&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!['>c![#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'>ve!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!['>c![!l%T!l!m'@X!m#O%T#O#P!?s#P#R%T#R#S'>c#S#^%T#^#_'@X#_#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'@l]!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{'Axa%iR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!P%T!P!Q'B}!Q!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz'Cb_%kQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'Dtw!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!O%T!O!P'G_!P!Q%T!Q!['Ho![!d%T!d!e'Jw!e!g%T!g!h';e!h!l%T!l!m'@X!m!q%T!q!r'M}!r!z%T!z!{(!}!{#O%T#O#P!?s#P#R%T#R#S'Ho#S#U%T#U#V'Jw#V#X%T#X#Y';e#Y#^%T#^#_'@X#_#c%T#c#d'M}#d#l%T#l#m(!}#m#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'Gp_&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!['9c![#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'ISk!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!O%T!O!P'G_!P!Q%T!Q!['Ho![!g%T!g!h';e!h!l%T!l!m'@X!m#O%T#O#P!?s#P#R%T#R#S'Ho#S#X%T#X#Y';e#Y#^%T#^#_'@X#_#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'KYb&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!R'Lb!R!S'Lb!S#O%T#O#P!?s#P#R%T#R#S'Lb#S#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'Lub!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!R'Lb!R!S'Lb!S#O%T#O#P!?s#P#R%T#R#S'Lb#S#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy'N`a&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!Y( e!Y#O%T#O#P!?s#P#R%T#R#S( e#S#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy( xa!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q!Y( e!Y#O%T#O#P!?s#P#R%T#R#S( e#S#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy(#`e&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q![($q![!c%T!c!i($q!i#O%T#O#P!?s#P#R%T#R#S($q#S#T%T#T#Z($q#Z#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy(%Ue!f,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!Q%T!Q![($q![!c%T!c!i($q!i#O%T#O#P!?s#P#R%T#R#S($q#S#T%T#T#Z($q#Z#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TMg(&z_y1s&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`('y!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u((^]%sR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{()j]#^,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{(*vakR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!^%T!^!_(+{!_!`!I[!`!a!I[!a#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz(,`_%eQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{(-r_%r,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`!I[!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{(/U`kR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`!I[!`!a(0W!a#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz(0k_%fQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TG{(2P_]Q#tP&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TMg(3ee&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs&_sw%Twx!0Vx!Q%T!Q![(3O![!c%T!c!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OMg(4yP;=`<%l(3OMg(5ci&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs(7Qsw%Twx(:jx!Q%T!Q![(3O![!c%T!c!t(3O!t!u(>S!u!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#f(3O#f#g(>S#g#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OGZ(7_a&^7[&TS&R,X&Z`&d!bOY!MYYZ'cZ]!MY]^'c^r!MYrs(8dsw!MYwx# vx#O!MY#O#P#@t#P#o!MY#o#p#E^#p#q!MY#q#r#Ac#r;'S!MY;'S;=`#G}<%lO!MYGZ(8q]&^7[&TS&R,X&Z`&d!bOr'crs(9jsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'cD](9wZ&^7[&TS&V,X&Z`&d!bOw!-kwx-sx#O!-k#O#P!.i#P#o!-k#o#p!(V#p#q!-k#q#r!&[#r;'S!-k;'S;=`!0P<%lO!-kGk(:wa&^7[&WW&R,X&ap&f#tOY&-cYZ!1ZZ]&-c]^!1Z^r&-crs&.ysw&-cwx(;|x#O&-c#O#P&N}#P#o&-c#o#p'%g#p#q&-c#q#r' l#r;'S&-c;'S;=`'(W<%lO&-cGk(<Z]&^7[&WW&R,X&ap&f#tOr!1Zrs*ssw!1Zwx(=Sx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1ZFT(=aZ&^7[&WW&S,X&ap&f#tOr!=XrsMks#O!=X#O#P!>V#P#o!=X#o#p!7s#p#q!=X#q#r!5x#r;'S!=X;'S;=`!?m<%lO!=XMg(>ie&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs(7Qsw%Twx(:jx!Q%T!Q![(3O![!c%T!c!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OMg(@ai&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs(BOsw%Twx(EYx!Q%T!Q![(3O![!c%T!c!t(3O!t!u(Hd!u!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#f(3O#f#g(Hd#g#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OGZ(B]]&^7[&TS&Z`&d!b&`,XOr'crs(CUsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'cGZ(Ca]&^7[&TS&Z`&d!bOr'crs(DYsw'cwx(kx#O'c#O#P!!u#P#o'c#o#p!*^#p#q'c#q#r!#d#r;'S'c;'S;=`!,a<%lO'cD](DgZ&^7[&TS&e,X&Z`&d!bOw!-kwx-sx#O!-k#O#P!.i#P#o!-k#o#p!(V#p#q!-k#q#r!&[#r;'S!-k;'S;=`!0P<%lO!-kGk(Eg]&^7[&WW&ap&f#t&Y,XOr!1Zrs*ssw!1Zwx(F`x#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1ZGk(Fk]&^7[&WW&ap&f#tOr!1Zrs*ssw!1Zwx(Gdx#O!1Z#O#P!2c#P#o!1Z#o#p!9z#p#q!1Z#q#r!3Q#r;'S!1Z;'S;=`!;}<%lO!1ZFT(GqZ&^7[&WW&c,X&ap&f#tOr!=XrsMks#O!=X#O#P!>V#P#o!=X#o#p!7s#p#q!=X#q#r!5x#r;'S!=X;'S;=`!?m<%lO!=XMg(Hye&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs(BOsw%Twx(EYx!Q%T!Q![(3O![!c%T!c!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OMg(Jqm&^7[&TS&WW&Q&j&Z`&ap&d!b&f#t%m,XOr%Trs(7Qsw%Twx(:jx!Q%T!Q![(3O![!c%T!c!h(3O!h!i(Hd!i!t(3O!t!u(>S!u!}(3O!}#O%T#O#P!?s#P#R%T#R#S(3O#S#T%T#T#U(3O#U#V(>S#V#Y(3O#Y#Z(Hd#Z#o(3O#o#p!Bu#p#q%T#q#r!@b#r$g%T$g;'S(3O;'S;=`(4v<%lO(3OG{(MP]!V,X&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u(N]]!UR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGz) i_%cQ&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%TGy)!qZ&TS&WW!ZGmOrEmrsFaswEmwxGsx#OEm#O#PIV#P#oEm#o#p!@b#p;'SEm;'S;=`JY<%lOEmG{)#w_%bR&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx!_%T!_!`&)_!`#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T<u)%XZ!Y7_&TS&WW&Z`&ap&d!b&f#tOr!@brs!$dsw!@bwx!4Qx#O!@b#O#P!Ad#P#o!@b#o#p!Bu#p;'S!@b;'S;=`!Co<%lO!@bGy)&_]%l,V&^7[&TS&WW&Z`&ap&d!b&f#tOr%Trs&_sw%Twx!0Vx#O%T#O#P!?s#P#o%T#o#p!Bu#p#q%T#q#r!@b#r;'S%T;'S;=`!Dz<%lO%T",tokenizers:[RP,CP,0,1,2,3,4,5,6,7,8,9,10,AP],topRules:{Script:[0,3]},specialized:[{term:213,get:i=>DP[i]||-1}],tokenPrec:7285});var eO=new fo,iO=new Set(["Script","Body","FunctionDefinition","ClassDefinition","LambdaExpression","ForStatement","MatchClause"]);function Jo(i){return(e,t,n)=>{if(n)return!1;let r=e.node.getChild("VariableName");return r&&t(r,i),!0}}var LP={FunctionDefinition:Jo("function"),ClassDefinition:Jo("class"),ForStatement(i,e,t){if(t){for(let n=i.node.firstChild;n;n=n.nextSibling)if(n.name=="VariableName")e(n,"variable");else if(n.name=="in")break}},ImportStatement(i,e){var t,n;let{node:r}=i,s=((t=r.firstChild)===null||t===void 0?void 0:t.name)=="from";for(let o=r.getChild("import");o;o=o.nextSibling)o.name=="VariableName"&&((n=o.nextSibling)===null||n===void 0?void 0:n.name)!="as"&&e(o,s?"variable":"namespace")},AssignStatement(i,e){for(let t=i.node.firstChild;t;t=t.nextSibling)if(t.name=="VariableName")e(t,"variable");else if(t.name==":"||t.name=="AssignOp")break},ParamList(i,e){for(let t=null,n=i.node.firstChild;n;n=n.nextSibling)n.name=="VariableName"&&(!t||!/\*|AssignOp/.test(t.name))&&e(n,"variable"),t=n},CapturePattern:Jo("variable"),AsPattern:Jo("variable"),__proto__:null};function rO(i,e){let t=eO.get(e);if(t)return t;let n=[],r=!0;function s(o,l){let a=i.sliceString(o.from,o.to);n.push({label:a,type:l})}return e.cursor(we.IncludeAnonymous).iterate(o=>{if(o.name){let l=LP[o.name];if(l&&l(o,s,r)||!r&&iO.has(o.name))return!1;r=!1}else if(o.to-o.from>8192){for(let l of rO(i,o.node))n.push(l);return!1}}),eO.set(e,n),n}var tO=/^[\w\xa1-\uffff][\w\d\xa1-\uffff]*$/,sO=["String","FormatString","Comment","PropertyName"];function qP(i){let e=xe(i.state).resolveInner(i.pos,-1);if(sO.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&tO.test(i.state.sliceDoc(e.from,e.to));if(!t&&!i.explicit)return null;let n=[];for(let r=e;r;r=r.parent)iO.has(r.name)&&(n=n.concat(rO(i.state.doc,r)));return{options:n,from:t?e.from:i.pos,validFor:tO}}var BP=["__annotations__","__builtins__","__debug__","__doc__","__import__","__name__","__loader__","__package__","__spec__","False","None","True"].map(i=>({label:i,type:"constant"})).concat(["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EncodingWarning","EnvironmentError","Exception","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","ModuleNotFoundError","NameError","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError"].map(i=>({label:i,type:"type"}))).concat(["bool","bytearray","bytes","classmethod","complex","float","frozenset","int","list","map","memoryview","object","range","set","staticmethod","str","super","tuple","type"].map(i=>({label:i,type:"class"}))).concat(["abs","aiter","all","anext","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","license","locals","max","min","next","oct","open","ord","pow","print","property","quit","repr","reversed","round","setattr","slice","sorted","sum","vars","zip"].map(i=>({label:i,type:"function"}))),ZP=[Yt("def ${name}(${params}):\n	${}",{label:"def",detail:"function",type:"keyword"}),Yt("for ${name} in ${collection}:\n	${}",{label:"for",detail:"loop",type:"keyword"}),Yt("while ${}:\n	${}",{label:"while",detail:"loop",type:"keyword"}),Yt("try:\n	${}\nexcept ${error}:\n	${}",{label:"try",detail:"/ except block",type:"keyword"}),Yt(`if \${}:
	
`,{label:"if",detail:"block",type:"keyword"}),Yt("if ${}:\n	${}\nelse:\n	${}",{label:"if",detail:"/ else block",type:"keyword"}),Yt("class ${name}:\n	def __init__(self, ${params}):\n			${}",{label:"class",detail:"definition",type:"keyword"}),Yt("import ${module}",{label:"import",detail:"statement",type:"keyword"}),Yt("from ${module} import ${names}",{label:"from",detail:"import",type:"keyword"})],VP=bg(sO,uc(BP.concat(ZP)));function nO(i,e){let t=i.lineIndent(e.from),n=i.lineAt(i.pos,-1),r=n.from+n.text.length;return/^\s*($|#)/.test(n.text)&&i.node.to<r+100&&!/\S/.test(i.state.sliceDoc(r,i.node.to))&&i.lineIndent(i.pos,-1)<=t||/^\s*(else:|elif |except |finally:)/.test(i.textAfter)&&i.lineIndent(i.pos,-1)>t?null:t+i.unit}var Rc=jn.define({name:"python",parser:Kg.configure({props:[qh.add({Body:i=>{var e;return(e=nO(i,i.node))!==null&&e!==void 0?e:i.continue()},IfStatement:i=>/^\s*(else:|elif )/.test(i.textAfter)?i.baseIndent:i.continue(),TryStatement:i=>/^\s*(except |finally:|else:)/.test(i.textAfter)?i.baseIndent:i.continue(),"TupleExpression ComprehensionExpression ParamList ArgList ParenthesizedExpression":wo({closing:")"}),"DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression":wo({closing:"}"}),"ArrayExpression ArrayComprehensionExpression":wo({closing:"]"}),"String FormatString":()=>null,Script:i=>{if(i.pos+/\s*/.exec(i.textAfter)[0].length>=i.node.to){let e=null;for(let t=i.node,n=t.to;t=t.lastChild,!(!t||t.to!=n);)t.type.name=="Body"&&(e=t);if(e){let t=nO(i,e);if(t!=null)return t}}return i.continue()}}),Bh.add({"ArrayExpression DictionaryExpression SetExpression TupleExpression":Jp,Body:(i,e)=>({from:i.from+1,to:i.to-(i.to==e.doc.length?0:1)})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"'''",'"""'],stringPrefixes:["f","fr","rf","r","u","b","br","rb","F","FR","RF","R","U","B","BR","RB"]},commentTokens:{line:"#"},indentOnInput:/^\s*([\}\]\)]|else:|elif |except |finally:)$/}});function oO(){return new Oo(Rc,[Rc.data.of({autocomplete:qP}),Rc.data.of({autocomplete:VP})])}var YP="#e5c07b",lO="#e06c75",NP="#56b6c2",UP="#ffffff",Ko="#abb2bf",Dc="#7d8799",FP="#61afef",jP="#98c379",aO="#d19a66",XP="#c678dd",zP="#21252b",hO="#2c313a",cO="#282c34",Mc="#353a42",HP="#3E4451",fO="#528bff";var uO=R.theme({"&":{color:Ko,backgroundColor:cO},".cm-content":{caretColor:fO},".cm-cursor, .cm-dropCursor":{borderLeftColor:fO},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:HP},".cm-panels":{backgroundColor:zP,color:Ko},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:cO,color:Dc,border:"none"},".cm-activeLineGutter":{backgroundColor:hO},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Mc},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Mc,borderBottomColor:Mc},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:hO,color:Ko}}},{dark:!0}),P$=Sn.define([{tag:w.keyword,color:XP},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:lO},{tag:[w.function(w.variableName),w.labelName],color:FP},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:aO},{tag:[w.definition(w.name),w.separator],color:Ko},{tag:[w.typeName,w.className,w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:YP},{tag:[w.operator,w.operatorKeyword,w.url,w.escape,w.regexp,w.link,w.special(w.string)],color:NP},{tag:[w.meta,w.comment],color:Dc},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.link,color:Dc,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:lO},{tag:[w.atom,w.bool,w.special(w.variableName)],color:aO},{tag:[w.processingInstruction,w.string,w.inserted],color:jP},{tag:w.invalid,color:UP}]);var dO=ye("py-repl"),GP='<svg style="height:20px;width:20px;vertical-align:-.125em;transform-origin:center;overflow:visible;color:green" viewBox="0 0 384 512" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g transform="translate(192 256)" transform-origin="96 0"><g transform="translate(0,0) scale(1,1)"><path d="M361 215C375.3 223.8 384 239.3 384 256C384 272.7 375.3 288.2 361 296.1L73.03 472.1C58.21 482 39.66 482.4 24.52 473.9C9.377 465.4 0 449.4 0 432V80C0 62.64 9.377 46.63 24.52 38.13C39.66 29.64 58.21 29.99 73.03 39.04L361 215z" fill="currentColor" transform="translate(-192 -256)"></path></g></g></svg>';function pO(i,e){class t extends HTMLElement{connectedCallback(){Wn(this),this.hasAttribute("exec-id")||this.setAttribute("exec-id","0"),this.hasAttribute("root")||this.setAttribute("root",this.id);let s=ti(this.innerHTML).trim();this.innerHTML="";let o=this.makeBoxDiv(),l=ze(".py-repl-editor > div",o).attachShadow({mode:"open"});l.innerHTML="<style> :host { all: initial; }</style>",this.appendChild(o),this.editor=this.makeEditor(s,l),this.editor.focus(),dO.debug(`element ${this.id} successfully connected`)}get src(){return this.getAttribute("src")}set src(s){this.setAttribute("src",s)}attributeChangedCallback(s,o,l){s==="src"&&l!==o&&this.loadReplSrc()}async loadReplSrc(){try{let s=await on(this.src);if(!s.ok)return;let o=ze("div.cm-content",this.editor.dom),{lastElementChild:l}=o;o.replaceChildren(l),l.textContent=await s.text(),dO.info(`loading code from ${this.src} to repl...success`)}catch(s){Ft(s.message)}}makeEditor(s,o){let l=new an,a=[bn.of("    "),Zg,l.of(oO()),pn.of([...Ao,{key:"Ctrl-Enter",run:this.execute.bind(this),preventDefault:!0},{key:"Shift-Enter",run:this.execute.bind(this),preventDefault:!0}])];return this.getAttribute("theme")==="dark"&&a.push(uO),new R({doc:s,extensions:a,parent:o})}makeBoxDiv(){let s=document.createElement("div");s.className="py-repl-box";let o=this.makeEditorDiv();return this.outDiv=this.makeOutDiv(),s.appendChild(o),s.appendChild(this.outDiv),s}makeEditorDiv(){let s=document.createElement("div");s.className="py-repl-editor",s.setAttribute("aria-label","Python Script Area");let o=this.makeRunButton(),l=document.createElement("div");return l.addEventListener("keydown",a=>{a.stopPropagation()}),s.append(l,o),s}makeRunButton(){let s=document.createElement("button");return s.className="absolute py-repl-run-button",s.innerHTML=GP,s.setAttribute("aria-label","Python Script Run Button"),s.addEventListener("click",this.execute.bind(this)),s}makeOutDiv(){let s=document.createElement("div");return s.className="py-repl-output",s.id=this.id+"-repl-output",s}async execute(){let s=this.getPySrc(),o=this.outDiv;await e.plugins.beforePyReplExec({interpreter:i,src:s,outEl:o,pyReplTag:this});let{result:l}=await ys(i,s,o);await e.plugins.afterPyReplExec({interpreter:i,src:s,outEl:o,pyReplTag:this,result:l}),this.autogenerateMaybe()}getPySrc(){return this.editor.state.doc.toString()}autogenerateMaybe(){if(this.hasAttribute("auto-generate")){let s=xt(`py-repl[root='${this.getAttribute("root")}'][exec-id]`,document),l=s[s.length-1].getAttribute("exec-id"),a=parseInt(l)+1,h=document.createElement("py-repl");for(let c of["root","output-mode","output","stderr"]){let u=this.getAttribute(c);u&&h.setAttribute(c,u)}h.id=this.getAttribute("root")+"-"+a.toString(),this.hasAttribute("auto-generate")&&(h.setAttribute("auto-generate",""),this.removeAttribute("auto-generate")),h.setAttribute("exec-id",a.toString()),this.parentElement&&this.parentElement.appendChild(h)}}}return t.observedAttributes=["src"],t}function mO(i,e){let t=pO(i,e);customElements.define("py-repl",t)}var gO={stdout_writeline:console.log,stderr_writeline:console.log};var In=class{constructor(e,t,n=!0,r=!0){this.source_element=e,this.source_attribute=t,this.capture_stdout=n,this.capture_stderr=r}writeline_by_attribute(e){let t=this.source_element.getAttribute(this.source_attribute),n=ze("#"+t,document);n===null?Xi(`${this.source_attribute} = "${t}" does not match the id of any element on the page.`):(e=Il(e).replace(`
`,"<br>"),!e.endsWith("<br/>")&&!e.endsWith("<br>")&&(e=e+"<br>"),n.innerHTML+=e)}stdout_writeline(e){this.capture_stdout&&this.writeline_by_attribute(e)}stderr_writeline(e){this.capture_stderr&&this.writeline_by_attribute(e)}},el=class{constructor(){this._listeners=[]}addListener(e){this._listeners.push(e)}removeListener(e){let t=this._listeners.indexOf(e);t>-1&&this._listeners.splice(t,1)}stdout_writeline(e){for(let t of this._listeners)t.stdout_writeline(e)}stderr_writeline(e){for(let t of this._listeners)t.stderr_writeline(e)}};var OO=ye("py-terminal"),tl=class extends Qt{constructor(t){super();this.app=t}configure(t){ia({config:t,name:"terminal",possibleValues:[!0,!1,"auto"],defaultValue:"auto"}),ia({config:t,name:"docked",possibleValues:[!0,!1,"docked"],defaultValue:"docked"})}beforeLaunch(t){let{terminal:n,docked:r}=t,s=n===!0||n==="auto",o=r===!0||r==="docked";if(s&&ze("py-terminal",document)===null){OO.info("No <py-terminal> found, adding one");let l=document.createElement("py-terminal");s&&l.setAttribute("auto",""),o&&l.setAttribute("docked",""),document.body.appendChild(l)}}afterSetup(t){let n=JP(this.app);customElements.define("py-terminal",n)}};function JP(i){class e extends HTMLElement{connectedCallback(){this.outElem=document.createElement("pre"),this.outElem.className="py-terminal",this.appendChild(this.outElem),this.isAuto()?(this.classList.add("py-terminal-hidden"),this.autoShowOnNextLine=!0):this.autoShowOnNextLine=!1,this.isDocked()&&this.classList.add("py-terminal-docked"),OO.info("Registering stdio listener"),i.registerStdioListener(this)}isAuto(){return this.hasAttribute("auto")}isDocked(){return this.hasAttribute("docked")}stdout_writeline(r){this.outElem.innerText+=r+`
`,this.isDocked()&&(this.scrollTop=this.scrollHeight),this.autoShowOnNextLine&&(this.classList.remove("py-terminal-hidden"),this.autoShowOnNextLine=!1)}stderr_writeline(r){this.stdout_writeline(r)}}return e}var yO=ye("py-splashscreen"),KP=`
The setting autoclose_loader is deprecated. Please use the
following instead:<br>
<pre>
&lt;py-config&gt;
[splashscreen]
autoclose = false
&lt;/py-config&gt;
</pre>`,nl=class extends Qt{configure(t){this.autoclose=!0,this.enabled=!0,"autoclose_loader"in t&&(this.autoclose=t.autoclose_loader,jt(KP,"html")),t.splashscreen&&(this.autoclose=t.splashscreen.autoclose??!0,this.enabled=t.splashscreen.enabled??!0)}beforeLaunch(t){this.enabled&&(yO.info("add py-splashscreen"),customElements.define("py-splashscreen",Lc),this.elem=document.createElement("py-splashscreen"),document.body.append(this.elem),document.addEventListener("py-status-message",n=>{let r=n.detail;this.elem.log(r)}))}afterStartup(t){this.autoclose&&this.enabled&&this.elem.close()}onUserError(t){this.elem!==void 0&&this.enabled&&this.elem.close()}},Lc=class extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML=`<div id="pyscript_loading_splash" class="py-overlay">
        <div class="py-pop-up">
        <div class="smooth spinner"></div>
        <div id="pyscript-loading-label" class="label">
          <div id="pyscript-operation-details">
          </div>
        </div>
        </div>
      </div>`,this.mount_name=this.id.split("-").join("_"),this.operation=ze("#pyscript-operation",document),this.details=ze("#pyscript-operation-details",document)}log(t){let n=document.createElement("p");n.innerText=t,this.details.appendChild(n)}close(){yO.info("Closing"),this.remove()}};var SO=ye("plugins/importmap"),il=class extends Qt{async afterSetup(e){for(let t of xt("script[type='importmap']",document)){let n=(()=>{try{return JSON.parse(t.textContent)}catch(r){jt("Failed to parse import map: "+r.message)}})();if(n?.imports!=null)for(let[r,s]of Object.entries(n.imports)){if(typeof r!="string"||typeof s!="string")continue;let o;try{o={...await import(s)}}catch{SO.warn(`failed to fetch '${s}' for '${r}'`);continue}SO.info("Registering JS module",r),await e._remote.registerJsModule(r,o)}}}};var rl=class extends Qt{constructor(t){super();this._stdioMultiplexer=t}beforePyScriptExec(t){if(t.pyScriptTag.hasAttribute("output")){let n=new In(t.pyScriptTag,"output",!0,!0);t.pyScriptTag.stdout_manager=n,this._stdioMultiplexer.addListener(n)}if(t.pyScriptTag.hasAttribute("stderr")){let n=new In(t.pyScriptTag,"stderr",!1,!0);t.pyScriptTag.stderr_manager=n,this._stdioMultiplexer.addListener(n)}}afterPyScriptExec(t){t.pyScriptTag.stdout_manager!=null&&(this._stdioMultiplexer.removeListener(t.pyScriptTag.stdout_manager),t.pyScriptTag.stdout_manager=null),t.pyScriptTag.stderr_manager!=null&&(this._stdioMultiplexer.removeListener(t.pyScriptTag.stderr_manager),t.pyScriptTag.stderr_manager=null)}beforePyReplExec(t){t.pyReplTag.getAttribute("output-mode")!="append"&&(t.outEl.innerHTML="");let n;if(t.pyReplTag.hasAttribute("output")?n=new In(t.pyReplTag,"output",!0,!0):n=new In(t.pyReplTag.outDiv,"id",!0,!0),t.pyReplTag.stdout_manager=n,this._stdioMultiplexer.addListener(n),t.pyReplTag.hasAttribute("stderr")){let r=new In(t.pyReplTag,"stderr",!1,!0);t.pyReplTag.stderr_manager=r,this._stdioMultiplexer.addListener(r)}}async afterPyReplExec(t){if(t.result!==void 0){let n=t.pyReplTag.getAttribute("output");n?ze("#"+n,document)?await oa(t.interpreter,t.result,{target:n}):Xi(`output = "${n}" does not match the id of any element on the page.`):await oa(t.interpreter,t.result,{target:t.outEl.id})}t.pyReplTag.stdout_manager!=null&&(this._stdioMultiplexer.removeListener(t.pyReplTag.stdout_manager),t.pyReplTag.stdout_manager=null),t.pyReplTag.stderr_manager!=null&&(this._stdioMultiplexer.removeListener(t.pyReplTag.stderr_manager),t.pyReplTag.stderr_manager=null)}};var sl={dirs:["pyscript"],files:[["pyscript/_event_loop.py",`import asyncio
import contextvars
from collections.abc import Callable
from contextlib import contextmanager
from typing import Any

from js import setTimeout
from pyodide.ffi import create_once_callable
from pyodide.webloop import WebLoop


class PyscriptWebLoop(WebLoop):
    def __init__(self):
        super().__init__()
        self._ready = False
        self._usercode = False
        self._deferred_handles = []

    def call_later(
        self,
        delay: float,
        callback: Callable[..., Any],
        *args: Any,
        context: contextvars.Context | None = None,
    ) -> asyncio.Handle:
        """Based on call_later from Pyodide's webloop

        With some unneeded stuff removed and a mechanism for deferring tasks
        scheduled from user code.
        """
        if delay < 0:
            raise ValueError("Can't schedule in the past")
        h = asyncio.Handle(callback, args, self, context=context)

        def run_handle():
            if h.cancelled():
                return
            h._run()

        if self._ready or not self._usercode:
            setTimeout(create_once_callable(run_handle), delay * 1000)
        else:
            self._deferred_handles.append((run_handle, self.time() + delay))
        return h

    def _schedule_deferred_tasks(self):
        asyncio._set_running_loop(self)
        t = self.time()
        for [run_handle, delay] in self._deferred_handles:
            delay = delay - t
            if delay < 0:
                delay = 0
            setTimeout(create_once_callable(run_handle), delay * 1000)
        self._ready = True
        self._deferred_handles = []


LOOP = None


def install_pyscript_loop():
    global LOOP
    LOOP = PyscriptWebLoop()
    asyncio.set_event_loop(LOOP)


def schedule_deferred_tasks():
    LOOP._schedule_deferred_tasks()


@contextmanager
def defer_user_asyncio():
    LOOP._usercode = True
    try:
        yield
    finally:
        LOOP._usercode = False


def run_until_complete(f):
    return LOOP.run_until_complete(f)
`],["pyscript/_deprecated_globals.py",`from _pyscript_js import showWarning


class DeprecatedGlobal:
    """
    Proxy for globals which are deprecated.

    The intendend usage is as follows:

        # in the global namespace
        Element = pyscript.DeprecatedGlobal('Element', pyscript.Element, "...")
        console = pyscript.DeprecatedGlobal('console', js.console, "...")
        ...

    The proxy forwards __getattr__ and __call__ to the underlying object, and
    emit a warning on the first usage.

    This way users see a warning only if they actually access the top-level
    name.
    """

    def __init__(self, name, obj, message):
        self.__name = name
        self.__obj = obj
        self.__message = message
        self.__warning_already_shown = False

    def __repr__(self):
        return f"<DeprecatedGlobal({self.__name!r})>"

    def _show_warning(self, message):
        """
        NOTE: this is overridden by unit tests
        """
        showWarning(message, "html")  # noqa: F821

    def _show_warning_maybe(self):
        if self.__warning_already_shown:
            return
        self._show_warning(self.__message)
        self.__warning_already_shown = True

    def __getattr__(self, attr):
        self._show_warning_maybe()
        return getattr(self.__obj, attr)

    def __call__(self, *args, **kwargs):
        self._show_warning_maybe()
        return self.__obj(*args, **kwargs)

    def __iter__(self):
        self._show_warning_maybe()
        return iter(self.__obj)

    def __getitem__(self, key):
        self._show_warning_maybe()
        return self.__obj[key]

    def __setitem__(self, key, value):
        self._show_warning_maybe()
        self.__obj[key] = value
`],["pyscript/_plugin.py",`from _pyscript_js import define_custom_element
from js import console
from pyodide.ffi import create_proxy


class Plugin:
    def __init__(self, name=None):
        if not name:
            name = self.__class__.__name__

        self.name = name
        self._custom_elements = []
        self.app = None

    def init(self, app):
        self.app = app

    def configure(self, config):
        pass

    def afterSetup(self, interpreter):
        pass

    def afterStartup(self, interpreter):
        pass

    def beforePyScriptExec(self, interpreter, src, pyScriptTag):
        pass

    def afterPyScriptExec(self, interpreter, src, pyScriptTag, result):
        pass

    def beforePyReplExec(self, interpreter, src, outEl, pyReplTag):
        pass

    def afterPyReplExec(self, interpreter, src, outEl, pyReplTag, result):
        pass

    def onUserError(self, error):
        pass

    def register_custom_element(self, tag):
        """
        Decorator to register a new custom element as part of a Plugin and associate
        tag to it. Internally, it delegates the registration to the PyScript internal
        [JS] plugin manager, who actually creates the JS custom element that can be
        attached to the page and instantiate an instance of the class passing the custom
        element to the plugin constructor.

        Exammple:
        >> plugin = Plugin("PyTutorial")
        >> @plugin.register_custom_element("py-tutor")
        >> class PyTutor:
        >>     def __init__(self, element):
        >>     self.element = element
        """
        # TODO: Ideally would be better to use the logger.
        console.info(f"Defining new custom element {tag}")

        def wrapper(class_):
            # TODO: this is very pyodide specific but will have to do
            #       until we have JS interface that works across interpreters
            define_custom_element(tag, create_proxy(class_))  # noqa: F821

        self._custom_elements.append(tag)
        return create_proxy(wrapper)
`],["pyscript/_html.py~",`import time
from textwrap import dedent

from js import console, document

from . import _internal
from ._mime import format_mime as _format_mime


class HTML:
    """
    Wrap a string so that display() can render it as plain HTML
    """

    def __init__(self, html):
        self._html = html

    def _repr_html_(self):
        return self._html


def write(element_id, value, append=False, exec_id=0):
    """Writes value to the element with id "element_id"""
    Element(element_id).write(value=value, append=append)
    console.warn(
        dedent(
            """PyScript Deprecation Warning: PyScript.write is
    marked as deprecated and will be removed sometime soon. Please, use
    Element(<id>).write instead."""
        )
    )


def display(*values, target=None, append=True):
    if target is None:
        target = _internal.DISPLAY_TARGET
    if target is None:
        raise Exception(
            "Implicit target not allowed here. Please use display(..., target=...)"
        )
    for v in values:
        Element(target).write(v, append=append)


class Element:
    def __init__(self, element_id, element=None):
        self._id = element_id
        self._element = element

    @property
    def id(self):
        return self._id

    @property
    def element(self):
        """Return the dom element"""
        if not self._element:
            self._element = document.querySelector(f"#{self._id}")
        return self._element

    @property
    def value(self):
        return self.element.value

    @property
    def innerHtml(self):
        return self.element.innerHTML

    def write(self, value, append=False):
        html, mime_type = _format_mime(value)
        if html == "\\n":
            return

        if append:
            child = document.createElement("div")
            self.element.appendChild(child)

        if append and self.element.children:
            out_element = self.element.children[-1]
        else:
            out_element = self.element

        if mime_type in ("application/javascript", "text/html"):
            script_element = document.createRange().createContextualFragment(html)
            out_element.appendChild(script_element)
        else:
            out_element.innerHTML = html

    def clear(self):
        if hasattr(self.element, "value"):
            self.element.value = ""
        else:
            self.write("", append=False)

    def select(self, query, from_content=False):
        el = self.element

        if from_content:
            el = el.content

        _el = el.querySelector(query)
        if _el:
            return Element(_el.id, _el)
        else:
            console.warn(f"WARNING: can't find element matching query {query}")

    def clone(self, new_id=None, to=None):
        if new_id is None:
            new_id = self.element.id

        clone = self.element.cloneNode(True)
        clone.id = new_id

        if to:
            to.element.appendChild(clone)
            # Inject it into the DOM
            to.element.after(clone)
        else:
            # Inject it into the DOM
            self.element.after(clone)

        return Element(clone.id, clone)

    def remove_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.remove_class(cl)
        else:
            self.element.classList.remove(classname)

    def add_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.element.classList.add(cl)
        else:
            self.element.classList.add(classname)


def add_classes(element, class_list):
    for klass in class_list.split(" "):
        element.classList.add(klass)


def create(what, id_=None, classes=""):
    element = document.createElement(what)
    if id_:
        element.id = id_
    add_classes(element, classes)
    return Element(id_, element)


class PyWidgetTheme:
    def __init__(self, main_style_classes):
        self.main_style_classes = main_style_classes

    def theme_it(self, widget):
        for klass in self.main_style_classes.split(" "):
            widget.classList.add(klass)


class PyItemTemplate(Element):
    label_fields = None

    def __init__(self, data, labels=None, state_key=None, parent=None):
        self.data = data

        self.register_parent(parent)

        if not labels:
            labels = list(self.data.keys())
        self.labels = labels

        self.state_key = state_key

        super().__init__(self._id)

    def register_parent(self, parent):
        self._parent = parent
        if parent:
            self._id = f"{self._parent._id}-c-{len(self._parent._children)}"
            self.data["id"] = self._id
        else:
            self._id = None

    def create(self):
        new_child = create("div", self._id, "py-li-element")
        new_child._element.innerHTML = dedent(
            f"""
            <label id="{self._id}" for="flex items-center p-2 ">
              <input class="mr-2" type="checkbox" class="task-check">
              <p>{self.render_content()}</p>
            </label>
            """
        )
        return new_child

    def on_click(self, evt):
        pass

    def pre_append(self):
        pass

    def post_append(self):
        self.element.click = self.on_click
        self.element.onclick = self.on_click

        self._post_append()

    def _post_append(self):
        pass

    def strike(self, value, extra=None):
        if value:
            self.add_class("line-through")
        else:
            self.remove_class("line-through")

    def render_content(self):
        return " - ".join([self.data[f] for f in self.labels])


class PyListTemplate:
    theme = PyWidgetTheme("py-li-element")
    item_class = PyItemTemplate

    def __init__(self, parent):
        self.parent = parent
        self._children = []
        self._id = self.parent.id

    @property
    def children(self):
        return self._children

    @property
    def data(self):
        return [c.data for c in self._children]

    def render_children(self):
        binds = {}
        for i, c in enumerate(self._children):
            txt = c.element.innerHTML
            rnd = str(time.time()).replace(".", "")[-5:]
            new_id = f"{c.element.id}-{i}-{rnd}"
            binds[new_id] = c.element.id
            txt = txt.replace(">", f" id='{new_id}'>")
            print(txt)

        def foo(evt):
            evtEl = evt.srcElement
            srcEl = Element(binds[evtEl.id])
            srcEl.element.onclick()
            evtEl.classList = srcEl.element.classList

        for new_id in binds:
            Element(new_id).element.onclick = foo

    def connect(self):
        self.md = main_div = document.createElement("div")
        main_div.id = self._id + "-list-tasks-container"

        if self.theme:
            self.theme.theme_it(main_div)

        self.parent.appendChild(main_div)

    def add(self, *args, **kws):
        if not isinstance(args[0], self.item_class):
            child = self.item_class(*args, **kws)
        else:
            child = args[0]
        child.register_parent(self)
        return self._add(child)

    def _add(self, child_elem):
        self.pre_child_append(child_elem)
        child_elem.pre_append()
        self._children.append(child_elem)
        self.md.appendChild(child_elem.create().element)
        child_elem.post_append()
        self.child_appended(child_elem)
        return child_elem

    def pre_child_append(self, child):
        pass

    def child_appended(self, child):
        """Overwrite me to define logic"""
        pass
`],["pyscript/_event_handling.py",`import inspect

import js
from pyodide.ffi.wrappers import add_event_listener


def when(event_type=None, selector=None):
    """
    Decorates a function and passes py-* events to the decorated function
    The events might or not be an argument of the decorated function
    """

    def decorator(func):
        elements = js.document.querySelectorAll(selector)
        sig = inspect.signature(func)
        # Function doesn't receive events
        if not sig.parameters:

            def wrapper(*args, **kwargs):
                func()

            for el in elements:
                add_event_listener(el, event_type, wrapper)
        else:
            for el in elements:
                add_event_listener(el, event_type, func)
        return func

    return decorator
`],["pyscript/_internal.py",`import ast
from collections import namedtuple
from contextlib import contextmanager

from js import Object
from pyodide.code import eval_code
from pyodide.ffi import JsProxy

from ._event_loop import (
    defer_user_asyncio,
    install_pyscript_loop,
    schedule_deferred_tasks,
)

VersionInfo = namedtuple("version_info", ("year", "month", "minor", "releaselevel"))


def set_version_info(version_from_interpreter: str):
    from . import __dict__ as pyscript_dict

    """Sets the __version__ and version_info properties from provided JSON data
    Args:
        version_from_interpreter (str): A "dotted" representation of the version:
            YYYY.MM.m(m).releaselevel
            Year, Month, and Minor should be integers; releaselevel can be any string
    """

    version_parts = version_from_interpreter.split(".")
    year = int(version_parts[0])
    month = int(version_parts[1])
    minor = int(version_parts[2])
    if len(version_parts) > 3:
        releaselevel = version_parts[3]
    else:
        releaselevel = ""

    version_info = VersionInfo(year, month, minor, releaselevel)

    pyscript_dict["__version__"] = version_from_interpreter
    pyscript_dict["version_info"] = version_info


class TopLevelAwaitFinder(ast.NodeVisitor):
    def is_source_top_level_await(self, source):
        self.async_found = False
        node = ast.parse(source)
        self.generic_visit(node)
        return self.async_found

    def visit_Await(self, node):
        self.async_found = True

    def visit_AsyncFor(self, node):
        self.async_found = True

    def visit_AsyncWith(self, node):
        self.async_found = True

    def visit_AsyncFunctionDef(self, node: ast.AsyncFunctionDef):
        pass  # Do not visit children of async function defs


def uses_top_level_await(source: str) -> bool:
    return TopLevelAwaitFinder().is_source_top_level_await(source)


DISPLAY_TARGET = None


@contextmanager
def display_target(target_id):
    global DISPLAY_TARGET
    DISPLAY_TARGET = target_id
    try:
        yield
    finally:
        DISPLAY_TARGET = None


def run_pyscript(code: str, id: str = None) -> JsProxy:
    """Execute user code inside context managers.

    Uses the __main__ global namespace.

    The output is wrapped inside a JavaScript object since an object is not
    thenable. This is so we do not accidentally \`await\` the result of the python
    execution, even if it's awaitable (Future, Task, etc.)

    Parameters
    ----------
    code :
       The code to run

    id :
       The id for the default display target (or None if no default display target).

    Returns
    -------
        A Js Object of the form {result: the_result}
    """
    import __main__

    with display_target(id), defer_user_asyncio():
        result = eval_code(code, globals=__main__.__dict__)

    return Object.new(result=result)


__all__ = [
    "set_version_info",
    "uses_top_level_await",
    "run_pyscript",
    "install_pyscript_loop",
    "schedule_deferred_tasks",
]
`],["pyscript/__init__.py",`from _pyscript_js import showWarning

from ._event_handling import when
from ._event_loop import LOOP as loop
from ._event_loop import run_until_complete
from ._html import (
    HTML,
    Element,
    add_classes,
    create,
    display,
    write,
)
from ._plugin import Plugin

# these are set by _set_version_info
__version__ = None
version_info = None


def __getattr__(attr):
    if attr == "js":
        global js
        import js
        from _pyscript_js import showWarning

        # Deprecated after 2023.03.1
        showWarning(
            "<code>pyscript.js</code> is deprecated, please use <code>import js</code> instead.",
            "html",
        )
        return js
    raise AttributeError(f"module 'pyscript' has no attribute '{attr}'")


__all__ = [
    "HTML",
    "write",
    "display",
    "Element",
    "add_classes",
    "create",
    "run_until_complete",
    "loop",
    "Plugin",
    "__version__",
    "version_info",
    "showWarning",
    "when",
]
`],["pyscript/_mime.py",`import base64
import html
import io
import re

from js import console

MIME_METHODS = {
    "__repr__": "text/plain",
    "_repr_html_": "text/html",
    "_repr_markdown_": "text/markdown",
    "_repr_svg_": "image/svg+xml",
    "_repr_png_": "image/png",
    "_repr_pdf_": "application/pdf",
    "_repr_jpeg_": "image/jpeg",
    "_repr_latex": "text/latex",
    "_repr_json_": "application/json",
    "_repr_javascript_": "application/javascript",
    "savefig": "image/png",
}


def render_image(mime, value, meta):
    # If the image value is using bytes we should convert it to base64
    # otherwise it will return raw bytes and the browser will not be able to
    # render it.
    if isinstance(value, bytes):
        value = base64.b64encode(value).decode("utf-8")

    # This is the pattern of base64 strings
    base64_pattern = re.compile(
        r"^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"
    )
    # If value doesn't match the base64 pattern we should encode it to base64
    if len(value) > 0 and not base64_pattern.match(value):
        value = base64.b64encode(value.encode("utf-8")).decode("utf-8")

    data = f"data:{mime};charset=utf-8;base64,{value}"
    attrs = " ".join(['{k}="{v}"' for k, v in meta.items()])
    return f'<img src="{data}" {attrs}></img>'


def identity(value, meta):
    return value


MIME_RENDERERS = {
    "text/plain": html.escape,
    "text/html": identity,
    "image/png": lambda value, meta: render_image("image/png", value, meta),
    "image/jpeg": lambda value, meta: render_image("image/jpeg", value, meta),
    "image/svg+xml": identity,
    "application/json": identity,
    "application/javascript": lambda value, meta: f"<script>{value}<\/script>",
}


def eval_formatter(obj, print_method):
    """
    Evaluates a formatter method.
    """
    if print_method == "__repr__":
        return repr(obj)
    elif hasattr(obj, print_method):
        if print_method == "savefig":
            buf = io.BytesIO()
            obj.savefig(buf, format="png")
            buf.seek(0)
            return base64.b64encode(buf.read()).decode("utf-8")
        return getattr(obj, print_method)()
    elif print_method == "_repr_mimebundle_":
        return {}, {}
    return None


def format_mime(obj):
    """
    Formats object using _repr_x_ methods.
    """
    if isinstance(obj, str):
        return html.escape(obj), "text/plain"

    mimebundle = eval_formatter(obj, "_repr_mimebundle_")
    if isinstance(mimebundle, tuple):
        format_dict, _ = mimebundle
    else:
        format_dict = mimebundle

    output, not_available = None, []
    for method, mime_type in reversed(MIME_METHODS.items()):
        if mime_type in format_dict:
            output = format_dict[mime_type]
        else:
            output = eval_formatter(obj, method)

        if output is None:
            continue
        elif mime_type not in MIME_RENDERERS:
            not_available.append(mime_type)
            continue
        break
    if output is None:
        if not_available:
            console.warn(
                f"Rendered object requested unavailable MIME renderers: {not_available}"
            )
        output = repr(output)
        mime_type = "text/plain"
    elif isinstance(output, tuple):
        output, meta = output
    else:
        meta = {}
    return MIME_RENDERERS[mime_type](output, meta), mime_type
`],["pyscript/_html.py",`from textwrap import dedent

import js
from _pyscript_js import deepQuerySelector

from . import _internal
from ._mime import format_mime as _format_mime


class HTML:
    """
    Wrap a string so that display() can render it as plain HTML
    """

    def __init__(self, html):
        self._html = html

    def _repr_html_(self):
        return self._html


def write(element_id, value, append=False, exec_id=0):
    """Writes value to the element with id "element_id"""
    Element(element_id).write(value=value, append=append)
    js.console.warn(
        dedent(
            """PyScript Deprecation Warning: PyScript.write is
    marked as deprecated and will be removed sometime soon. Please, use
    Element(<id>).write instead."""
        )
    )


def display(*values, target=None, append=True):
    if target is None:
        target = _internal.DISPLAY_TARGET
    if target is None:
        raise Exception(
            "Implicit target not allowed here. Please use display(..., target=...)"
        )
    for v in values:
        Element(target).write(v, append=append)


class Element:
    def __init__(self, element_id, element=None):
        self._id = element_id
        self._element = element

    @property
    def id(self):
        return self._id

    @property
    def element(self):
        """Return the dom element"""
        if not self._element:
            self._element = deepQuerySelector(f"#{self._id}")
        return self._element

    @property
    def value(self):
        return self.element.value

    @property
    def innerHtml(self):
        return self.element.innerHTML

    def write(self, value, append=False):
        html, mime_type = _format_mime(value)
        if html == "\\n":
            return

        if append:
            child = js.document.createElement("div")
            self.element.appendChild(child)

        if append and self.element.children:
            out_element = self.element.children[-1]
        else:
            out_element = self.element

        if mime_type in ("application/javascript", "text/html"):
            script_element = js.document.createRange().createContextualFragment(html)
            out_element.appendChild(script_element)
        else:
            out_element.innerHTML = html

    def clear(self):
        if hasattr(self.element, "value"):
            self.element.value = ""
        else:
            self.write("", append=False)

    def select(self, query, from_content=False):
        el = self.element

        if from_content:
            el = el.content

        _el = el.querySelector(query)
        if _el:
            return Element(_el.id, _el)
        else:
            js.console.warn(f"WARNING: can't find element matching query {query}")

    def clone(self, new_id=None, to=None):
        if new_id is None:
            new_id = self.element.id

        clone = self.element.cloneNode(True)
        clone.id = new_id

        if to:
            to.element.appendChild(clone)
            # Inject it into the DOM
            to.element.after(clone)
        else:
            # Inject it into the DOM
            self.element.after(clone)

        return Element(clone.id, clone)

    def remove_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.remove_class(cl)
        else:
            self.element.classList.remove(classname)

    def add_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.element.classList.add(cl)
        else:
            self.element.classList.add(classname)


def add_classes(element, class_list):
    for klass in class_list.split(" "):
        element.classList.add(klass)


def create(what, id_=None, classes=""):
    element = js.document.createElement(what)
    if id_:
        element.id = id_
    add_classes(element, classes)
    return Element(id_, element)
`],["pyscript.py~",`import ast
import asyncio
import base64
import html
import io
import re
import time
from collections import namedtuple
from textwrap import dedent

import js

try:
    from pyodide import create_proxy
except ImportError:
    from pyodide.ffi import create_proxy

loop = asyncio.get_event_loop()

MIME_METHODS = {
    "__repr__": "text/plain",
    "_repr_html_": "text/html",
    "_repr_markdown_": "text/markdown",
    "_repr_svg_": "image/svg+xml",
    "_repr_png_": "image/png",
    "_repr_pdf_": "application/pdf",
    "_repr_jpeg_": "image/jpeg",
    "_repr_latex": "text/latex",
    "_repr_json_": "application/json",
    "_repr_javascript_": "application/javascript",
    "savefig": "image/png",
}


def render_image(mime, value, meta):
    # If the image value is using bytes we should convert it to base64
    # otherwise it will return raw bytes and the browser will not be able to
    # render it.
    if isinstance(value, bytes):
        value = base64.b64encode(value).decode("utf-8")

    # This is the pattern of base64 strings
    base64_pattern = re.compile(
        r"^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"
    )
    # If value doesn't match the base64 pattern we should encode it to base64
    if len(value) > 0 and not base64_pattern.match(value):
        value = base64.b64encode(value.encode("utf-8")).decode("utf-8")

    data = f"data:{mime};charset=utf-8;base64,{value}"
    attrs = " ".join(['{k}="{v}"' for k, v in meta.items()])
    return f'<img src="{data}" {attrs}></img>'


def identity(value, meta):
    return value


MIME_RENDERERS = {
    "text/plain": html.escape,
    "text/html": identity,
    "image/png": lambda value, meta: render_image("image/png", value, meta),
    "image/jpeg": lambda value, meta: render_image("image/jpeg", value, meta),
    "image/svg+xml": identity,
    "application/json": identity,
    "application/javascript": lambda value, meta: f"<script>{value}<\/script>",
}


# these are set by _set_version_info
__version__ = None
version_info = None


def _set_version_info(version_from_interpreter: str):
    """Sets the __version__ and version_info properties from provided JSON data
    Args:
        version_from_interpreter (str): A "dotted" representation of the version:
            YYYY.MM.m(m).releaselevel
            Year, Month, and Minor should be integers; releaselevel can be any string
    """
    global __version__
    global version_info

    __version__ = version_from_interpreter

    version_parts = version_from_interpreter.split(".")
    year = int(version_parts[0])
    month = int(version_parts[1])
    minor = int(version_parts[2])
    if len(version_parts) > 3:
        releaselevel = version_parts[3]
    else:
        releaselevel = ""

    VersionInfo = namedtuple("version_info", ("year", "month", "minor", "releaselevel"))
    version_info = VersionInfo(year, month, minor, releaselevel)

    # we ALSO set PyScript.__version__ and version_info for backwards
    # compatibility. Should be killed eventually.
    PyScript.__version__ = __version__
    PyScript.version_info = version_info


class HTML:
    """
    Wrap a string so that display() can render it as plain HTML
    """

    def __init__(self, html):
        self._html = html

    def _repr_html_(self):
        return self._html


def eval_formatter(obj, print_method):
    """
    Evaluates a formatter method.
    """
    if print_method == "__repr__":
        return repr(obj)
    elif hasattr(obj, print_method):
        if print_method == "savefig":
            buf = io.BytesIO()
            obj.savefig(buf, format="png")
            buf.seek(0)
            return base64.b64encode(buf.read()).decode("utf-8")
        return getattr(obj, print_method)()
    elif print_method == "_repr_mimebundle_":
        return {}, {}
    return None


def format_mime(obj):
    """
    Formats object using _repr_x_ methods.
    """
    if isinstance(obj, str):
        return html.escape(obj), "text/plain"

    mimebundle = eval_formatter(obj, "_repr_mimebundle_")
    if isinstance(mimebundle, tuple):
        format_dict, _ = mimebundle
    else:
        format_dict = mimebundle

    output, not_available = None, []
    for method, mime_type in reversed(MIME_METHODS.items()):
        if mime_type in format_dict:
            output = format_dict[mime_type]
        else:
            output = eval_formatter(obj, method)

        if output is None:
            continue
        elif mime_type not in MIME_RENDERERS:
            not_available.append(mime_type)
            continue
        break
    if output is None:
        if not_available:
            js.console.warn(
                f"Rendered object requested unavailable MIME renderers: {not_available}"
            )
        output = repr(output)
        mime_type = "text/plain"
    elif isinstance(output, tuple):
        output, meta = output
    else:
        meta = {}
    return MIME_RENDERERS[mime_type](output, meta), mime_type


@staticmethod
def run_until_complete(f):
    _ = loop.run_until_complete(f)


@staticmethod
def write(element_id, value, append=False, exec_id=0):
    """Writes value to the element with id "element_id"""
    Element(element_id).write(value=value, append=append)
    js.console.warn(
        dedent(
            """PyScript Deprecation Warning: PyScript.write is
    marked as deprecated and will be removed sometime soon. Please, use
    Element(<id>).write instead."""
        )
    )


def set_current_display_target(target_id):
    get_current_display_target._id = target_id


def get_current_display_target():
    return get_current_display_target._id


get_current_display_target._id = None


def display(*values, target=None, append=True):
    default_target = get_current_display_target()
    if default_target is None and target is None:
        raise Exception(
            "Implicit target not allowed here. Please use display(..., target=...)"
        )
    if target is not None:
        for v in values:
            Element(target).write(v, append=append)
    else:
        for v in values:
            Element(default_target).write(v, append=append)


class Element:
    def __init__(self, element_id, element=None):
        self._id = element_id
        self._element = element

    @property
    def id(self):
        return self._id

    @property
    def element(self):
        """Return the dom element"""
        if not self._element:
            self._element = js.document.querySelector(f"#{self._id}")
        return self._element

    @property
    def value(self):
        return self.element.value

    @property
    def innerHtml(self):
        return self.element.innerHTML

    def write(self, value, append=False):
        html, mime_type = format_mime(value)
        if html == "\\n":
            return

        if append:
            child = js.document.createElement("div")
            self.element.appendChild(child)

        if append and self.element.children:
            out_element = self.element.children[-1]
        else:
            out_element = self.element

        if mime_type in ("application/javascript", "text/html"):
            script_element = js.document.createRange().createContextualFragment(html)
            out_element.appendChild(script_element)
        else:
            out_element.innerHTML = html

    def clear(self):
        if hasattr(self.element, "value"):
            self.element.value = ""
        else:
            self.write("", append=False)

    def select(self, query, from_content=False):
        el = self.element

        if from_content:
            el = el.content

        _el = el.querySelector(query)
        if _el:
            return Element(_el.id, _el)
        else:
            js.console.warn(f"WARNING: can't find element matching query {query}")

    def clone(self, new_id=None, to=None):
        if new_id is None:
            new_id = self.element.id

        clone = self.element.cloneNode(True)
        clone.id = new_id

        if to:
            to.element.appendChild(clone)
            # Inject it into the DOM
            to.element.after(clone)
        else:
            # Inject it into the DOM
            self.element.after(clone)

        return Element(clone.id, clone)

    def remove_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.remove_class(cl)
        else:
            self.element.classList.remove(classname)

    def add_class(self, classname):
        if isinstance(classname, list):
            for cl in classname:
                self.element.classList.add(cl)
        else:
            self.element.classList.add(classname)


def add_classes(element, class_list):
    for klass in class_list.split(" "):
        element.classList.add(klass)


def create(what, id_=None, classes=""):
    element = js.document.createElement(what)
    if id_:
        element.id = id_
    add_classes(element, classes)
    return Element(id_, element)


class PyWidgetTheme:
    def __init__(self, main_style_classes):
        self.main_style_classes = main_style_classes

    def theme_it(self, widget):
        for klass in self.main_style_classes.split(" "):
            widget.classList.add(klass)


class PyItemTemplate(Element):
    label_fields = None

    def __init__(self, data, labels=None, state_key=None, parent=None):
        self.data = data

        self.register_parent(parent)

        if not labels:
            labels = list(self.data.keys())
        self.labels = labels

        self.state_key = state_key

        super().__init__(self._id)

    def register_parent(self, parent):
        self._parent = parent
        if parent:
            self._id = f"{self._parent._id}-c-{len(self._parent._children)}"
            self.data["id"] = self._id
        else:
            self._id = None

    def create(self):
        new_child = create("div", self._id, "py-li-element")
        new_child._element.innerHTML = dedent(
            f"""
            <label id="{self._id}" for="flex items-center p-2 ">
              <input class="mr-2" type="checkbox" class="task-check">
              <p>{self.render_content()}</p>
            </label>
            """
        )
        return new_child

    def on_click(self, evt):
        pass

    def pre_append(self):
        pass

    def post_append(self):
        self.element.click = self.on_click
        self.element.onclick = self.on_click

        self._post_append()

    def _post_append(self):
        pass

    def strike(self, value, extra=None):
        if value:
            self.add_class("line-through")
        else:
            self.remove_class("line-through")

    def render_content(self):
        return " - ".join([self.data[f] for f in self.labels])


class PyListTemplate:
    theme = PyWidgetTheme("py-li-element")
    item_class = PyItemTemplate

    def __init__(self, parent):
        self.parent = parent
        self._children = []
        self._id = self.parent.id

    @property
    def children(self):
        return self._children

    @property
    def data(self):
        return [c.data for c in self._children]

    def render_children(self):
        binds = {}
        for i, c in enumerate(self._children):
            txt = c.element.innerHTML
            rnd = str(time.time()).replace(".", "")[-5:]
            new_id = f"{c.element.id}-{i}-{rnd}"
            binds[new_id] = c.element.id
            txt = txt.replace(">", f" id='{new_id}'>")
            print(txt)

        def foo(evt):
            evtEl = evt.srcElement
            srcEl = Element(binds[evtEl.id])
            srcEl.element.onclick()
            evtEl.classList = srcEl.element.classList

        for new_id in binds:
            Element(new_id).element.onclick = foo

    def connect(self):
        self.md = main_div = js.document.createElement("div")
        main_div.id = self._id + "-list-tasks-container"

        if self.theme:
            self.theme.theme_it(main_div)

        self.parent.appendChild(main_div)

    def add(self, *args, **kws):
        if not isinstance(args[0], self.item_class):
            child = self.item_class(*args, **kws)
        else:
            child = args[0]
        child.register_parent(self)
        return self._add(child)

    def _add(self, child_elem):
        self.pre_child_append(child_elem)
        child_elem.pre_append()
        self._children.append(child_elem)
        self.md.appendChild(child_elem.create().element)
        child_elem.post_append()
        self.child_appended(child_elem)
        return child_elem

    def pre_child_append(self, child):
        pass

    def child_appended(self, child):
        """Overwrite me to define logic"""
        pass


class TopLevelAsyncFinder(ast.NodeVisitor):
    def is_source_top_level_await(self, source):
        self.async_found = False
        node = ast.parse(source)
        self.generic_visit(node)
        return self.async_found

    def visit_Await(self, node):
        self.async_found = True

    def visit_AsyncFor(self, node):
        self.async_found = True

    def visit_AsyncWith(self, node):
        self.async_found = True

    def visit_AsyncFunctionDef(self, node: ast.AsyncFunctionDef):
        pass  # Do not visit children of async function defs


def uses_top_level_await(source: str) -> bool:
    return TopLevelAsyncFinder().is_source_top_level_await(source)


class Plugin:
    def __init__(self, name=None):
        if not name:
            name = self.__class__.__name__

        self.name = name
        self._custom_elements = []
        self.app = None

    def init(self, app):
        self.app = app

    def register_custom_element(self, tag):
        """
        Decorator to register a new custom element as part of a Plugin and associate
        tag to it. Internally, it delegates the registration to the PyScript internal
        [JS] plugin manager, who actually creates the JS custom element that can be
        attached to the page and instantiate an instance of the class passing the custom
        element to the plugin constructor.

        Exammple:
        >> plugin = Plugin("PyTutorial")
        >> @plugin.register_custom_element("py-tutor")
        >> class PyTutor:
        >>     def __init__(self, element):
        >>     self.element = element
        """
        # TODO: Ideally would be better to use the logger.
        js.console.info(f"Defining new custom element {tag}")

        def wrapper(class_):
            # TODO: this is very pyodide specific but will have to do
            #       until we have JS interface that works across interpreters
            define_custom_element(tag, create_proxy(class_))  # noqa: F821

        self._custom_elements.append(tag)
        return create_proxy(wrapper)


class DeprecatedGlobal:
    """
    Proxy for globals which are deprecated.

    The intendend usage is as follows:

        # in the global namespace
        Element = pyscript.DeprecatedGlobal('Element', pyscript.Element, "...")
        console = pyscript.DeprecatedGlobal('console', js.console, "...")
        ...

    The proxy forwards __getattr__ and __call__ to the underlying object, and
    emit a warning on the first usage.

    This way users see a warning only if they actually access the top-level
    name.
    """

    def __init__(self, name, obj, message):
        self.__name = name
        self.__obj = obj
        self.__message = message
        self.__warning_already_shown = False

    def __repr__(self):
        return f"<DeprecatedGlobal({self.__name!r})>"

    def _show_warning(self, message):
        """
        NOTE: this is overridden by unit tests
        """
        # this showWarning is implemented in js and injected into this
        # namespace by main.ts
        showWarning(message, "html")  # noqa: F821

    def _show_warning_maybe(self):
        if self.__warning_already_shown:
            return
        self._show_warning(self.__message)
        self.__warning_already_shown = True

    def __getattr__(self, attr):
        self._show_warning_maybe()
        return getattr(self.__obj, attr)

    def __call__(self, *args, **kwargs):
        self._show_warning_maybe()
        return self.__obj(*args, **kwargs)

    def __iter__(self):
        self._show_warning_maybe()
        return iter(self.__obj)

    def __getitem__(self, key):
        self._show_warning_maybe()
        return self.__obj[key]

    def __setitem__(self, key, value):
        self._show_warning_maybe()
        self.__obj[key] = value


class PyScript:
    """
    This class is deprecated since 2022.12.1.

    All its old functionalities are available as module-level functions. This
    class should be killed eventually.
    """

    loop = loop

    @staticmethod
    def run_until_complete(f):
        run_until_complete(f)

    @staticmethod
    def write(element_id, value, append=False, exec_id=0):
        write(element_id, value, append, exec_id)


def _install_deprecated_globals_2022_12_1(ns):
    """
    Install into the given namespace all the globals which have been
    deprecated since the 2022.12.1 release. Eventually they should be killed.
    """

    def deprecate(name, obj, instead):
        message = f"Direct usage of <code>{name}</code> is deprecated. " + instead
        ns[name] = DeprecatedGlobal(name, obj, message)

    # function/classes defined in pyscript.py ===> pyscript.XXX
    pyscript_names = [
        "PyItemTemplate",
        "PyListTemplate",
        "PyWidgetTheme",
        "add_classes",
        "create",
        "loop",
    ]
    for name in pyscript_names:
        deprecate(
            name, globals()[name], f"Please use <code>pyscript.{name}</code> instead."
        )

    # stdlib modules ===> import XXX
    stdlib_names = [
        "asyncio",
        "base64",
        "io",
        "sys",
        "time",
        "datetime",
        "pyodide",
        "micropip",
    ]
    for name in stdlib_names:
        obj = __import__(name)
        deprecate(name, obj, f"Please use <code>import {name}</code> instead.")

    # special case
    deprecate(
        "dedent", dedent, "Please use <code>from textwrap import dedent</code> instead."
    )

    # these are names that used to leak in the globals but they are just
    # implementation details. People should not use them.
    private_names = [
        "eval_formatter",
        "format_mime",
        "identity",
        "render_image",
        "MIME_RENDERERS",
        "MIME_METHODS",
    ]
    for name in private_names:
        obj = globals()[name]
        message = (
            f"<code>{name}</code> is deprecated. "
            "This is a private implementation detail of pyscript. "
            "You should not use it."
        )
        ns[name] = DeprecatedGlobal(name, obj, message)

    # these names are available as js.XXX
    for name in ["document", "console"]:
        obj = getattr(js, name)
        deprecate(name, obj, f"Please use <code>js.{name}</code> instead.")

    # PyScript is special, use a different message
    message = (
        "The <code>PyScript</code> object is deprecated. "
        "Please use <code>pyscript</code> instead."
    )
    ns["PyScript"] = DeprecatedGlobal("PyScript", PyScript, message)
`]]};var An=ye("pyscript/pyodide"),ol=class extends Object{constructor(t="https://cdn.jsdelivr.net/pyodide/v0.22.1/full/pyodide.js"){super();this.src=t}async loadInterpreter(t,n){let r={define_custom_element:Gf,showWarning:jt,deepQuerySelector:eu};this.interface=Wt(await loadPyodide({stdout:s=>{n.stdout_writeline(s).syncify()},stderr:s=>{n.stderr_writeline(s).syncify()},fullStdLib:!1})),this.interface.registerComlink(tr),this.FS=this.interface.FS,this.PATH=this.interface._module.PATH,this.PATH_FS=this.interface._module.PATH_FS,this.interpreter=this.interface,this.interface.registerJsModule("_pyscript_js",r);for(let s of sl.dirs)this.FS.mkdir("/home/pyodide/"+s);for(let[s,o]of sl.files)this.FS.writeFile("/home/pyodide/"+s,o);this.invalidate_module_path_cache(),this.globals=Wt(this.interface.globals),An.info("importing pyscript"),this.pyscript_internal=Wt(this.interface.pyimport("pyscript._internal")),this.pyscript_internal.set_version_info(ei),this.pyscript_internal.install_pyscript_loop(),t.packages&&(An.info("Found packages in configuration to install. Loading micropip..."),await this.loadPackage("micropip")),this.interface.runPython(`
        import js
        import pyscript
        from pyscript import Element, display, HTML
        `),An.info("pyodide loaded and initialized")}registerJsModule(t,n){this.interface.registerJsModule(t,n)}async loadPackage(t){An.info(`pyodide.loadPackage: ${t.toString()}`);let n=An.info.bind(An);this.interpreter.version.startsWith("0.22")?await this.interface.loadPackage(t,{messageCallback:n,errorCallback:n}):await this.interface.loadPackage(t,n,n)}async installPackage(t){if(t.length>0){An.info(`micropip install ${t.toString()}`);let n=this.interface.pyimport("micropip");try{await n.install(t),n.destroy()}catch(r){let s=r,o;Array.isArray(t)?o=t.join(", "):o=t;let l=`Unable to install package(s) '${o}'.`;throw s.message.includes("Can't find a pure Python 3 wheel")?l+=` Reason: Can't find a pure Python 3 Wheel for package(s) '${o}'.See: https://pyodide.org/en/stable/usage/faq.html#micropip-can-t-find-a-pure-python-wheel for more information.`:s.message.includes("Can't fetch metadata")?l+=" Unable to find package in PyPI. Please make sure you have entered a correct package name.":l+=` Reason: ${s.message}. Please open an issue at https://github.com/pyscript/pyscript/issues/new if you require help or you think it's a bug.`,An.error(s),new ss("PY1001",l)}}}async loadFileFromURL(t,n){t=this.PATH_FS.resolve(t);let r=this.PATH.dirname(t);this.FS.mkdirTree(r);let o=await(await on(n)).arrayBuffer(),l=new Uint8Array(o);this.FS.writeFile(t,l,{canOwn:!0})}invalidate_module_path_cache(){this.interface.pyimport("importlib").invalidate_caches()}pyimport(t){return Wt(this.interface.pyimport(t))}setHandler(t,n){let r=this.interface.pyimport("pyscript");r[t]=n}};var je=ye("pyscript/main"),qc=sn.get("throw"),tv=qc.serialize.bind(qc);function nv({value:i}){let e=tv({value:i});return e[0].value.$$isUserError=i.$$isUserError,e}qc.serialize=nv;var bO,wO,ll=class{constructor(){this.plugins=new ms,this.plugins.add(new nl,new tl(this),new il),this._stdioMultiplexer=new el,this._stdioMultiplexer.addListener(gO),this.plugins.add(new rl(this._stdioMultiplexer)),this.tagExecutionLock=xf(),this._numPendingTags=0,this.scriptTagsPromise=new Promise(e=>this.resolvedScriptTags=e)}async main(){try{await this._realMain()}catch(e){await this._handleUserErrorMaybe(e)}}incrementPendingTags(){this._numPendingTags+=1}decrementPendingTags(){if(this._numPendingTags<=0)throw new Error("INTERNAL ERROR: assertion _numPendingTags > 0 failed");this._numPendingTags-=1,this._numPendingTags===0&&this.resolvedScriptTags()}async _handleUserErrorMaybe(e){let t=e;if(t&&t.$$isUserError)Ft(t.message,"error",t.messageType),await this.plugins.onUserError(t);else throw e}async _realMain(){this.loadConfig(),await this.plugins.configure(this.config),this.plugins.beforeLaunch(this.config),await this.loadInterpreter(),bO=this.interpreter,wO=this.interpreter}loadConfig(){je.info("searching for <py-config>");let e=xt("py-config",document),t=null;if(e.length>0&&(t=e[0]),e.length>=2&&jt("Multiple <py-config> tags detected. Only the first is going to be parsed, all the others will be ignored"),this.config=Tf(t),this.config.execution_thread==="worker"&&crossOriginIsolated===!1)throw new Se("PY1000",`When execution_thread is "worker", the site must be cross origin isolated, but crossOriginIsolated is false.
                To be cross origin isolated, the server must use https and also serve with the following headers: ${JSON.stringify({"Cross-Origin-Embedder-Policy":"require-corp","Cross-Origin-Opener-Policy":"same-origin"})}.

                The problem may be that one or both of these are missing.
                `);je.info(`config loaded:
`+JSON.stringify(this.config,null,2))}_get_base_url(){let e=document.currentScript,t=e.src.lastIndexOf("/");return e.src.slice(0,t)}async _startInterpreter_main(e){je.info("Starting the interpreter in the main thread");let t=new ol(e.src),{port1:n,port2:r}=new er;n.start(),r.start(),si(t,r);let s=oi(n);return this.logStatus(`Downloading ${e.name}...`),await import(e.src),{remote_interpreter:t,wrapped_remote_interpreter:s}}async _startInterpreter_worker(e){je.warn('execution_thread = "worker" is still VERY experimental, use it at your own risk'),je.info("Starting the interpreter in a web worker");let t=this._get_base_url(),n=new Worker(t+"/interpreter_worker.js");return{remote_interpreter:void 0,wrapped_remote_interpreter:await oi(n)(e)}}async loadInterpreter(){if(je.info("Initializing interpreter"),this.config.interpreters.length==0)throw new Se("PY1000","Fatal error: config.interpreter is empty");this.config.interpreters.length>1&&jt("Multiple interpreters are not supported yet.<br />Only the first will be used","html");let e=this.config.interpreters[0],t;this.config.execution_thread=="worker"?t=await this._startInterpreter_worker(e):t=await this._startInterpreter_main(e);let{remote_interpreter:n,wrapped_remote_interpreter:r}=t;this.interpreter=new ds(this.config,this._stdioMultiplexer,r,n),await this.afterInterpreterLoad(this.interpreter)}async afterInterpreterLoad(e){console.assert(this.config!==void 0),this.logStatus("Python startup..."),await this.interpreter.initializeRemote(),this.logStatus("Python ready!"),this.logStatus("Setting up virtual environment..."),await this.setupVirtualEnv(e),await cu(e),await this.plugins.afterSetup(e),await e._remote.invalidate_module_path_cache(),this.logStatus("Executing <py-script> tags..."),await this.executeScripts(e),this.logStatus("Initializing web components..."),mO(e,this),lu(e),this.logStatus("Startup complete"),await this.plugins.afterStartup(e),je.info("PyScript page fully initialized")}async setupVirtualEnv(e){await Promise.all([this.installPackages(),this.fetchPaths(e)]),await e._remote.invalidate_module_path_cache(),await this.fetchUserPlugins(e)}async installPackages(){this.config.packages&&(je.info("Packages to install: ",this.config.packages),await this.interpreter._remote.installPackage(this.config.packages))}async fetchPaths(e){let t=fu(this.config.fetch);je.info("Fetching urls:",t.map(({url:n})=>n).join(", ")),await Promise.all(t.map(async({path:n,url:r})=>{await e._remote.loadFileFromURL(n,r),je.info(`    Fetched ${r} ==> ${n}`)})),je.info("Fetched all paths")}async fetchUserPlugins(e){let t=this.config.plugins;je.info("Plugins to fetch: ",t);for(let n of t){if(je.info(`  fetching plugins: ${n}`),n.endsWith(".py"))await this.fetchPythonPlugin(e,n);else if(n.endsWith(".js"))await this.fetchJSPlugin(n);else throw new Se("PY2000",`Unable to load plugin from '${n}'. Plugins need to contain a file extension and be either a python or javascript file.`);je.info("All plugins fetched")}}async fetchJSPlugin(e){let t=await(await on(e)).blob(),n=new File([t],"plugin.js",{type:"text/javascript"}),o=(await import(URL.createObjectURL(n))).default;if(o===void 0)throw new Se("PY2001",`Unable to load plugin from '${e}'. Plugins need to contain a default export.`);this.plugins.add(new o)}async fetchPythonPlugin(e,t){let r=t.split("/").pop();await e._remote.loadFileFromURL(r,t),await e._remote.invalidate_module_path_cache();let s=t.replace(/^.*[\\/]/,"").replace(".py","");console.log(`importing ${s}`);let o=e._unwrapped_remote.pyimport(s);if(typeof await o.plugin<"u"){let l=o.plugin;l.init(this),this.plugins.addPythonPlugin(l)}else je.error(`Cannot find plugin on Python module ${s}! Python plugins modules must contain a "plugin" attribute. For more information check the plugins documentation.`)}async executeScripts(e){this.PyScript=iu(e,this),customElements.define("py-script",this.PyScript),this.incrementPendingTags(),this.decrementPendingTags(),await this.scriptTagsPromise,await this.interpreter._remote.pyscript_internal.schedule_deferred_tasks()}logStatus(e){je.info(e);let t=new CustomEvent("py-status-message",{detail:e});document.dispatchEvent(t)}registerStdioListener(e){this._stdioMultiplexer.addListener(e)}};globalThis.pyscript_get_config=()=>Bc.config;var Bc=new ll;typeof jest>"u"&&(Bc.readyPromise=Bc.main());return py(iv);})();
/*! Bundled license information:

not-so-weak/esm/index.js:
  (*! (c) Andrea Giammarchi - ISC *)
*/
//# sourceMappingURL=pyscript.min.js.map
